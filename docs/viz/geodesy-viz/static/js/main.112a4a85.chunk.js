(this.webpackJsonpgeodesy=this.webpackJsonpgeodesy||[]).push([[0],{49:function(e,t,n){},68:function(e,t,n){},69:function(e,t,n){},70:function(e,t,n){},71:function(e,t,n){"use strict";n.r(t);var i=n(0),r=n(21),a=n.n(r),c=n(14),o=(n(49),n(6)),l=n(74),s=n(2),d=n(20),u="#ffffff",j="#5e78ce",g="#d074b3",b="#0047fd",f="#d30000",h="geoidHeight",O="show geoid?",m="Models",x="Coordinates",p="geoid",v=n(7);function y(){var e=Object(c.f)().camera;return Object(i.useEffect)((function(){e.layers.enable(5)}),[e.layers]),null}function M(){var e=Object(d.d)("Camera",(function(){return{autoRotate:{value:!0,hint:"Automatically rotate around models"}}})),t=Object(o.a)(e,2),n=t[0].autoRotate,r=t[1];return Object(i.useEffect)((function(){window.addEventListener("click",(function(){console.log("Turning off auto rotation"),r({autoRotate:!1})}),{once:!0})}),[r]),Object(v.jsx)(w,{autoRotate:n})}function w(e){var t=e.autoRotate,n=Object(c.f)(),r=n.camera,a=n.gl,o=Object(i.useRef)();return Object(c.d)((function(){o.current.update()})),Object(v.jsx)(l.a,{ref:o,args:[r,a],minDistance:1.5,maxDistance:10,enablePan:!1,autoRotate:t,autoRotateSpeed:.5})}function R(){var e=Object(i.useRef)();Object(i.useEffect)((function(){e.current.matrixAutoUpdate=!1}),[]);var t=Object(c.f)().camera,n=Object(d.d)("Lighting",{intensity:{value:.75,min:0,max:2,hint:"Light intensity"},followCamera:{value:!0,hint:"Make the light rotate with you"},offset:{value:-65,min:-180,max:180,step:1,hint:"Lighting angle, in degrees"}},{collapsed:!0}),r=n.intensity,a=n.followCamera,o=n.offset;return Object(c.d)((function(){a&&e.current.matrix.copy(function(e,t){var n=e.clone().setPosition(0,0,0),i=n.clone().invert(),r=(new s.Matrix4).makeRotationY(s.MathUtils.degToRad(t));return n.multiply(r).multiply(i).multiply(e)}(t.matrixWorld,o))})),Object(v.jsx)("directionalLight",{ref:e,intensity:r})}var N=n(10),C=n(73),S=n(72);n(68);function L(){return Object(v.jsx)(S.a,{transform:!1,fullscreen:!0,className:"loading-screen",children:Object(v.jsx)("p",{className:"loading-screen-text",children:"Loading . . ."})})}var E="./models/Geoid.glb";function k(e){var t=e.isVisible;return Object(v.jsx)(i.Suspense,{fallback:Object(v.jsx)(L,{}),children:Object(v.jsx)(V,{isVisible:t})})}function V(e){var t=e.isVisible,n=Object(C.a)(E),r=n.nodes,a=n.materials;return Object(i.useEffect)((function(){console.log("Loaded geoid model")}),[]),Object(v.jsx)("group",{dispose:null,children:Object(v.jsx)("mesh",{geometry:r.Sphere.geometry,material:a.GeoidFlatMaterial,name:p,scale:1,layers:5,visible:t})})}C.a.preload(E);var G=n(9);function T(e){return Object(v.jsx)(F,Object(G.a)({scale:1},e))}function U(e){return Object(v.jsx)(F,Object(G.a)({scale:[1,(t=e.flattening,n=1,(1-t)*n),1]},e));var t,n}function F(e){var t=Object(i.useMemo)((function(){return new s.SphereBufferGeometry(e.radius,48,24)}),[e.radius]);return Object(v.jsxs)("group",{scale:e.scale,children:[Object(v.jsx)("mesh",{geometry:t,visible:e.opacity>0,children:Object(v.jsx)("meshStandardMaterial",{attach:"material",color:e.color,transparent:!0,opacity:e.opacity})}),Object(v.jsxs)("lineSegments",{children:[Object(v.jsx)("edgesGeometry",{attach:"geometry",args:[t]}),Object(v.jsx)("lineBasicMaterial",{attach:"material",color:e.edgeColor,transparent:!0,opacity:e.opacity,depthWrite:!1})]})]})}function P(e,t,n){var i=s.MathUtils.degToRad(e),r=s.MathUtils.degToRad(t),a=Math.cos(i)*Math.cos(r),c=Math.cos(i)*Math.sin(r),o=Math.sin(i),l=1*(1-n)/Math.sqrt(Math.pow((1-n)*Math.cos(i),2)+Math.pow(Math.sin(i),2));return new s.Vector3(c,o,a).multiplyScalar(l)}function B(e,t,n){var i,r,a=(i=t,s.MathUtils.degToRad(i)),c=(r=e,s.MathUtils.degToRad(90-r));return(new s.Vector3).setFromSphericalCoords(1+n,c,a)}function I(e,t,n,i){var r=s.MathUtils.degToRad(e),a=s.MathUtils.degToRad(t),c=n*(2-n),o=1/Math.sqrt(1-c*Math.pow(Math.sin(r),2)),l=(o+i)*Math.cos(r)*Math.cos(a),d=(o+i)*Math.cos(r)*Math.sin(a),u=(o*(1-c)+i)*Math.sin(r);return new s.Vector3(d,u,l)}function W(e,t,n){var i=s.MathUtils.degToRad(e),r=s.MathUtils.degToRad(t),a=n*(2-n),c=1/Math.sqrt(1-a*Math.pow(Math.sin(i),2)),o=a*c*Math.cos(i)*Math.cos(r),l=a*c*Math.cos(i)*Math.sin(r);return new s.Vector3(l,0,o)}function z(e){var t=e.latitude,n=e.longitude,i=e.lineColor;return Object(v.jsx)(q,{start:new s.Vector3(0,0,0),end:B(t,n,1),lineColor:i,depthWrite:!1})}function H(e){var t=e.latitude,n=e.longitude,i=e.flattening,r=e.lineColor;return Object(v.jsx)(q,{start:W(t,n,i),end:I(t,n,i,1),lineColor:r,renderOrder:2,depthWrite:!0})}function q(e){var t,n=Object(i.useRef)();return Object(i.useLayoutEffect)((function(){var t=[e.start,e.end];n.current.setFromPoints(t)}),[e.start,e.end]),Object(v.jsxs)("line",{renderOrder:null!==(t=e.renderOrder)&&void 0!==t?t:0,children:[Object(v.jsx)("bufferGeometry",{attach:"geometry",ref:n}),Object(v.jsx)("lineBasicMaterial",{attach:"material",color:e.lineColor,depthWrite:e.depthWrite})]})}n(69);var A="geoid-height-grid";function D(){var e=Object(i.useRef)();return Object(i.useEffect)((function(){var t=new Image(361,181);t.src="./geoid-height-grid.png",t.onload=function(){console.log("Finished loading geoid height image."),e.current.getContext("2d").drawImage(t,0,0)}}),[]),Object(v.jsx)(S.a,{children:Object(v.jsx)("canvas",{ref:e,hidden:!0,id:A,width:361,height:181})})}function J(e){var t=e.text;return Object(v.jsx)(S.a,{transform:!1,zIndexRange:[0,0],className:"geoid-height-label",style:{position:"relative",left:"-50%"},calculatePosition:function(e,t,n){return[n.width/2,0]},children:Object(v.jsx)("p",{children:t})})}function Y(e){var t=e.latitude,n=e.longitude,i=function(e,t,n){var i=function(e,t){return[e+180,90-t]}(n,t),r=Object(o.a)(i,2),a=r[0],c=r[1];return function(e){var t=-106.57,n=t+e/255*(78.21-t);return Math.round(n)}(e.getImageData(a,c,1,1).data[0])}(document.getElementById(A).getContext("2d"),t,n);return Object(v.jsx)(J,{text:"Geoid height: ".concat(i," m")})}var K="#00ffbb";function Q(e){var t=e.position,n=Object(i.useRef)(),r=Object(i.useState)(!1),a=Object(o.a)(r,2),l=a[0],s=a[1];return Object(c.d)((function(){n.current.color.set(l?"#ff0090":K)})),Object(v.jsxs)("mesh",{position:t,onPointerOver:function(){return s(!0)},onPointerOut:function(){return s(!1)},children:[Object(v.jsx)("sphereBufferGeometry",{attach:"geometry",args:[1/80,10,5]}),Object(v.jsx)("meshStandardMaterial",{attach:"material",ref:n,color:K})]})}function X(e){var t=e.latitude,n=e.longitude;return Object(v.jsx)(Q,{position:B(t,n,0)})}function Z(e){var t=e.latitude,n=e.longitude,i=e.flattening;return Object(v.jsx)(Q,{position:P(t,n,i)})}function $(e){var t=e.latitude,n=e.longitude,i=e.flattening;return Object(v.jsx)(Q,{position:I(t,n,i,0)})}function _(e){var t=e.latitude,n=e.longitude,i=e.objectName,r=B(t,n,1);return Object(v.jsx)(te,{rayStart:r,direction:r.clone().negate(),objectName:i})}function ee(e){var t=e.latitude,n=e.longitude,i=e.flattening,r=e.objectName,a=I(t,n,i,1),c=I(t,n,i,-.5).sub(a);return Object(v.jsx)(te,{rayStart:a,direction:c,objectName:r})}function te(e){var t=e.rayStart,n=e.direction,r=e.objectName,a=Object(c.f)().scene,o=Object(i.useMemo)((function(){var e=new s.Raycaster;return e.layers.set(5),e}),[]);o.set(t,n.normalize());var l=o.intersectObjects(a.children,!0).find((function(e){return e.object.name===r}));return console.log("Performed a raycast: "),console.log(l),l?Object(v.jsx)(Q,{position:l.point}):null}n(70);function ne(e){var t=e.gradientLegend,n=e.elementsLegend;return Object(v.jsx)(S.a,{calculatePosition:function(e,t,n){return[0,n.height]},prepend:!0,zIndexRange:[0,0],className:"legends-root",children:Object(v.jsxs)("div",{className:"legends-wrapper",children:[n,t]})})}function ie(e){var t=e.top,n=e.middle,i=e.bottom;return Object(v.jsxs)("div",{className:"gradient-legend-wrapper",children:[Object(v.jsx)("img",{id:"horizontal-gradient",src:"geoid-gradient-legend-horizontal.png",alt:"geoid gradient legend"}),Object(v.jsx)("img",{id:"vertical-gradient",src:"geoid-gradient-legend-vertical.png",alt:"geoid gradient legend"}),Object(v.jsxs)("div",{className:"gradient-labels-wrapper",children:[Object(v.jsx)("div",{className:"legend-text",children:t}),Object(v.jsx)("div",{className:"legend-text",children:n}),Object(v.jsx)("div",{className:"legend-text",children:i})]})]})}function re(e){var t=e.elements;return Object(v.jsx)("ul",{className:"list-legend-wrapper",children:Object.keys(t).map((function(e){return Object(v.jsx)(ae,{block:t[e],label:e},e)}))})}function ae(e){var t=e.block,n=e.label;return Object(v.jsxs)("li",{className:"legend-item-wrapper",children:[t,Object(v.jsx)("span",{className:"legend-text legend-value",children:n})]})}function ce(e){var t=e.color;return Object(v.jsx)("span",{className:"legend-key",children:Object(v.jsx)("hr",{style:{borderWidth:"1px 0 0 0",borderStyle:"solid",borderColor:t}})})}function oe(e){var t=e.src,n=e.alt;return Object(v.jsx)("img",{className:"legend-key",src:t,alt:n})}function le(e){var t=e.color;return Object(v.jsx)("span",{className:"legend-key",style:{backgroundColor:null!==t&&void 0!==t?t:"white"}})}function se(){var e=Object(d.d)(x,{latitude:{value:0,min:-90,max:90,step:1,hint:"Latitude (degrees)"},longitude:{value:0,min:-180,max:180,step:1,hint:"Longitude (degrees)"}}),t=e.latitude,n=e.longitude,i=Object(d.d)((function(){var e,t;return t={},Object(N.a)(t,m,Object(d.c)((e={},Object(N.a)(e,h,{value:!1,render:function(){return!1}}),Object(N.a)(e,"geoid height",Object(d.b)({on:function(){var e;return u((e={},Object(N.a)(e,h,!0),Object(N.a)(e,"geodetic",!0),Object(N.a)(e,"geocentric",!1),e))},off:function(){return u(Object(N.a)({},h,!1))}})),e))),Object(N.a)(t,x,Object(d.c)({geodetic:{value:!0,render:function(e){return!e("".concat(m,".").concat(h))},hint:"Show as geodetic coordinates"},geocentric:{value:!1,render:function(e){return!e("".concat(m,".").concat(h))},hint:"Show as geocentric coordinates"}})),t})),r=Object(o.a)(i,2),a=r[0],c=a.geoidHeight,l=a.geodetic,s=a.geocentric,u=r[1];return Object(v.jsxs)(v.Fragment,{children:[Object(v.jsx)(D,{}),Object(v.jsx)(de,{latitude:t,longitude:n,geoidHeightMode:c,geodetic:l,geocentric:s}),c?Object(v.jsx)(Y,{latitude:t,longitude:n}):null]})}function de(e){var t=e.latitude,n=e.longitude,r=e.geoidHeightMode,a=e.geocentric,c=e.geodetic,l=Object(d.d)(m,(function(){return{sphere:{value:0,min:0,max:1,render:function(e){return!e("".concat(m,".").concat(h))},hint:"Visibility of the sphere"},ellipsoid:{value:0,min:0,max:1,hint:"Visibility of the ellipsoid"},flattening:{value:.15,min:0,max:1,render:function(e){return!e("".concat(m,".").concat(h))},hint:"Flattening factor of the ellipsoid"}}})),s=Object(o.a)(l,2),x=s[0],y=x.sphere,M=x.ellipsoid,w=x.flattening,R=s[1],C=Object(d.d)(m,(function(){return Object(N.a)({},O,{value:!0,render:function(e){return!e("".concat(m,".").concat(h))},hint:"Show/hide the geoid",onChange:function(e){e&&R({sphere:0,ellipsoid:0})},transient:!1})})),S=Object(o.a)(C,2),L=S[0][O],E=S[1];Object(i.useEffect)((function(){r&&E(Object(N.a)({},O,!0))}),[r,E]),Object(i.useEffect)((function(){r&&R({sphere:0,flattening:.003352810664781205})}),[r,R]),Object(i.useEffect)((function(){1===y&&R({sphere:.5})}),[M,w,R]);var V=L?Object(v.jsx)(ie,{top:"78 m",middle:"Ellipsoid",bottom:"-106 m"}):null,G=Object(v.jsx)(re,{elements:ue(y>0,M>0,L,a,c)});return Object(v.jsxs)(v.Fragment,{children:[Object(v.jsx)(U,{opacity:M,flattening:w,color:j,edgeColor:u,radius:1}),Object(v.jsx)(T,{opacity:y,color:g,edgeColor:u,radius:1}),a?Object(v.jsx)(z,{latitude:t,longitude:n,lineColor:b}):null,c?Object(v.jsx)(H,{latitude:t,longitude:n,flattening:w,lineColor:f}):null,a&&y>0?Object(v.jsx)(X,{latitude:t,longitude:n}):null,c&&M>0?Object(v.jsx)($,{latitude:t,longitude:n,flattening:w}):null,a&&M>0?Object(v.jsx)(Z,{latitude:t,longitude:n,flattening:w}):null,Object(v.jsx)(k,{isVisible:L}),L&&a?Object(v.jsx)(_,{latitude:t,longitude:n,objectName:p}):null,L&&c?Object(v.jsx)(ee,{latitude:t,longitude:n,flattening:w,objectName:p}):null,Object(v.jsx)(ne,{gradientLegend:V,elementsLegend:G})]})}function ue(e,t,n,i,r){var a={};return n&&(a.Geoid=Object(v.jsx)(oe,{src:"geoid-gradient.png",alt:"A legend for the geoid colour gradient"})),t&&(a.Ellipsoid=Object(v.jsx)(le,{color:j})),e&&(a.Sphere=Object(v.jsx)(le,{color:g})),r&&(a.Geodetic=Object(v.jsx)(ce,{color:f})),i&&(a.Geocentric=Object(v.jsx)(ce,{color:b})),a}var je=n(75);var ge=function(){return Object(v.jsxs)(v.Fragment,{children:[Object(v.jsxs)(c.a,{camera:{position:[2.5,0,0]},children:[Object(v.jsx)(y,{}),Object(v.jsx)("ambientLight",{intensity:.15}),Object(v.jsx)(se,{}),Object(v.jsx)(R,{}),Object(v.jsx)(M,{}),Object(v.jsx)(je.a,{})]}),Object(v.jsx)(d.a,{hideCopyButton:!0})]})};a.a.render(Object(v.jsx)(ge,{}),document.getElementById("root"))}},[[71,1,2]]]);
//# sourceMappingURL=main.112a4a85.chunk.js.map