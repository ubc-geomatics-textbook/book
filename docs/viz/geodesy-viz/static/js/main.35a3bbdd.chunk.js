(this.webpackJsonpmootcourt=this.webpackJsonpmootcourt||[]).push([[0],{49:function(e,t,n){},68:function(e,t,n){},69:function(e,t,n){"use strict";n.r(t);var i=n(0),r=n(20),a=n.n(r),o=n(14),c=(n(49),n(72)),s=n(2),l=n(24),u=n(6),d=n(71),j=n(11);function f(e){var t=e.latitude,n=e.longitude,i=e.edgeColor,r=b(n),a=g(t),o=new s.Spherical(2*U,a,r),c=(new s.Vector3).setFromSpherical(o);return Object(j.jsx)(h,{start:new s.Vector3(0,0,0),end:c,edgeColor:i})}function h(e){var t=Object(i.useRef)();return Object(i.useLayoutEffect)((function(){var n=[e.start,e.end];t.current.setFromPoints(n)}),[e.start,e.end]),Object(j.jsxs)("line",{children:[Object(j.jsx)("bufferGeometry",{attach:"geometry",ref:t}),Object(j.jsx)("lineBasicMaterial",{attach:"material",color:e.edgeColor})]})}function g(e){return s.MathUtils.degToRad(90-e)}function b(e){return s.MathUtils.degToRad(e)}var m="#00ffbb";function O(e){var t=e.position,n=Object(i.useRef)(),r=Object(i.useState)(!1),a=Object(u.a)(r,2),c=a[0],s=a[1];return Object(o.d)((function(){n.current.color.set(c?"#ff0090":m)})),Object(j.jsxs)("mesh",{position:t,onPointerOver:function(){return s(!0)},onPointerOut:function(){return s(!1)},children:[Object(j.jsx)("sphereBufferGeometry",{attach:"geometry",args:[U/80,10,5]}),Object(j.jsx)("meshStandardMaterial",{attach:"material",ref:n,color:m})]})}function p(e){var t=function(e,t){var n=b(t),i=g(e);return(new s.Vector3).setFromSphericalCoords(U,i,n)}(e.latitude,e.longitude);return Object(j.jsx)(O,{position:t})}function x(e){var t=function(e,t,n){var i=s.MathUtils.degToRad(e),r=s.MathUtils.degToRad(t),a=Math.cos(i)*Math.cos(r),o=Math.cos(i)*Math.sin(r),c=Math.sin(i),l=(1-n)*U/Math.sqrt(Math.pow((1-n)*Math.cos(i),2)+Math.pow(Math.sin(i),2));return new s.Vector3(o,c,a).multiplyScalar(l)}(e.latitude,e.longitude,e.flattening);return Object(j.jsx)(O,{position:t})}function v(e){var t=e.latitude,n=e.longitude,r=e.modelName,a=Object(o.f)().scene,c=Object(i.useMemo)((function(){var e=new s.Raycaster;return e.layers.set(k),e}),[]),l=b(n),u=g(t),d=new s.Spherical(2*U,u,l).makeSafe(),f=(new s.Vector3).setFromSpherical(d);c.set(f,f.clone().negate().normalize());var h=c.intersectObjects(a.children,!0).find((function(e){return e.object.name===r}));return console.log("Performed a raycast: "+h),h?Object(j.jsx)(O,{position:h.point}):null}var y=n(70);n(68);function w(){return Object(j.jsx)(y.a,{transform:!1,fullscreen:!0,className:"loading-screen",children:Object(j.jsx)("p",{className:"loading-screen-text",children:"Loading . . ."})})}var M="./models/Geoid.glb";function C(e){var t=e.isVisible,n=e.latitude,r=e.longitude,a="geoid";return Object(j.jsxs)(i.Suspense,{fallback:Object(j.jsx)(w,{}),children:[Object(j.jsx)(R,{name:a,isVisible:t}),t?Object(j.jsx)(v,{latitude:n,longitude:r,modelName:a}):null]})}function R(e){var t=e.name,n=e.isVisible,i=Object(d.a)(M),r=i.nodes,a=i.materials;return Object(j.jsx)("group",{dispose:null,rotation:[0,Math.PI/2,0],children:Object(j.jsx)("mesh",{geometry:r.Sphere.geometry,material:a.GeoidFlatMaterial,name:t,layers:k,scale:U,visible:n})})}d.a.preload(M);var S=n(8);function G(e){return Object(j.jsx)(F,Object(S.a)({scale:1},e))}function V(e){return Object(j.jsx)(F,Object(S.a)({scale:[1,(t=e.flattening,n=1,(1-t)*n),1]},e));var t,n}function F(e){var t=Object(i.useMemo)((function(){return new s.SphereBufferGeometry(e.radius,48,24)}),[e.radius]);return Object(j.jsxs)("group",{scale:e.scale,children:[Object(j.jsx)("mesh",{geometry:t,layers:k,visible:e.opacity>0,children:Object(j.jsx)("meshStandardMaterial",{attach:"material",color:e.color,transparent:!0,opacity:e.opacity})}),Object(j.jsxs)("lineSegments",{children:[Object(j.jsx)("edgesGeometry",{attach:"geometry",args:[t]}),Object(j.jsx)("lineBasicMaterial",{attach:"material",color:e.edgeColor,transparent:!0,opacity:e.opacity,depthWrite:!1})]})]})}function H(e){var t=e.text;return Object(j.jsx)(y.a,{transform:!1,style:{position:"relative",top:70,left:20,fontFamily:"courier",color:"white"},calculatePosition:function(){return[0,0]},children:t})}var P="geoid-height-grid";function B(){var e=Object(i.useRef)();return Object(i.useEffect)((function(){var t=new Image(361,181);t.src="./geoid-height-grid.png",t.onload=function(){console.log("Finished loading geoid height image."),e.current.getContext("2d").drawImage(t,0,0)}}),[]),Object(j.jsx)(y.a,{children:Object(j.jsx)("canvas",{ref:e,hidden:!0,id:P,width:361,height:181})})}function E(e){var t=e.latitude,n=e.longitude,i=function(e,t,n){var i=function(e,t){return[e+180,90-t]}(n,t),r=Object(u.a)(i,2),a=r[0],o=r[1];return function(e){var t=-106.57,n=t+e/255*(78.21-t);return Math.round(n)}(e.getImageData(a,o,1,1).data[0])}(document.getElementById(P).getContext("2d"),t,n);return Object(j.jsx)(H,{text:"Geoid height: "+i+" m"})}var I="#ffffff",U=1,k=5,L=1/298.25722356;function T(){var e=Object(l.c)("Models",(function(){return{showGeoidHeight:{value:!1,render:function(){return!1}},"geoid height":Object(l.b)({on:function(){s({showGeoidHeight:!0,geoid:!0,sphere:0,flattening:L})},off:function(){return s({showGeoidHeight:!1})}}),geoid:{value:!0,render:function(e){return!e("Models.showGeoidHeight")},hint:"Show/hide the geoid"},sphere:{value:0,min:0,max:1,render:function(e){return!e("Models.showGeoidHeight")},hint:"Change the visibility of the sphere"},ellipsoid:{value:0,min:0,max:1,hint:"Change the visibility of the ellipsoid",onChange:d,transient:!1},flattening:{value:L,min:0,max:1,render:function(e){return!e("Models.showGeoidHeight")},hint:"Change the flattening factor of the ellipsoid"}}})),t=Object(u.a)(e,2),n=t[0],i=n.geoid,r=n.sphere,a=n.ellipsoid,o=n.flattening,c=n.showGeoidHeight,s=t[1];function d(){console.log(r),s({sphere:0})}var h=Object(l.c)("Coordinates",{latitude:{value:0,min:-90,max:90,step:1,hint:"Change the latitude (degrees)"},longitude:{value:0,min:-180,max:180,step:1,hint:"Change the longitude (degrees)"}}),g=h.latitude,b=h.longitude;return Object(j.jsxs)(j.Fragment,{children:[Object(j.jsx)(B,{}),Object(j.jsx)(N,{latitude:g,longitude:b,geoidVisibility:i,sphereOpacity:r,ellipsoidOpacity:a,flattening:o}),Object(j.jsx)(f,{latitude:g,longitude:b,flattening:o,edgeColor:"#0022ff"}),c?Object(j.jsx)(E,{latitude:g,longitude:b}):null]})}function N(e){var t=e.latitude,n=e.longitude,i=e.geoidVisibility,r=e.sphereOpacity,a=e.ellipsoidOpacity,o=e.flattening,c=r>0?Object(j.jsx)(p,{latitude:t,longitude:n}):null,s=a>0?Object(j.jsx)(x,{latitude:t,longitude:n,flattening:o}):null;return Object(j.jsxs)(j.Fragment,{children:[Object(j.jsx)(C,{latitude:t,longitude:n,isVisible:i}),Object(j.jsx)(V,{opacity:a,color:"#5e78ce",edgeColor:I,radius:U,flattening:o}),Object(j.jsx)(G,{opacity:r,color:"#d0749c",edgeColor:I,radius:U}),c,s]})}function D(){var e=Object(o.f)().camera;return Object(i.useEffect)((function(){e.layers.enable(k)}),[e.layers]),null}function A(){var e=Object(o.f)(),t=e.camera,n=e.gl,r=Object(i.useRef)(),a=Object(l.c)("Camera",{autoRotate:{value:!1,hint:"Automatically rotate around models"},"Reset view":Object(l.a)((function(){r.current.reset()}))}).autoRotate;return Object(o.d)((function(){r.current.update()})),Object(j.jsx)(c.a,{ref:r,args:[t,n],minDistance:U+.5,maxDistance:10*U,autoRotate:a,autoRotateSpeed:.5})}function J(){var e=Object(i.useRef)();Object(i.useEffect)((function(){e.current.matrixAutoUpdate=!1}),[]);var t=Object(o.f)().camera,n=Object(l.c)("Lighting",{intensity:{value:.75,min:0,max:2},followCamera:!0,offset:{value:-65,min:-180,max:180,step:1}},{collapsed:!0}),r=n.intensity,a=n.followCamera,c=n.offset;return Object(o.d)((function(){a&&e.current.matrix.copy(function(e,t){var n=e.clone().setPosition(0,0,0),i=n.clone().invert(),r=(new s.Matrix4).makeRotationY(s.MathUtils.degToRad(t));return n.multiply(r).multiply(i).multiply(e)}(t.matrixWorld,c))})),Object(j.jsx)("directionalLight",{ref:e,intensity:r})}var W=n(73);var q=function(){return Object(j.jsxs)(o.a,{camera:{position:[2*U+.5,0,0]},children:[Object(j.jsx)(D,{}),Object(j.jsx)("ambientLight",{intensity:.15}),Object(j.jsx)(T,{}),Object(j.jsx)(J,{}),Object(j.jsx)(A,{}),Object(j.jsx)(W.a,{})]})};a.a.render(Object(j.jsx)(q,{}),document.getElementById("root"))}},[[69,1,2]]]);
//# sourceMappingURL=main.35a3bbdd.chunk.js.map