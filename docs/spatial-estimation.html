<!DOCTYPE html>
<html lang="" xml:lang="">
<head>

  <meta charset="utf-8" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <title>Chapter 9 Spatial Estimation | Geomatics for Environmental Management: An Open Textbook for Students and Practitioners</title>
  <meta name="description" content="Advancing teaching and learning in geomatics" />
  <meta name="generator" content="bookdown 0.34 and GitBook 2.6.7" />

  <meta property="og:title" content="Chapter 9 Spatial Estimation | Geomatics for Environmental Management: An Open Textbook for Students and Practitioners" />
  <meta property="og:type" content="book" />
  
  <meta property="og:description" content="Advancing teaching and learning in geomatics" />
  <meta name="github-repo" content="ubc-geomatics-textbook" />

  <meta name="twitter:card" content="summary" />
  <meta name="twitter:title" content="Chapter 9 Spatial Estimation | Geomatics for Environmental Management: An Open Textbook for Students and Practitioners" />
  
  <meta name="twitter:description" content="Advancing teaching and learning in geomatics" />
  




  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <meta name="apple-mobile-web-app-capable" content="yes" />
  <meta name="apple-mobile-web-app-status-bar-style" content="black" />
  
  
<link rel="prev" href="raster-analysis-and-terrain-modelling.html"/>
<link rel="next" href="fundamentals-of-remote-sensing.html"/>
<script src="libs/jquery-3.6.0/jquery-3.6.0.min.js"></script>
<script src="https://cdn.jsdelivr.net/npm/fuse.js@6.4.6/dist/fuse.min.js"></script>
<link href="libs/gitbook-2.6.7/css/style.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-table.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-bookdown.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-highlight.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-search.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-fontsettings.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-clipboard.css" rel="stylesheet" />









<link href="libs/anchor-sections-1.1.0/anchor-sections.css" rel="stylesheet" />
<link href="libs/anchor-sections-1.1.0/anchor-sections-hash.css" rel="stylesheet" />
<script src="libs/anchor-sections-1.1.0/anchor-sections.js"></script>
<script src="libs/htmlwidgets-1.6.2/htmlwidgets.js"></script>
<link href="libs/leaflet-1.3.1/leaflet.css" rel="stylesheet" />
<script src="libs/leaflet-1.3.1/leaflet.js"></script>
<link href="libs/leafletfix-1.0.0/leafletfix.css" rel="stylesheet" />
<script src="libs/proj4-2.6.2/proj4.min.js"></script>
<script src="libs/Proj4Leaflet-1.0.1/proj4leaflet.js"></script>
<link href="libs/rstudio_leaflet-1.3.1/rstudio_leaflet.css" rel="stylesheet" />
<script src="libs/leaflet-binding-2.1.2/leaflet.js"></script>
<script src="libs/leaflet-providers-1.9.0/leaflet-providers_1.9.0.js"></script>
<script src="libs/leaflet-providers-plugin-2.1.2/leaflet-providers-plugin.js"></script>
<script src="libs/rglWebGL-binding-1.2.1/rglWebGL.js"></script>
<link href="libs/rglwidgetClass-1.2.1/rgl.css" rel="stylesheet" />
<script src="libs/rglwidgetClass-1.2.1/rglClass.src.js"></script>
<script src="libs/rglwidgetClass-1.2.1/utils.src.js"></script>
<script src="libs/rglwidgetClass-1.2.1/buffer.src.js"></script>
<script src="libs/rglwidgetClass-1.2.1/subscenes.src.js"></script>
<script src="libs/rglwidgetClass-1.2.1/shaders.src.js"></script>
<script src="libs/rglwidgetClass-1.2.1/shadersrc.src.js"></script>
<script src="libs/rglwidgetClass-1.2.1/textures.src.js"></script>
<script src="libs/rglwidgetClass-1.2.1/projection.src.js"></script>
<script src="libs/rglwidgetClass-1.2.1/mouse.src.js"></script>
<script src="libs/rglwidgetClass-1.2.1/init.src.js"></script>
<script src="libs/rglwidgetClass-1.2.1/pieces.src.js"></script>
<script src="libs/rglwidgetClass-1.2.1/draw.src.js"></script>
<script src="libs/rglwidgetClass-1.2.1/controls.src.js"></script>
<script src="libs/rglwidgetClass-1.2.1/selection.src.js"></script>
<script src="libs/rglwidgetClass-1.2.1/rglTimer.src.js"></script>
<script src="libs/rglwidgetClass-1.2.1/pretty.src.js"></script>
<script src="libs/rglwidgetClass-1.2.1/axes.src.js"></script>
<script src="libs/rglwidgetClass-1.2.1/animation.src.js"></script>
<script src="libs/CanvasMatrix4-1.2.1/CanvasMatrix.src.js"></script>
<script src="libs/d3-4.5.0/d3.min.js"></script>
<script src="libs/forceNetwork-binding-0.4/forceNetwork.js"></script>
<script src="libs/viz-1.8.2/viz.js"></script>
<link href="libs/DiagrammeR-styles-0.2/styles.css" rel="stylesheet" />
<script src="libs/grViz-binding-1.0.10/grViz.js"></script>
  <!-- Google tag (gtag.js) -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=G-Z33Q45W2P3"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'G-Z33Q45W2P3');
  </script>


<style type="text/css">
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #7d9029; } /* Attribute */
code span.bn { color: #40a070; } /* BaseN */
code span.bu { color: #008000; } /* BuiltIn */
code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4070a0; } /* Char */
code span.cn { color: #880000; } /* Constant */
code span.co { color: #60a0b0; font-style: italic; } /* Comment */
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.dt { color: #902000; } /* DataType */
code span.dv { color: #40a070; } /* DecVal */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #40a070; } /* Float */
code span.fu { color: #06287e; } /* Function */
code span.im { color: #008000; font-weight: bold; } /* Import */
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #007020; font-weight: bold; } /* Keyword */
code span.op { color: #666666; } /* Operator */
code span.ot { color: #007020; } /* Other */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.sc { color: #4070a0; } /* SpecialChar */
code span.ss { color: #bb6688; } /* SpecialString */
code span.st { color: #4070a0; } /* String */
code span.va { color: #19177c; } /* Variable */
code span.vs { color: #4070a0; } /* VerbatimString */
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
</style>

<style type="text/css">
  
  div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
</style>
<style type="text/css">
/* Used with Pandoc 2.11+ new --citeproc when CSL is used */
div.csl-bib-body { }
div.csl-entry {
  clear: both;
}
.hanging div.csl-entry {
  margin-left:2em;
  text-indent:-2em;
}
div.csl-left-margin {
  min-width:2em;
  float:left;
}
div.csl-right-inline {
  margin-left:2em;
  padding-left:1em;
}
div.csl-indent {
  margin-left: 2em;
}
</style>

<link rel="stylesheet" href="style.css" type="text/css" />
</head>

<body>



  <div class="book without-animation with-summary font-size-2 font-family-1" data-basepath=".">

    <div class="book-summary">
      <nav role="navigation">

<ul class="summary">
<li><a href="./">Geomatics for Environmental Management</a></li>

<li class="divider"></li>
<li class="chapter" data-level="" data-path="index.html"><a href="index.html"><i class="fa fa-check"></i>About this textbook</a>
<ul>
<li class="chapter" data-level="" data-path="index.html"><a href="index.html#who-should-use-this-textbook"><i class="fa fa-check"></i>Who Should use this textbook</a></li>
<li class="chapter" data-level="" data-path="index.html"><a href="index.html#how-to-adopt-this-textbook-in-your-geomatics-classroom"><i class="fa fa-check"></i>How to adopt this textbook in your geomatics classroom</a></li>
<li class="chapter" data-level="" data-path="index.html"><a href="index.html#how-to-get-involved"><i class="fa fa-check"></i>How to get involved</a></li>
<li class="chapter" data-level="" data-path="index.html"><a href="index.html#acknowledgements"><i class="fa fa-check"></i>Acknowledgements</a></li>
</ul></li>
<li class="chapter" data-level="1" data-path="what-is-geomatics.html"><a href="what-is-geomatics.html"><i class="fa fa-check"></i><b>1</b> What is Geomatics?</a>
<ul>
<li class="chapter" data-level="" data-path="what-is-geomatics.html"><a href="what-is-geomatics.html#key-terms"><i class="fa fa-check"></i>Key Terms</a></li>
<li class="chapter" data-level="1.1" data-path="what-is-geomatics.html"><a href="what-is-geomatics.html#the-science-and-technology-of-geomatics"><i class="fa fa-check"></i><b>1.1</b> The Science and Technology of Geomatics</a></li>
<li class="chapter" data-level="1.2" data-path="what-is-geomatics.html"><a href="what-is-geomatics.html#information-systems"><i class="fa fa-check"></i><b>1.2</b> Information Systems</a></li>
<li class="chapter" data-level="1.3" data-path="what-is-geomatics.html"><a href="what-is-geomatics.html#the-five-components-of-gis"><i class="fa fa-check"></i><b>1.3</b> The Five Components of GIS</a></li>
<li class="chapter" data-level="1.4" data-path="what-is-geomatics.html"><a href="what-is-geomatics.html#what-a-gis-can-do"><i class="fa fa-check"></i><b>1.4</b> What a GIS can do</a></li>
<li class="chapter" data-level="1.5" data-path="what-is-geomatics.html"><a href="what-is-geomatics.html#modelling-the-world-with-gis"><i class="fa fa-check"></i><b>1.5</b> Modelling the world with GIS</a></li>
<li class="chapter" data-level="1.6" data-path="what-is-geomatics.html"><a href="what-is-geomatics.html#technology"><i class="fa fa-check"></i><b>1.6</b> Technology</a>
<ul>
<li class="chapter" data-level="1.6.1" data-path="what-is-geomatics.html"><a href="what-is-geomatics.html#the-photograph"><i class="fa fa-check"></i><b>1.6.1</b> The Photograph</a></li>
<li class="chapter" data-level="1.6.2" data-path="what-is-geomatics.html"><a href="what-is-geomatics.html#the-airplane"><i class="fa fa-check"></i><b>1.6.2</b> The Airplane</a></li>
<li class="chapter" data-level="1.6.3" data-path="what-is-geomatics.html"><a href="what-is-geomatics.html#the-computer"><i class="fa fa-check"></i><b>1.6.3</b> The Computer</a></li>
</ul></li>
<li class="chapter" data-level="1.7" data-path="what-is-geomatics.html"><a href="what-is-geomatics.html#the-land-use-problem-in-canada"><i class="fa fa-check"></i><b>1.7</b> The Land Use Problem in Canada</a></li>
<li class="chapter" data-level="1.8" data-path="what-is-geomatics.html"><a href="what-is-geomatics.html#environmental-management-imperatives"><i class="fa fa-check"></i><b>1.8</b> Environmental Management Imperatives</a></li>
<li class="chapter" data-level="1.9" data-path="what-is-geomatics.html"><a href="what-is-geomatics.html#geomatics-today"><i class="fa fa-check"></i><b>1.9</b> Geomatics Today</a></li>
<li class="chapter" data-level="1.10" data-path="what-is-geomatics.html"><a href="what-is-geomatics.html#summary"><i class="fa fa-check"></i><b>1.10</b> Summary</a></li>
<li class="chapter" data-level="" data-path="what-is-geomatics.html"><a href="what-is-geomatics.html#reflection-questions"><i class="fa fa-check"></i>Reflection Questions</a></li>
<li class="chapter" data-level="" data-path="what-is-geomatics.html"><a href="what-is-geomatics.html#practice-questions"><i class="fa fa-check"></i>Practice Questions</a></li>
</ul></li>
<li class="chapter" data-level="2" data-path="mapping-data.html"><a href="mapping-data.html"><i class="fa fa-check"></i><b>2</b> Mapping Data</a>
<ul>
<li class="chapter" data-level="" data-path="mapping-data.html"><a href="mapping-data.html#key-terms-1"><i class="fa fa-check"></i>Key Terms</a></li>
<li class="chapter" data-level="2.1" data-path="mapping-data.html"><a href="mapping-data.html#introduction-to-geodesy"><i class="fa fa-check"></i><b>2.1</b> Introduction to Geodesy</a></li>
<li class="chapter" data-level="2.2" data-path="mapping-data.html"><a href="mapping-data.html#models-of-earth"><i class="fa fa-check"></i><b>2.2</b> Models of Earth</a>
<ul>
<li class="chapter" data-level="2.2.1" data-path="mapping-data.html"><a href="mapping-data.html#geodetic-vertical-datums"><i class="fa fa-check"></i><b>2.2.1</b> Geodetic Vertical Datums</a></li>
<li class="chapter" data-level="2.2.2" data-path="mapping-data.html"><a href="mapping-data.html#tidal-vertical-datums"><i class="fa fa-check"></i><b>2.2.2</b> Tidal Vertical Datums</a></li>
<li class="chapter" data-level="2.2.3" data-path="mapping-data.html"><a href="mapping-data.html#gravimetric-vertical-datums"><i class="fa fa-check"></i><b>2.2.3</b> Gravimetric Vertical Datums</a></li>
</ul></li>
<li class="chapter" data-level="2.3" data-path="mapping-data.html"><a href="mapping-data.html#case-study-the-canadian-geodetic-vertical-datum-of-2013"><i class="fa fa-check"></i><b>2.3</b> Case Study: The Canadian Geodetic Vertical Datum of 2013</a></li>
<li class="chapter" data-level="2.4" data-path="mapping-data.html"><a href="mapping-data.html#referencing-location"><i class="fa fa-check"></i><b>2.4</b> Referencing Location</a>
<ul>
<li class="chapter" data-level="2.4.1" data-path="mapping-data.html"><a href="mapping-data.html#cartesian-coordinate-systems"><i class="fa fa-check"></i><b>2.4.1</b> Cartesian Coordinate Systems</a></li>
<li class="chapter" data-level="2.4.2" data-path="mapping-data.html"><a href="mapping-data.html#celestial-coordinate-systems"><i class="fa fa-check"></i><b>2.4.2</b> Celestial Coordinate Systems</a></li>
<li class="chapter" data-level="2.4.3" data-path="mapping-data.html"><a href="mapping-data.html#geographic-coordinate-systems"><i class="fa fa-check"></i><b>2.4.3</b> Geographic Coordinate Systems</a></li>
<li class="chapter" data-level="" data-path="mapping-data.html"><a href="mapping-data.html#your-turn"><i class="fa fa-check"></i>Your Turn!</a></li>
<li class="chapter" data-level="2.4.4" data-path="mapping-data.html"><a href="mapping-data.html#projected-coordinate-systems"><i class="fa fa-check"></i><b>2.4.4</b> Projected Coordinate Systems</a></li>
<li class="chapter" data-level="2.4.5" data-path="mapping-data.html"><a href="mapping-data.html#measuring-map-projection-distortion"><i class="fa fa-check"></i><b>2.4.5</b> Measuring Map Projection Distortion</a></li>
</ul></li>
<li class="chapter" data-level="2.5" data-path="mapping-data.html"><a href="mapping-data.html#map-projections-for-environmental-management"><i class="fa fa-check"></i><b>2.5</b> Map Projections for Environmental Management</a>
<ul>
<li class="chapter" data-level="2.5.1" data-path="mapping-data.html"><a href="mapping-data.html#mercator"><i class="fa fa-check"></i><b>2.5.1</b> Mercator</a></li>
<li class="chapter" data-level="2.5.2" data-path="mapping-data.html"><a href="mapping-data.html#universal-transverse-mercator-utm"><i class="fa fa-check"></i><b>2.5.2</b> Universal Transverse Mercator (UTM)</a></li>
<li class="chapter" data-level="2.5.3" data-path="mapping-data.html"><a href="mapping-data.html#sinusoidal"><i class="fa fa-check"></i><b>2.5.3</b> Sinusoidal</a></li>
<li class="chapter" data-level="2.5.4" data-path="mapping-data.html"><a href="mapping-data.html#albers"><i class="fa fa-check"></i><b>2.5.4</b> Albers</a></li>
<li class="chapter" data-level="2.5.5" data-path="mapping-data.html"><a href="mapping-data.html#azimuthal"><i class="fa fa-check"></i><b>2.5.5</b> Azimuthal</a></li>
</ul></li>
<li class="chapter" data-level="2.6" data-path="mapping-data.html"><a href="mapping-data.html#summary-1"><i class="fa fa-check"></i><b>2.6</b> Summary</a></li>
<li class="chapter" data-level="" data-path="mapping-data.html"><a href="mapping-data.html#reflection-questions-1"><i class="fa fa-check"></i>Reflection Questions</a></li>
</ul></li>
<li class="chapter" data-level="3" data-path="types-of-data.html"><a href="types-of-data.html"><i class="fa fa-check"></i><b>3</b> Data Types and Spatial Data Models</a>
<ul>
<li class="chapter" data-level="" data-path="types-of-data.html"><a href="types-of-data.html#key-terms-2"><i class="fa fa-check"></i>Key Terms</a></li>
<li class="chapter" data-level="3.1" data-path="types-of-data.html"><a href="types-of-data.html#types-of-phenomena"><i class="fa fa-check"></i><b>3.1</b> Types of Phenomena</a>
<ul>
<li class="chapter" data-level="3.1.1" data-path="types-of-data.html"><a href="types-of-data.html#discrete-objects"><i class="fa fa-check"></i><b>3.1.1</b> Discrete Objects</a></li>
<li class="chapter" data-level="3.1.2" data-path="types-of-data.html"><a href="types-of-data.html#continuous-fields"><i class="fa fa-check"></i><b>3.1.2</b> Continuous Fields</a></li>
<li class="chapter" data-level="3.1.3" data-path="types-of-data.html"><a href="types-of-data.html#imperfect-distinctions"><i class="fa fa-check"></i><b>3.1.3</b> Imperfect Distinctions</a></li>
</ul></li>
<li class="chapter" data-level="3.2" data-path="types-of-data.html"><a href="types-of-data.html#types-of-data-1"><i class="fa fa-check"></i><b>3.2</b> Types of Data</a>
<ul>
<li class="chapter" data-level="3.2.1" data-path="types-of-data.html"><a href="types-of-data.html#qualitative-data"><i class="fa fa-check"></i><b>3.2.1</b> Qualitative Data</a></li>
<li class="chapter" data-level="3.2.2" data-path="types-of-data.html"><a href="types-of-data.html#quantitative-data"><i class="fa fa-check"></i><b>3.2.2</b> Quantitative Data</a></li>
<li class="chapter" data-level="3.2.3" data-path="types-of-data.html"><a href="types-of-data.html#derived-ratio-normalizing-data"><i class="fa fa-check"></i><b>3.2.3</b> Derived Ratio: Normalizing Data</a></li>
<li class="chapter" data-level="3.2.4" data-path="types-of-data.html"><a href="types-of-data.html#summary-of-data-types"><i class="fa fa-check"></i><b>3.2.4</b> Summary of Data Types</a></li>
</ul></li>
<li class="chapter" data-level="3.3" data-path="types-of-data.html"><a href="types-of-data.html#spatial-is-special"><i class="fa fa-check"></i><b>3.3</b> Spatial Is Special</a></li>
<li class="chapter" data-level="3.4" data-path="types-of-data.html"><a href="types-of-data.html#spatial-data-models"><i class="fa fa-check"></i><b>3.4</b> Spatial Data Models</a>
<ul>
<li class="chapter" data-level="3.4.1" data-path="types-of-data.html"><a href="types-of-data.html#raster-data-model"><i class="fa fa-check"></i><b>3.4.1</b> Raster Data Model</a></li>
<li class="chapter" data-level="3.4.2" data-path="types-of-data.html"><a href="types-of-data.html#vector-data"><i class="fa fa-check"></i><b>3.4.2</b> Vector Data</a></li>
</ul></li>
<li class="chapter" data-level="3.5" data-path="types-of-data.html"><a href="types-of-data.html#choice-of-spatial-data-model"><i class="fa fa-check"></i><b>3.5</b> Choice of Spatial Data Model</a>
<ul>
<li class="chapter" data-level="3.5.1" data-path="types-of-data.html"><a href="types-of-data.html#comparing-data-models"><i class="fa fa-check"></i><b>3.5.1</b> Comparing Data Models</a></li>
<li class="chapter" data-level="3.5.2" data-path="types-of-data.html"><a href="types-of-data.html#raster-data-model-1"><i class="fa fa-check"></i><b>3.5.2</b> Raster Data Model</a></li>
<li class="chapter" data-level="3.5.3" data-path="types-of-data.html"><a href="types-of-data.html#vector-data-model"><i class="fa fa-check"></i><b>3.5.3</b> Vector Data Model</a></li>
<li class="chapter" data-level="3.5.4" data-path="types-of-data.html"><a href="types-of-data.html#which-data-model-is-best"><i class="fa fa-check"></i><b>3.5.4</b> Which Data Model is Best?</a></li>
<li class="chapter" data-level="" data-path="types-of-data.html"><a href="types-of-data.html#reflection-questions-2"><i class="fa fa-check"></i>Reflection Questions</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="4" data-path="collecting-and-editing-data.html"><a href="collecting-and-editing-data.html"><i class="fa fa-check"></i><b>4</b> Collecting and Editing Data</a>
<ul>
<li class="chapter" data-level="" data-path="collecting-and-editing-data.html"><a href="collecting-and-editing-data.html#key-terms-3"><i class="fa fa-check"></i>Key Terms</a></li>
<li class="chapter" data-level="4.1" data-path="collecting-and-editing-data.html"><a href="collecting-and-editing-data.html#open-data"><i class="fa fa-check"></i><b>4.1</b> Open Data</a></li>
<li class="chapter" data-level="4.2" data-path="collecting-and-editing-data.html"><a href="collecting-and-editing-data.html#finding-data"><i class="fa fa-check"></i><b>4.2</b> Finding Data</a></li>
<li class="chapter" data-level="4.3" data-path="collecting-and-editing-data.html"><a href="collecting-and-editing-data.html#data-in-academia"><i class="fa fa-check"></i><b>4.3</b> Data in Academia</a></li>
<li class="chapter" data-level="4.4" data-path="collecting-and-editing-data.html"><a href="collecting-and-editing-data.html#government-data"><i class="fa fa-check"></i><b>4.4</b> Government Data</a></li>
<li class="chapter" data-level="4.5" data-path="collecting-and-editing-data.html"><a href="collecting-and-editing-data.html#census-data"><i class="fa fa-check"></i><b>4.5</b> Census Data</a></li>
<li class="chapter" data-level="4.6" data-path="collecting-and-editing-data.html"><a href="collecting-and-editing-data.html#census-of-canada-geographic-levels"><i class="fa fa-check"></i><b>4.6</b> Census of Canada Geographic Levels</a></li>
<li class="chapter" data-level="4.7" data-path="collecting-and-editing-data.html"><a href="collecting-and-editing-data.html#accessing-census-data"><i class="fa fa-check"></i><b>4.7</b> Accessing Census Data</a></li>
<li class="chapter" data-level="4.8" data-path="collecting-and-editing-data.html"><a href="collecting-and-editing-data.html#non-governmental-organization-data"><i class="fa fa-check"></i><b>4.8</b> Non-Governmental Organization Data</a></li>
<li class="chapter" data-level="4.9" data-path="collecting-and-editing-data.html"><a href="collecting-and-editing-data.html#citizen-science"><i class="fa fa-check"></i><b>4.9</b> Citizen Science</a></li>
<li class="chapter" data-level="4.10" data-path="collecting-and-editing-data.html"><a href="collecting-and-editing-data.html#international-data"><i class="fa fa-check"></i><b>4.10</b> International Data</a></li>
<li class="chapter" data-level="4.11" data-path="collecting-and-editing-data.html"><a href="collecting-and-editing-data.html#metadata"><i class="fa fa-check"></i><b>4.11</b> Metadata</a></li>
<li class="chapter" data-level="4.12" data-path="collecting-and-editing-data.html"><a href="collecting-and-editing-data.html#creating-metadata"><i class="fa fa-check"></i><b>4.12</b> Creating Metadata</a></li>
<li class="chapter" data-level="4.13" data-path="collecting-and-editing-data.html"><a href="collecting-and-editing-data.html#unpublished-data-and-the-data-request"><i class="fa fa-check"></i><b>4.13</b> Unpublished Data and the Data Request</a></li>
<li class="chapter" data-level="4.14" data-path="collecting-and-editing-data.html"><a href="collecting-and-editing-data.html#historical-data-collections"><i class="fa fa-check"></i><b>4.14</b> Historical Data Collections</a>
<ul>
<li class="chapter" data-level="4.14.1" data-path="collecting-and-editing-data.html"><a href="collecting-and-editing-data.html#historical-aerial-photographs"><i class="fa fa-check"></i><b>4.14.1</b> Historical Aerial Photographs</a></li>
<li class="chapter" data-level="4.14.2" data-path="collecting-and-editing-data.html"><a href="collecting-and-editing-data.html#accessing-historical-aerial-photograph-collections"><i class="fa fa-check"></i><b>4.14.2</b> Accessing Historical Aerial Photograph Collections</a></li>
</ul></li>
<li class="chapter" data-level="4.15" data-path="collecting-and-editing-data.html"><a href="collecting-and-editing-data.html#natural-resource-administrative-data"><i class="fa fa-check"></i><b>4.15</b> Natural Resource Administrative Data</a></li>
<li class="chapter" data-level="4.16" data-path="collecting-and-editing-data.html"><a href="collecting-and-editing-data.html#historical-maps"><i class="fa fa-check"></i><b>4.16</b> Historical Maps</a></li>
<li class="chapter" data-level="4.17" data-path="collecting-and-editing-data.html"><a href="collecting-and-editing-data.html#georeferencing-historical-maps"><i class="fa fa-check"></i><b>4.17</b> Georeferencing Historical Maps</a>
<ul>
<li class="chapter" data-level="4.17.1" data-path="collecting-and-editing-data.html"><a href="collecting-and-editing-data.html#control-points-on-maps-with-grids-or-graticule"><i class="fa fa-check"></i><b>4.17.1</b> Control Points on Maps with Grids or Graticule</a></li>
<li class="chapter" data-level="4.17.2" data-path="collecting-and-editing-data.html"><a href="collecting-and-editing-data.html#grid-and-graticule-as-control-points"><i class="fa fa-check"></i><b>4.17.2</b> Grid and Graticule as Control Points</a></li>
<li class="chapter" data-level="4.17.3" data-path="collecting-and-editing-data.html"><a href="collecting-and-editing-data.html#rubbersheeting"><i class="fa fa-check"></i><b>4.17.3</b> Rubbersheeting</a></li>
<li class="chapter" data-level="4.17.4" data-path="collecting-and-editing-data.html"><a href="collecting-and-editing-data.html#documenting-georeferencing"><i class="fa fa-check"></i><b>4.17.4</b> Documenting Georeferencing</a></li>
</ul></li>
<li class="chapter" data-level="4.18" data-path="collecting-and-editing-data.html"><a href="collecting-and-editing-data.html#summary-2"><i class="fa fa-check"></i><b>4.18</b> Summary</a></li>
<li class="chapter" data-level="4.19" data-path="collecting-and-editing-data.html"><a href="collecting-and-editing-data.html#reflection-questions-3"><i class="fa fa-check"></i><b>4.19</b> Reflection Questions</a></li>
<li class="chapter" data-level="4.20" data-path="collecting-and-editing-data.html"><a href="collecting-and-editing-data.html#practice-questions-1"><i class="fa fa-check"></i><b>4.20</b> Practice Questions</a></li>
</ul></li>
<li class="chapter" data-level="5" data-path="relational-databases.html"><a href="relational-databases.html"><i class="fa fa-check"></i><b>5</b> Relational Databases</a>
<ul>
<li class="chapter" data-level="" data-path="relational-databases.html"><a href="relational-databases.html#key-terms-4"><i class="fa fa-check"></i>Key Terms</a></li>
<li class="chapter" data-level="5.1" data-path="relational-databases.html"><a href="relational-databases.html#relational-database-management-systems"><i class="fa fa-check"></i><b>5.1</b> Relational Database Management Systems</a></li>
<li class="chapter" data-level="5.2" data-path="relational-databases.html"><a href="relational-databases.html#relational-databases-1"><i class="fa fa-check"></i><b>5.2</b> Relational Databases</a></li>
<li class="chapter" data-level="5.3" data-path="relational-databases.html"><a href="relational-databases.html#relational-algebra"><i class="fa fa-check"></i><b>5.3</b> Relational Algebra</a></li>
<li class="chapter" data-level="5.4" data-path="relational-databases.html"><a href="relational-databases.html#selection"><i class="fa fa-check"></i><b>5.4</b> Selection</a></li>
<li class="chapter" data-level="5.5" data-path="relational-databases.html"><a href="relational-databases.html#projection"><i class="fa fa-check"></i><b>5.5</b> Projection</a></li>
<li class="chapter" data-level="5.6" data-path="relational-databases.html"><a href="relational-databases.html#rename"><i class="fa fa-check"></i><b>5.6</b> Rename</a></li>
<li class="chapter" data-level="5.7" data-path="relational-databases.html"><a href="relational-databases.html#set-union"><i class="fa fa-check"></i><b>5.7</b> Set Union</a></li>
<li class="chapter" data-level="5.8" data-path="relational-databases.html"><a href="relational-databases.html#set-intersection"><i class="fa fa-check"></i><b>5.8</b> Set Intersection</a></li>
<li class="chapter" data-level="5.9" data-path="relational-databases.html"><a href="relational-databases.html#set-difference"><i class="fa fa-check"></i><b>5.9</b> Set Difference</a></li>
<li class="chapter" data-level="5.10" data-path="relational-databases.html"><a href="relational-databases.html#cartesian-product"><i class="fa fa-check"></i><b>5.10</b> Cartesian Product</a></li>
<li class="chapter" data-level="5.11" data-path="relational-databases.html"><a href="relational-databases.html#set-divison"><i class="fa fa-check"></i><b>5.11</b> Set Divison</a></li>
<li class="chapter" data-level="5.12" data-path="relational-databases.html"><a href="relational-databases.html#boolean-algebra"><i class="fa fa-check"></i><b>5.12</b> Boolean Algebra</a></li>
<li class="chapter" data-level="5.13" data-path="relational-databases.html"><a href="relational-databases.html#equality-operators"><i class="fa fa-check"></i><b>5.13</b> Equality Operators</a></li>
<li class="chapter" data-level="5.14" data-path="relational-databases.html"><a href="relational-databases.html#conditional-operators"><i class="fa fa-check"></i><b>5.14</b> Conditional Operators</a></li>
<li class="chapter" data-level="5.15" data-path="relational-databases.html"><a href="relational-databases.html#joining-relations"><i class="fa fa-check"></i><b>5.15</b> Joining Relations</a></li>
<li class="chapter" data-level="5.16" data-path="relational-databases.html"><a href="relational-databases.html#keys"><i class="fa fa-check"></i><b>5.16</b> Keys</a></li>
<li class="chapter" data-level="5.17" data-path="relational-databases.html"><a href="relational-databases.html#natural-join"><i class="fa fa-check"></i><b>5.17</b> Natural Join</a></li>
<li class="chapter" data-level="5.18" data-path="relational-databases.html"><a href="relational-databases.html#outer-join"><i class="fa fa-check"></i><b>5.18</b> Outer Join</a></li>
<li class="chapter" data-level="5.19" data-path="relational-databases.html"><a href="relational-databases.html#right-and-left-outer-join"><i class="fa fa-check"></i><b>5.19</b> Right and Left Outer Join</a></li>
<li class="chapter" data-level="5.20" data-path="relational-databases.html"><a href="relational-databases.html#theta-join"><i class="fa fa-check"></i><b>5.20</b> Theta Join</a></li>
<li class="chapter" data-level="5.21" data-path="relational-databases.html"><a href="relational-databases.html#cardinality-of-joins"><i class="fa fa-check"></i><b>5.21</b> Cardinality of Joins</a></li>
<li class="chapter" data-level="5.22" data-path="relational-databases.html"><a href="relational-databases.html#structured-query-language"><i class="fa fa-check"></i><b>5.22</b> Structured Query Language</a></li>
<li class="chapter" data-level="5.23" data-path="relational-databases.html"><a href="relational-databases.html#case-study-combining-socioeconomic-and-vegetation-information-for-assessing-population-vulnerability"><i class="fa fa-check"></i><b>5.23</b> Case Study: Combining Socioeconomic and Vegetation Information for Assessing Population Vulnerability</a></li>
<li class="chapter" data-level="5.24" data-path="relational-databases.html"><a href="relational-databases.html#join"><i class="fa fa-check"></i><b>5.24</b> Join</a></li>
<li class="chapter" data-level="5.25" data-path="relational-databases.html"><a href="relational-databases.html#calculation"><i class="fa fa-check"></i><b>5.25</b> Calculation</a></li>
<li class="chapter" data-level="5.26" data-path="relational-databases.html"><a href="relational-databases.html#query"><i class="fa fa-check"></i><b>5.26</b> Query</a></li>
</ul></li>
<li class="chapter" data-level="6" data-path="topology.html"><a href="topology.html"><i class="fa fa-check"></i><b>6</b> Topology and Geocoding</a>
<ul>
<li class="chapter" data-level="" data-path="topology.html"><a href="topology.html#key-terms-5"><i class="fa fa-check"></i>Key Terms</a></li>
<li class="chapter" data-level="6.1" data-path="topology.html"><a href="topology.html#topology-1"><i class="fa fa-check"></i><b>6.1</b> Topology</a></li>
<li class="chapter" data-level="6.2" data-path="topology.html"><a href="topology.html#planar-vs.-non-planar-topology"><i class="fa fa-check"></i><b>6.2</b> Planar vs. Non-Planar Topology</a></li>
<li class="chapter" data-level="6.3" data-path="topology.html"><a href="topology.html#implementing-planar-topology"><i class="fa fa-check"></i><b>6.3</b> Implementing Planar Topology</a></li>
<li class="chapter" data-level="6.4" data-path="topology.html"><a href="topology.html#adjacency-and-overlap"><i class="fa fa-check"></i><b>6.4</b> Adjacency and Overlap</a></li>
<li class="chapter" data-level="6.5" data-path="topology.html"><a href="topology.html#intersect-and-connect"><i class="fa fa-check"></i><b>6.5</b> Intersect and Connect</a></li>
<li class="chapter" data-level="6.6" data-path="topology.html"><a href="topology.html#coincident-and-disjoint"><i class="fa fa-check"></i><b>6.6</b> Coincident and Disjoint</a></li>
<li class="chapter" data-level="6.7" data-path="topology.html"><a href="topology.html#cover"><i class="fa fa-check"></i><b>6.7</b> Cover</a>
<ul>
<li class="chapter" data-level="6.7.1" data-path="topology.html"><a href="topology.html#multipart-geometry"><i class="fa fa-check"></i><b>6.7.1</b> Multipart geometry</a></li>
<li class="chapter" data-level="6.7.2" data-path="topology.html"><a href="topology.html#holes"><i class="fa fa-check"></i><b>6.7.2</b> Holes</a></li>
<li class="chapter" data-level="6.7.3" data-path="topology.html"><a href="topology.html#delaunay-triangulation"><i class="fa fa-check"></i><b>6.7.3</b> Delaunay triangulation</a></li>
<li class="chapter" data-level="6.7.4" data-path="topology.html"><a href="topology.html#thiessen-polygons"><i class="fa fa-check"></i><b>6.7.4</b> Thiessen polygons</a></li>
<li class="chapter" data-level="6.7.5" data-path="topology.html"><a href="topology.html#centroids"><i class="fa fa-check"></i><b>6.7.5</b> Centroids</a></li>
<li class="chapter" data-level="6.7.6" data-path="topology.html"><a href="topology.html#convex-hull"><i class="fa fa-check"></i><b>6.7.6</b> Convex hull</a></li>
<li class="chapter" data-level="6.7.7" data-path="topology.html"><a href="topology.html#convex-alpha-hulls-and-alpha-shapes"><i class="fa fa-check"></i><b>6.7.7</b> Convex alpha hulls and alpha shapes</a></li>
</ul></li>
<li class="chapter" data-level="6.8" data-path="topology.html"><a href="topology.html#d-topologies"><i class="fa fa-check"></i><b>6.8</b> 3D topologies</a>
<ul>
<li class="chapter" data-level="6.8.1" data-path="topology.html"><a href="topology.html#multipatch-geometries"><i class="fa fa-check"></i><b>6.8.1</b> Multipatch geometries</a></li>
<li class="chapter" data-level="6.8.2" data-path="topology.html"><a href="topology.html#d-convex-hull"><i class="fa fa-check"></i><b>6.8.2</b> 3D Convex hull</a></li>
<li class="chapter" data-level="6.8.3" data-path="topology.html"><a href="topology.html#d-convex-alpha-hull"><i class="fa fa-check"></i><b>6.8.3</b> 3D Convex alpha hull</a></li>
<li class="chapter" data-level="6.8.4" data-path="topology.html"><a href="topology.html#d-voronoi-tessellation"><i class="fa fa-check"></i><b>6.8.4</b> 3D Voronoi tessellation</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="topology.html"><a href="topology.html#reflection-questions-4"><i class="fa fa-check"></i>Reflection Questions</a></li>
<li class="chapter" data-level="" data-path="topology.html"><a href="topology.html#practice-questions-2"><i class="fa fa-check"></i>Practice Questions</a></li>
<li class="chapter" data-level="" data-path="topology.html"><a href="topology.html#recommended-readings"><i class="fa fa-check"></i>Recommended Readings</a></li>
</ul></li>
<li class="chapter" data-level="7" data-path="network-analysis.html"><a href="network-analysis.html"><i class="fa fa-check"></i><b>7</b> Network Analysis</a>
<ul>
<li class="chapter" data-level="" data-path="network-analysis.html"><a href="network-analysis.html#key-terms-6"><i class="fa fa-check"></i>Key Terms</a></li>
<li class="chapter" data-level="7.1" data-path="network-analysis.html"><a href="network-analysis.html#introduction-to-graph-theory"><i class="fa fa-check"></i><b>7.1</b> Introduction to Graph Theory</a></li>
<li class="chapter" data-level="7.2" data-path="network-analysis.html"><a href="network-analysis.html#nodes"><i class="fa fa-check"></i><b>7.2</b> Nodes</a></li>
<li class="chapter" data-level="7.3" data-path="network-analysis.html"><a href="network-analysis.html#edges"><i class="fa fa-check"></i><b>7.3</b> Edges</a></li>
<li class="chapter" data-level="7.4" data-path="network-analysis.html"><a href="network-analysis.html#connectivity-and-order"><i class="fa fa-check"></i><b>7.4</b> Connectivity and Order</a></li>
<li class="chapter" data-level="7.5" data-path="network-analysis.html"><a href="network-analysis.html#direct"><i class="fa fa-check"></i><b>7.5</b> Direct</a></li>
<li class="chapter" data-level="7.6" data-path="network-analysis.html"><a href="network-analysis.html#undirect"><i class="fa fa-check"></i><b>7.6</b> Undirect</a></li>
<li class="chapter" data-level="7.7" data-path="network-analysis.html"><a href="network-analysis.html#network-topologies"><i class="fa fa-check"></i><b>7.7</b> Network Topologies</a></li>
<li class="chapter" data-level="7.8" data-path="network-analysis.html"><a href="network-analysis.html#physical-vs.-logical-topology"><i class="fa fa-check"></i><b>7.8</b> Physical vs. Logical Topology</a></li>
<li class="chapter" data-level="7.9" data-path="network-analysis.html"><a href="network-analysis.html#non-hierarchical-topologies"><i class="fa fa-check"></i><b>7.9</b> Non-Hierarchical Topologies</a>
<ul>
<li class="chapter" data-level="7.9.1" data-path="network-analysis.html"><a href="network-analysis.html#lines"><i class="fa fa-check"></i><b>7.9.1</b> Lines</a></li>
<li class="chapter" data-level="7.9.2" data-path="network-analysis.html"><a href="network-analysis.html#rings"><i class="fa fa-check"></i><b>7.9.2</b> Rings</a></li>
<li class="chapter" data-level="7.9.3" data-path="network-analysis.html"><a href="network-analysis.html#meshes"><i class="fa fa-check"></i><b>7.9.3</b> Meshes</a></li>
<li class="chapter" data-level="7.9.4" data-path="network-analysis.html"><a href="network-analysis.html#fully-connected"><i class="fa fa-check"></i><b>7.9.4</b> Fully Connected</a></li>
</ul></li>
<li class="chapter" data-level="7.10" data-path="network-analysis.html"><a href="network-analysis.html#hierarchical-topologies"><i class="fa fa-check"></i><b>7.10</b> Hierarchical Topologies</a>
<ul>
<li class="chapter" data-level="7.10.1" data-path="network-analysis.html"><a href="network-analysis.html#stars"><i class="fa fa-check"></i><b>7.10.1</b> Stars</a></li>
<li class="chapter" data-level="7.10.2" data-path="network-analysis.html"><a href="network-analysis.html#buses"><i class="fa fa-check"></i><b>7.10.2</b> Buses</a></li>
<li class="chapter" data-level="7.10.3" data-path="network-analysis.html"><a href="network-analysis.html#trees"><i class="fa fa-check"></i><b>7.10.3</b> Trees</a></li>
</ul></li>
<li class="chapter" data-level="7.11" data-path="network-analysis.html"><a href="network-analysis.html#spatial-network-analysis"><i class="fa fa-check"></i><b>7.11</b> Spatial Network Analysis</a></li>
<li class="chapter" data-level="7.12" data-path="network-analysis.html"><a href="network-analysis.html#network-tracing"><i class="fa fa-check"></i><b>7.12</b> Network Tracing</a></li>
<li class="chapter" data-level="7.13" data-path="network-analysis.html"><a href="network-analysis.html#linear-referencing"><i class="fa fa-check"></i><b>7.13</b> Linear Referencing</a></li>
<li class="chapter" data-level="7.14" data-path="network-analysis.html"><a href="network-analysis.html#geocoding"><i class="fa fa-check"></i><b>7.14</b> Geocoding</a>
<ul>
<li class="chapter" data-level="7.14.1" data-path="network-analysis.html"><a href="network-analysis.html#geocoding-assumptions-and-limitations"><i class="fa fa-check"></i><b>7.14.1</b> Geocoding Assumptions and Limitations</a></li>
<li class="chapter" data-level="7.14.2" data-path="network-analysis.html"><a href="network-analysis.html#geocoding-services"><i class="fa fa-check"></i><b>7.14.2</b> Geocoding Services</a></li>
</ul></li>
<li class="chapter" data-level="7.15" data-path="network-analysis.html"><a href="network-analysis.html#routing"><i class="fa fa-check"></i><b>7.15</b> Routing</a></li>
<li class="chapter" data-level="7.16" data-path="network-analysis.html"><a href="network-analysis.html#least-cost-paths"><i class="fa fa-check"></i><b>7.16</b> Least Cost Paths</a></li>
<li class="chapter" data-level="7.17" data-path="network-analysis.html"><a href="network-analysis.html#reach-analysis"><i class="fa fa-check"></i><b>7.17</b> Reach Analysis</a></li>
<li class="chapter" data-level="7.18" data-path="network-analysis.html"><a href="network-analysis.html#network-centrality"><i class="fa fa-check"></i><b>7.18</b> Network Centrality</a></li>
<li class="chapter" data-level="7.19" data-path="network-analysis.html"><a href="network-analysis.html#closeness-centrality"><i class="fa fa-check"></i><b>7.19</b> Closeness Centrality</a></li>
<li class="chapter" data-level="7.20" data-path="network-analysis.html"><a href="network-analysis.html#betweenness-centrality"><i class="fa fa-check"></i><b>7.20</b> Betweenness Centrality</a></li>
<li class="chapter" data-level="7.21" data-path="network-analysis.html"><a href="network-analysis.html#case-study-central-and-peripheral-green-spaces-in-vancouver"><i class="fa fa-check"></i><b>7.21</b> Case Study: Central and Peripheral Green Spaces in Vancouver</a></li>
<li class="chapter" data-level="" data-path="network-analysis.html"><a href="network-analysis.html#reflection-questions-5"><i class="fa fa-check"></i>Reflection Questions</a></li>
</ul></li>
<li class="chapter" data-level="8" data-path="raster-analysis-and-terrain-modelling.html"><a href="raster-analysis-and-terrain-modelling.html"><i class="fa fa-check"></i><b>8</b> Raster Analysis and Terrain Modelling</a>
<ul>
<li class="chapter" data-level="" data-path="raster-analysis-and-terrain-modelling.html"><a href="raster-analysis-and-terrain-modelling.html#key-terms-7"><i class="fa fa-check"></i>Key Terms</a></li>
<li class="chapter" data-level="8.1" data-path="raster-analysis-and-terrain-modelling.html"><a href="raster-analysis-and-terrain-modelling.html#raster-analysis"><i class="fa fa-check"></i><b>8.1</b> Raster Analysis</a></li>
<li class="chapter" data-level="8.2" data-path="raster-analysis-and-terrain-modelling.html"><a href="raster-analysis-and-terrain-modelling.html#digital-vertical-models"><i class="fa fa-check"></i><b>8.2</b> Digital Vertical Models</a></li>
<li class="chapter" data-level="8.3" data-path="raster-analysis-and-terrain-modelling.html"><a href="raster-analysis-and-terrain-modelling.html#digital-elevation-models-dem"><i class="fa fa-check"></i><b>8.3</b> Digital Elevation Models (DEM)</a></li>
<li class="chapter" data-level="8.4" data-path="raster-analysis-and-terrain-modelling.html"><a href="raster-analysis-and-terrain-modelling.html#digital-terrain-models-dtm"><i class="fa fa-check"></i><b>8.4</b> Digital Terrain Models (DTM)</a></li>
<li class="chapter" data-level="8.5" data-path="raster-analysis-and-terrain-modelling.html"><a href="raster-analysis-and-terrain-modelling.html#digital-surface-models-dsm"><i class="fa fa-check"></i><b>8.5</b> Digital Surface Models (DSM)</a></li>
<li class="chapter" data-level="8.6" data-path="raster-analysis-and-terrain-modelling.html"><a href="raster-analysis-and-terrain-modelling.html#raster-functions"><i class="fa fa-check"></i><b>8.6</b> Raster Functions</a>
<ul>
<li class="chapter" data-level="8.6.1" data-path="raster-analysis-and-terrain-modelling.html"><a href="raster-analysis-and-terrain-modelling.html#local"><i class="fa fa-check"></i><b>8.6.1</b> Local</a></li>
<li class="chapter" data-level="8.6.2" data-path="raster-analysis-and-terrain-modelling.html"><a href="raster-analysis-and-terrain-modelling.html#focal"><i class="fa fa-check"></i><b>8.6.2</b> Focal</a></li>
<li class="chapter" data-level="8.6.3" data-path="raster-analysis-and-terrain-modelling.html"><a href="raster-analysis-and-terrain-modelling.html#global"><i class="fa fa-check"></i><b>8.6.3</b> Global</a></li>
<li class="chapter" data-level="8.6.4" data-path="raster-analysis-and-terrain-modelling.html"><a href="raster-analysis-and-terrain-modelling.html#zonal"><i class="fa fa-check"></i><b>8.6.4</b> Zonal</a></li>
</ul></li>
<li class="chapter" data-level="8.7" data-path="raster-analysis-and-terrain-modelling.html"><a href="raster-analysis-and-terrain-modelling.html#derivatives-of-elevation-models"><i class="fa fa-check"></i><b>8.7</b> Derivatives of Elevation Models</a>
<ul>
<li class="chapter" data-level="8.7.1" data-path="raster-analysis-and-terrain-modelling.html"><a href="raster-analysis-and-terrain-modelling.html#slope"><i class="fa fa-check"></i><b>8.7.1</b> Slope</a></li>
<li class="chapter" data-level="8.7.2" data-path="raster-analysis-and-terrain-modelling.html"><a href="raster-analysis-and-terrain-modelling.html#aspect"><i class="fa fa-check"></i><b>8.7.2</b> Aspect</a></li>
<li class="chapter" data-level="8.7.3" data-path="raster-analysis-and-terrain-modelling.html"><a href="raster-analysis-and-terrain-modelling.html#heat-load-index"><i class="fa fa-check"></i><b>8.7.3</b> Heat Load Index</a></li>
<li class="chapter" data-level="8.7.4" data-path="raster-analysis-and-terrain-modelling.html"><a href="raster-analysis-and-terrain-modelling.html#hillshade"><i class="fa fa-check"></i><b>8.7.4</b> Hillshade</a></li>
</ul></li>
<li class="chapter" data-level="8.8" data-path="raster-analysis-and-terrain-modelling.html"><a href="raster-analysis-and-terrain-modelling.html#sinks-peaks-and-saddles-oh-my"><i class="fa fa-check"></i><b>8.8</b> Sinks, Peaks, and Saddles Oh My!</a></li>
<li class="chapter" data-level="8.9" data-path="raster-analysis-and-terrain-modelling.html"><a href="raster-analysis-and-terrain-modelling.html#landform-classification"><i class="fa fa-check"></i><b>8.9</b> Landform Classification</a></li>
<li class="chapter" data-level="8.10" data-path="raster-analysis-and-terrain-modelling.html"><a href="raster-analysis-and-terrain-modelling.html#profile-and-planform-curvature"><i class="fa fa-check"></i><b>8.10</b> Profile and Planform Curvature</a></li>
<li class="chapter" data-level="8.11" data-path="raster-analysis-and-terrain-modelling.html"><a href="raster-analysis-and-terrain-modelling.html#topographic-position-index"><i class="fa fa-check"></i><b>8.11</b> Topographic Position Index</a></li>
<li class="chapter" data-level="8.12" data-path="raster-analysis-and-terrain-modelling.html"><a href="raster-analysis-and-terrain-modelling.html#hydrology-workflows"><i class="fa fa-check"></i><b>8.12</b> Hydrology Work”flows”</a>
<ul>
<li class="chapter" data-level="8.12.1" data-path="raster-analysis-and-terrain-modelling.html"><a href="raster-analysis-and-terrain-modelling.html#flow-direction-and-flow-accumulation"><i class="fa fa-check"></i><b>8.12.1</b> Flow Direction and Flow Accumulation</a></li>
<li class="chapter" data-level="8.12.2" data-path="raster-analysis-and-terrain-modelling.html"><a href="raster-analysis-and-terrain-modelling.html#stream-delineation"><i class="fa fa-check"></i><b>8.12.2</b> Stream Delineation</a></li>
<li class="chapter" data-level="8.12.3" data-path="raster-analysis-and-terrain-modelling.html"><a href="raster-analysis-and-terrain-modelling.html#stream-order"><i class="fa fa-check"></i><b>8.12.3</b> Stream Order</a></li>
<li class="chapter" data-level="8.12.4" data-path="raster-analysis-and-terrain-modelling.html"><a href="raster-analysis-and-terrain-modelling.html#flow-length"><i class="fa fa-check"></i><b>8.12.4</b> Flow Length</a></li>
<li class="chapter" data-level="8.12.5" data-path="raster-analysis-and-terrain-modelling.html"><a href="raster-analysis-and-terrain-modelling.html#watershed-delineation"><i class="fa fa-check"></i><b>8.12.5</b> Watershed Delineation</a></li>
<li class="chapter" data-level="8.12.6" data-path="raster-analysis-and-terrain-modelling.html"><a href="raster-analysis-and-terrain-modelling.html#topographic-wetness-index"><i class="fa fa-check"></i><b>8.12.6</b> Topographic Wetness Index</a></li>
</ul></li>
<li class="chapter" data-level="8.13" data-path="raster-analysis-and-terrain-modelling.html"><a href="raster-analysis-and-terrain-modelling.html#case-study-topographic-indices-for-wetland-mapping"><i class="fa fa-check"></i><b>8.13</b> Case Study: Topographic Indices for Wetland Mapping</a></li>
<li class="chapter" data-level="8.14" data-path="raster-analysis-and-terrain-modelling.html"><a href="raster-analysis-and-terrain-modelling.html#d-geovisualization"><i class="fa fa-check"></i><b>8.14</b> 3D Geovisualization</a>
<ul>
<li class="chapter" data-level="8.14.1" data-path="raster-analysis-and-terrain-modelling.html"><a href="raster-analysis-and-terrain-modelling.html#anaglyphs"><i class="fa fa-check"></i><b>8.14.1</b> Anaglyphs</a></li>
<li class="chapter" data-level="8.14.2" data-path="raster-analysis-and-terrain-modelling.html"><a href="raster-analysis-and-terrain-modelling.html#viewsheds"><i class="fa fa-check"></i><b>8.14.2</b> Viewsheds</a></li>
<li class="chapter" data-level="8.14.3" data-path="raster-analysis-and-terrain-modelling.html"><a href="raster-analysis-and-terrain-modelling.html#extrusion"><i class="fa fa-check"></i><b>8.14.3</b> Extrusion</a></li>
<li class="chapter" data-level="8.14.4" data-path="raster-analysis-and-terrain-modelling.html"><a href="raster-analysis-and-terrain-modelling.html#exaggeration"><i class="fa fa-check"></i><b>8.14.4</b> Exaggeration</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="9" data-path="spatial-estimation.html"><a href="spatial-estimation.html"><i class="fa fa-check"></i><b>9</b> Spatial Estimation</a>
<ul>
<li class="chapter" data-level="" data-path="spatial-estimation.html"><a href="spatial-estimation.html#key-terms-8"><i class="fa fa-check"></i>Key Terms</a></li>
<li class="chapter" data-level="9.1" data-path="spatial-estimation.html"><a href="spatial-estimation.html#spatial-autocorrelation"><i class="fa fa-check"></i><b>9.1</b> Spatial Autocorrelation</a></li>
<li class="chapter" data-level="9.4" data-path="spatial-estimation.html"><a href="spatial-estimation.html#morans-i"><i class="fa fa-check"></i><b>9.4</b> Moran’s I</a></li>
<li class="chapter" data-level="9.5" data-path="spatial-estimation.html"><a href="spatial-estimation.html#case-study-1"><i class="fa fa-check"></i><b>9.5</b> Case Study 1</a></li>
<li class="chapter" data-level="" data-path="spatial-estimation.html"><a href="spatial-estimation.html#calculating-morans-i"><i class="fa fa-check"></i>Calculating Moran’s I</a></li>
<li class="chapter" data-level="" data-path="spatial-estimation.html"><a href="spatial-estimation.html#using-contiguity"><i class="fa fa-check"></i>Using Contiguity</a></li>
<li class="chapter" data-level="9.6" data-path="spatial-estimation.html"><a href="spatial-estimation.html#gearys-c"><i class="fa fa-check"></i><b>9.6</b> Geary’s C</a></li>
<li class="chapter" data-level="9.7" data-path="spatial-estimation.html"><a href="spatial-estimation.html#populations-samples-and-statistics"><i class="fa fa-check"></i><b>9.7</b> Populations, Samples and Statistics</a></li>
<li class="chapter" data-level="9.8" data-path="spatial-estimation.html"><a href="spatial-estimation.html#significance-testing"><i class="fa fa-check"></i><b>9.8</b> Significance Testing</a></li>
<li class="chapter" data-level="9.9" data-path="spatial-estimation.html"><a href="spatial-estimation.html#classical-statistics-vs.-geostatistics"><i class="fa fa-check"></i><b>9.9</b> Classical Statistics vs. Geostatistics</a></li>
<li class="chapter" data-level="9.10" data-path="spatial-estimation.html"><a href="spatial-estimation.html#semivariogram-modeling"><i class="fa fa-check"></i><b>9.10</b> Semivariogram Modeling</a>
<ul>
<li class="chapter" data-level="9.10.1" data-path="spatial-estimation.html"><a href="spatial-estimation.html#nugget-variogram-model"><i class="fa fa-check"></i><b>9.10.1</b> Nugget variogram model</a></li>
<li class="chapter" data-level="9.10.2" data-path="spatial-estimation.html"><a href="spatial-estimation.html#linear-variogram-model"><i class="fa fa-check"></i><b>9.10.2</b> Linear variogram model</a></li>
<li class="chapter" data-level="9.10.3" data-path="spatial-estimation.html"><a href="spatial-estimation.html#quadratic-variogram-model"><i class="fa fa-check"></i><b>9.10.3</b> Quadratic variogram model</a></li>
<li class="chapter" data-level="9.10.4" data-path="spatial-estimation.html"><a href="spatial-estimation.html#exponential-variogram-model"><i class="fa fa-check"></i><b>9.10.4</b> Exponential variogram model</a></li>
<li class="chapter" data-level="9.10.5" data-path="spatial-estimation.html"><a href="spatial-estimation.html#gaussian-variogram-model"><i class="fa fa-check"></i><b>9.10.5</b> Gaussian variogram model</a></li>
<li class="chapter" data-level="9.10.6" data-path="spatial-estimation.html"><a href="spatial-estimation.html#spherical-variogram-model"><i class="fa fa-check"></i><b>9.10.6</b> Spherical variogram model</a></li>
<li class="chapter" data-level="9.10.7" data-path="spatial-estimation.html"><a href="spatial-estimation.html#power-variogram-model"><i class="fa fa-check"></i><b>9.10.7</b> Power variogram model</a></li>
<li class="chapter" data-level="" data-path="spatial-estimation.html"><a href="spatial-estimation.html#case-study-selecting-the-appropriate-variogram-model"><i class="fa fa-check"></i>Case Study: Selecting the appropriate variogram model</a></li>
</ul></li>
<li class="chapter" data-level="9.11" data-path="spatial-estimation.html"><a href="spatial-estimation.html#sampling"><i class="fa fa-check"></i><b>9.11</b> Sampling</a></li>
<li class="chapter" data-level="9.15" data-path="spatial-estimation.html"><a href="spatial-estimation.html#probability-sampling"><i class="fa fa-check"></i><b>9.15</b> Probability Sampling</a></li>
<li class="chapter" data-level="9.16" data-path="spatial-estimation.html"><a href="spatial-estimation.html#simple-random-sampling"><i class="fa fa-check"></i><b>9.16</b> Simple Random Sampling</a></li>
<li class="chapter" data-level="9.17" data-path="spatial-estimation.html"><a href="spatial-estimation.html#stratified-random-sampling"><i class="fa fa-check"></i><b>9.17</b> Stratified Random Sampling</a></li>
<li class="chapter" data-level="9.18" data-path="spatial-estimation.html"><a href="spatial-estimation.html#systematic-sampling"><i class="fa fa-check"></i><b>9.18</b> Systematic Sampling</a></li>
<li class="chapter" data-level="9.19" data-path="spatial-estimation.html"><a href="spatial-estimation.html#cluster-sampling"><i class="fa fa-check"></i><b>9.19</b> Cluster Sampling</a></li>
<li class="chapter" data-level="9.20" data-path="spatial-estimation.html"><a href="spatial-estimation.html#non-probability-sampling"><i class="fa fa-check"></i><b>9.20</b> Non-probability Sampling</a></li>
<li class="chapter" data-level="9.21" data-path="spatial-estimation.html"><a href="spatial-estimation.html#representative-sampling"><i class="fa fa-check"></i><b>9.21</b> Representative Sampling</a></li>
<li class="chapter" data-level="9.22" data-path="spatial-estimation.html"><a href="spatial-estimation.html#unique-case-sampling"><i class="fa fa-check"></i><b>9.22</b> Unique Case Sampling</a></li>
<li class="chapter" data-level="9.23" data-path="spatial-estimation.html"><a href="spatial-estimation.html#sequential-sampling"><i class="fa fa-check"></i><b>9.23</b> Sequential Sampling</a></li>
<li class="chapter" data-level="9.24" data-path="spatial-estimation.html"><a href="spatial-estimation.html#spatial-interpolation"><i class="fa fa-check"></i><b>9.24</b> Spatial Interpolation</a></li>
<li class="chapter" data-level="9.25" data-path="spatial-estimation.html"><a href="spatial-estimation.html#case-study-3"><i class="fa fa-check"></i><b>9.25</b> Case Study 3</a></li>
<li class="chapter" data-level="9.26" data-path="spatial-estimation.html"><a href="spatial-estimation.html#methods-without-using-semi-variogram"><i class="fa fa-check"></i><b>9.26</b> Methods Without Using Semi-variogram</a></li>
<li class="chapter" data-level="9.27" data-path="spatial-estimation.html"><a href="spatial-estimation.html#nearest-neighbor"><i class="fa fa-check"></i><b>9.27</b> Nearest Neighbor</a></li>
<li class="chapter" data-level="9.28" data-path="spatial-estimation.html"><a href="spatial-estimation.html#thiessian-polygon"><i class="fa fa-check"></i><b>9.28</b> Thiessian Polygon</a></li>
<li class="chapter" data-level="9.29" data-path="spatial-estimation.html"><a href="spatial-estimation.html#methods-using-semi-variogram"><i class="fa fa-check"></i><b>9.29</b> Methods Using Semi-variogram</a></li>
<li class="chapter" data-level="9.30" data-path="spatial-estimation.html"><a href="spatial-estimation.html#kriging"><i class="fa fa-check"></i><b>9.30</b> Kriging</a>
<ul>
<li class="chapter" data-level="9.30.1" data-path="spatial-estimation.html"><a href="spatial-estimation.html#linear-kriging"><i class="fa fa-check"></i><b>9.30.1</b> Linear Kriging</a></li>
</ul></li>
<li class="chapter" data-level="9.31" data-path="spatial-estimation.html"><a href="spatial-estimation.html#case-study-4"><i class="fa fa-check"></i><b>9.31</b> Case Study 4</a></li>
<li class="chapter" data-level="9.32" data-path="spatial-estimation.html"><a href="spatial-estimation.html#simple-kriging"><i class="fa fa-check"></i><b>9.32</b> Simple Kriging</a></li>
<li class="chapter" data-level="9.33" data-path="spatial-estimation.html"><a href="spatial-estimation.html#ordinary-kriging"><i class="fa fa-check"></i><b>9.33</b> Ordinary Kriging</a></li>
<li class="chapter" data-level="9.34" data-path="spatial-estimation.html"><a href="spatial-estimation.html#universal-kriging"><i class="fa fa-check"></i><b>9.34</b> Universal Kriging</a></li>
<li class="chapter" data-level="" data-path="spatial-estimation.html"><a href="spatial-estimation.html#which-method-is-the-best-given-our-data"><i class="fa fa-check"></i>Which method is the best given our data?</a></li>
<li class="chapter" data-level="9.35" data-path="spatial-estimation.html"><a href="spatial-estimation.html#co-kriging"><i class="fa fa-check"></i><b>9.35</b> Co-Kriging</a></li>
<li class="chapter" data-level="9.36" data-path="spatial-estimation.html"><a href="spatial-estimation.html#non-linear-kriging"><i class="fa fa-check"></i><b>9.36</b> Non-Linear Kriging</a></li>
<li class="chapter" data-level="9.37" data-path="spatial-estimation.html"><a href="spatial-estimation.html#indicator-kriging"><i class="fa fa-check"></i><b>9.37</b> Indicator Kriging</a></li>
<li class="chapter" data-level="9.38" data-path="spatial-estimation.html"><a href="spatial-estimation.html#probability-kriging"><i class="fa fa-check"></i><b>9.38</b> Probability Kriging</a></li>
<li class="chapter" data-level="9.39" data-path="spatial-estimation.html"><a href="spatial-estimation.html#disjunctive-kriging"><i class="fa fa-check"></i><b>9.39</b> Disjunctive Kriging</a></li>
<li class="chapter" data-level="9.40" data-path="spatial-estimation.html"><a href="spatial-estimation.html#spatial-regression-models"><i class="fa fa-check"></i><b>9.40</b> Spatial Regression Models</a></li>
<li class="chapter" data-level="9.41" data-path="spatial-estimation.html"><a href="spatial-estimation.html#case-study-5"><i class="fa fa-check"></i><b>9.41</b> Case Study 5</a></li>
<li class="chapter" data-level="9.42" data-path="spatial-estimation.html"><a href="spatial-estimation.html#spatial-lag-model"><i class="fa fa-check"></i><b>9.42</b> Spatial Lag Model</a></li>
<li class="chapter" data-level="9.43" data-path="spatial-estimation.html"><a href="spatial-estimation.html#steps-in-fitting-spatial-lag-model"><i class="fa fa-check"></i><b>9.43</b> Steps in Fitting Spatial Lag Model:</a></li>
<li class="chapter" data-level="9.44" data-path="spatial-estimation.html"><a href="spatial-estimation.html#spatial-error-model"><i class="fa fa-check"></i><b>9.44</b> Spatial Error Model</a></li>
<li class="chapter" data-level="9.45" data-path="spatial-estimation.html"><a href="spatial-estimation.html#steps-in-fitting-spatial-error-model"><i class="fa fa-check"></i><b>9.45</b> Steps in Fitting Spatial Error Model:</a></li>
<li class="chapter" data-level="9.46" data-path="spatial-estimation.html"><a href="spatial-estimation.html#selection-between-lag-and-error-model"><i class="fa fa-check"></i><b>9.46</b> Selection Between Lag and Error Model</a></li>
<li class="chapter" data-level="" data-path="spatial-estimation.html"><a href="spatial-estimation.html#reflection-questions-6"><i class="fa fa-check"></i>Reflection Questions</a></li>
</ul></li>
<li class="chapter" data-level="10" data-path="fundamentals-of-remote-sensing.html"><a href="fundamentals-of-remote-sensing.html"><i class="fa fa-check"></i><b>10</b> Fundamentals of Remote Sensing</a>
<ul>
<li class="chapter" data-level="" data-path="fundamentals-of-remote-sensing.html"><a href="fundamentals-of-remote-sensing.html#key-terms-9"><i class="fa fa-check"></i>Key Terms</a></li>
<li class="chapter" data-level="10.1" data-path="fundamentals-of-remote-sensing.html"><a href="fundamentals-of-remote-sensing.html#what-is-remote-sensing"><i class="fa fa-check"></i><b>10.1</b> What is Remote Sensing?</a></li>
<li class="chapter" data-level="10.2" data-path="fundamentals-of-remote-sensing.html"><a href="fundamentals-of-remote-sensing.html#measuring-energy"><i class="fa fa-check"></i><b>10.2</b> Measuring Energy</a></li>
<li class="chapter" data-level="10.3" data-path="fundamentals-of-remote-sensing.html"><a href="fundamentals-of-remote-sensing.html#electromagnetic-spectrum"><i class="fa fa-check"></i><b>10.3</b> Electromagnetic Spectrum</a></li>
<li class="chapter" data-level="10.4" data-path="fundamentals-of-remote-sensing.html"><a href="fundamentals-of-remote-sensing.html#scientific-notation"><i class="fa fa-check"></i><b>10.4</b> Scientific Notation</a></li>
<li class="chapter" data-level="10.5" data-path="fundamentals-of-remote-sensing.html"><a href="fundamentals-of-remote-sensing.html#radiation-types"><i class="fa fa-check"></i><b>10.5</b> Radiation Types</a></li>
<li class="chapter" data-level="10.6" data-path="fundamentals-of-remote-sensing.html"><a href="fundamentals-of-remote-sensing.html#factors-affecting-radiation"><i class="fa fa-check"></i><b>10.6</b> Factors Affecting Radiation</a></li>
<li class="chapter" data-level="10.7" data-path="fundamentals-of-remote-sensing.html"><a href="fundamentals-of-remote-sensing.html#radiation-basics"><i class="fa fa-check"></i><b>10.7</b> Radiation Basics</a></li>
<li class="chapter" data-level="10.8" data-path="fundamentals-of-remote-sensing.html"><a href="fundamentals-of-remote-sensing.html#foundations-of-measurement"><i class="fa fa-check"></i><b>10.8</b> Foundations of Measurement</a></li>
<li class="chapter" data-level="10.9" data-path="fundamentals-of-remote-sensing.html"><a href="fundamentals-of-remote-sensing.html#methods-of-normalization"><i class="fa fa-check"></i><b>10.9</b> Methods of Normalization</a></li>
<li class="chapter" data-level="10.10" data-path="fundamentals-of-remote-sensing.html"><a href="fundamentals-of-remote-sensing.html#the-four-resolutions"><i class="fa fa-check"></i><b>10.10</b> The Four Resolutions</a></li>
<li class="chapter" data-level="10.11" data-path="fundamentals-of-remote-sensing.html"><a href="fundamentals-of-remote-sensing.html#spatial-resolution"><i class="fa fa-check"></i><b>10.11</b> Spatial Resolution</a></li>
<li class="chapter" data-level="10.12" data-path="fundamentals-of-remote-sensing.html"><a href="fundamentals-of-remote-sensing.html#temporal-resolution"><i class="fa fa-check"></i><b>10.12</b> Temporal Resolution</a></li>
<li class="chapter" data-level="10.13" data-path="fundamentals-of-remote-sensing.html"><a href="fundamentals-of-remote-sensing.html#spectral-resolution"><i class="fa fa-check"></i><b>10.13</b> Spectral Resolution</a></li>
<li class="chapter" data-level="10.14" data-path="fundamentals-of-remote-sensing.html"><a href="fundamentals-of-remote-sensing.html#radiometric-resolution"><i class="fa fa-check"></i><b>10.14</b> Radiometric Resolution</a></li>
<li class="chapter" data-level="10.15" data-path="fundamentals-of-remote-sensing.html"><a href="fundamentals-of-remote-sensing.html#key-applications"><i class="fa fa-check"></i><b>10.15</b> Key Applications</a></li>
<li class="chapter" data-level="10.16" data-path="fundamentals-of-remote-sensing.html"><a href="fundamentals-of-remote-sensing.html#case-study-optical-remote-sensing-to-evaluate-land-cover-in-canada"><i class="fa fa-check"></i><b>10.16</b> Case Study: Optical Remote Sensing to Evaluate Land Cover in Canada</a></li>
<li class="chapter" data-level="10.17" data-path="fundamentals-of-remote-sensing.html"><a href="fundamentals-of-remote-sensing.html#summary-3"><i class="fa fa-check"></i><b>10.17</b> Summary</a></li>
<li class="chapter" data-level="10.18" data-path="fundamentals-of-remote-sensing.html"><a href="fundamentals-of-remote-sensing.html#reflection-questions-7"><i class="fa fa-check"></i><b>10.18</b> Reflection Questions</a></li>
</ul></li>
<li class="chapter" data-level="11" data-path="remote-sensing-systems.html"><a href="remote-sensing-systems.html"><i class="fa fa-check"></i><b>11</b> Remote Sensing Systems</a>
<ul>
<li class="chapter" data-level="" data-path="remote-sensing-systems.html"><a href="remote-sensing-systems.html#key-terms-10"><i class="fa fa-check"></i>Key Terms</a></li>
<li class="chapter" data-level="11.1" data-path="remote-sensing-systems.html"><a href="remote-sensing-systems.html#optical-system-basics"><i class="fa fa-check"></i><b>11.1</b> Optical System Basics</a>
<ul>
<li class="chapter" data-level="11.1.1" data-path="remote-sensing-systems.html"><a href="remote-sensing-systems.html#lenses"><i class="fa fa-check"></i><b>11.1.1</b> Lenses</a></li>
<li class="chapter" data-level="11.1.2" data-path="remote-sensing-systems.html"><a href="remote-sensing-systems.html#focal-length"><i class="fa fa-check"></i><b>11.1.2</b> Focal Length</a></li>
<li class="chapter" data-level="11.1.3" data-path="remote-sensing-systems.html"><a href="remote-sensing-systems.html#sensors"><i class="fa fa-check"></i><b>11.1.3</b> Sensors</a></li>
<li class="chapter" data-level="11.1.4" data-path="remote-sensing-systems.html"><a href="remote-sensing-systems.html#field-of-view"><i class="fa fa-check"></i><b>11.1.4</b> Field of View</a></li>
</ul></li>
<li class="chapter" data-level="11.2" data-path="remote-sensing-systems.html"><a href="remote-sensing-systems.html#perspectives"><i class="fa fa-check"></i><b>11.2</b> Perspectives</a></li>
<li class="chapter" data-level="11.3" data-path="remote-sensing-systems.html"><a href="remote-sensing-systems.html#aerial-perspective"><i class="fa fa-check"></i><b>11.3</b> Aerial Perspective</a></li>
<li class="chapter" data-level="11.4" data-path="remote-sensing-systems.html"><a href="remote-sensing-systems.html#nadir-and-zenith-perpsectives"><i class="fa fa-check"></i><b>11.4</b> Nadir and Zenith Perpsectives</a></li>
<li class="chapter" data-level="11.5" data-path="remote-sensing-systems.html"><a href="remote-sensing-systems.html#oblique-perspective"><i class="fa fa-check"></i><b>11.5</b> Oblique Perspective</a></li>
<li class="chapter" data-level="11.6" data-path="remote-sensing-systems.html"><a href="remote-sensing-systems.html#hemispherical-perspective"><i class="fa fa-check"></i><b>11.6</b> Hemispherical Perspective</a></li>
<li class="chapter" data-level="11.7" data-path="remote-sensing-systems.html"><a href="remote-sensing-systems.html#platforms"><i class="fa fa-check"></i><b>11.7</b> Platforms</a>
<ul>
<li class="chapter" data-level="11.7.1" data-path="remote-sensing-systems.html"><a href="remote-sensing-systems.html#terrestrial-systems"><i class="fa fa-check"></i><b>11.7.1</b> Terrestrial Systems</a></li>
<li class="chapter" data-level="11.7.2" data-path="remote-sensing-systems.html"><a href="remote-sensing-systems.html#aerial-systems"><i class="fa fa-check"></i><b>11.7.2</b> Aerial Systems</a></li>
<li class="chapter" data-level="11.7.3" data-path="remote-sensing-systems.html"><a href="remote-sensing-systems.html#satellite-systems"><i class="fa fa-check"></i><b>11.7.3</b> Satellite Systems</a></li>
</ul></li>
<li class="chapter" data-level="11.8" data-path="remote-sensing-systems.html"><a href="remote-sensing-systems.html#orbital-physics"><i class="fa fa-check"></i><b>11.8</b> Orbital Physics</a>
<ul>
<li class="chapter" data-level="11.8.1" data-path="remote-sensing-systems.html"><a href="remote-sensing-systems.html#low-earth-orbit-leo"><i class="fa fa-check"></i><b>11.8.1</b> Low Earth Orbit (LEO)</a></li>
<li class="chapter" data-level="11.8.2" data-path="remote-sensing-systems.html"><a href="remote-sensing-systems.html#near-polar-and-sun-synchronous-orbits"><i class="fa fa-check"></i><b>11.8.2</b> Near-Polar and Sun-synchronous Orbits</a></li>
<li class="chapter" data-level="11.8.3" data-path="remote-sensing-systems.html"><a href="remote-sensing-systems.html#medium-earth-orbit-meo"><i class="fa fa-check"></i><b>11.8.3</b> Medium Earth Orbit (MEO)</a></li>
<li class="chapter" data-level="11.8.4" data-path="remote-sensing-systems.html"><a href="remote-sensing-systems.html#geosynchronous-equitorial-orbit-geo"><i class="fa fa-check"></i><b>11.8.4</b> Geosynchronous Equitorial Orbit (GEO)</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="remote-sensing-systems.html"><a href="remote-sensing-systems.html#reflection-questions-8"><i class="fa fa-check"></i>Reflection Questions</a></li>
<li class="chapter" data-level="" data-path="remote-sensing-systems.html"><a href="remote-sensing-systems.html#practice-questions-3"><i class="fa fa-check"></i>Practice Questions</a></li>
</ul></li>
<li class="chapter" data-level="12" data-path="image-processing-and-analysis.html"><a href="image-processing-and-analysis.html"><i class="fa fa-check"></i><b>12</b> Image Processing and Analysis</a>
<ul>
<li class="chapter" data-level="" data-path="image-processing-and-analysis.html"><a href="image-processing-and-analysis.html#key-terms-11"><i class="fa fa-check"></i>Key Terms</a></li>
<li class="chapter" data-level="12.1" data-path="image-processing-and-analysis.html"><a href="image-processing-and-analysis.html#overview"><i class="fa fa-check"></i><b>12.1</b> Overview</a></li>
<li class="chapter" data-level="12.2" data-path="image-processing-and-analysis.html"><a href="image-processing-and-analysis.html#geometric-correction"><i class="fa fa-check"></i><b>12.2</b> Geometric Correction</a>
<ul>
<li class="chapter" data-level="12.2.1" data-path="image-processing-and-analysis.html"><a href="image-processing-and-analysis.html#orthoimagery"><i class="fa fa-check"></i><b>12.2.1</b> Orthoimagery</a></li>
<li class="chapter" data-level="12.2.2" data-path="image-processing-and-analysis.html"><a href="image-processing-and-analysis.html#relief-displacement"><i class="fa fa-check"></i><b>12.2.2</b> Relief Displacement</a></li>
<li class="chapter" data-level="12.2.3" data-path="image-processing-and-analysis.html"><a href="image-processing-and-analysis.html#georeferencing"><i class="fa fa-check"></i><b>12.2.3</b> Georeferencing</a></li>
<li class="chapter" data-level="12.2.4" data-path="image-processing-and-analysis.html"><a href="image-processing-and-analysis.html#georegistration-georectification"><i class="fa fa-check"></i><b>12.2.4</b> Georegistration (georectification)</a></li>
</ul></li>
<li class="chapter" data-level="12.3" data-path="image-processing-and-analysis.html"><a href="image-processing-and-analysis.html#resampling"><i class="fa fa-check"></i><b>12.3</b> Resampling</a>
<ul>
<li class="chapter" data-level="12.3.1" data-path="image-processing-and-analysis.html"><a href="image-processing-and-analysis.html#nearest-neighbor-1"><i class="fa fa-check"></i><b>12.3.1</b> Nearest Neighbor</a></li>
<li class="chapter" data-level="12.3.2" data-path="image-processing-and-analysis.html"><a href="image-processing-and-analysis.html#bilinear-interpolation"><i class="fa fa-check"></i><b>12.3.2</b> Bilinear Interpolation</a></li>
<li class="chapter" data-level="12.3.3" data-path="image-processing-and-analysis.html"><a href="image-processing-and-analysis.html#cubic-convolution"><i class="fa fa-check"></i><b>12.3.3</b> Cubic Convolution</a></li>
</ul></li>
<li class="chapter" data-level="12.4" data-path="image-processing-and-analysis.html"><a href="image-processing-and-analysis.html#atmospheric-correction"><i class="fa fa-check"></i><b>12.4</b> Atmospheric Correction</a>
<ul>
<li class="chapter" data-level="12.4.1" data-path="image-processing-and-analysis.html"><a href="image-processing-and-analysis.html#atmospheric-windows"><i class="fa fa-check"></i><b>12.4.1</b> Atmospheric Windows</a></li>
<li class="chapter" data-level="12.4.2" data-path="image-processing-and-analysis.html"><a href="image-processing-and-analysis.html#clouds-and-shadows"><i class="fa fa-check"></i><b>12.4.2</b> Clouds and Shadows</a></li>
<li class="chapter" data-level="12.4.3" data-path="image-processing-and-analysis.html"><a href="image-processing-and-analysis.html#smoke-and-haze"><i class="fa fa-check"></i><b>12.4.3</b> Smoke and Haze</a></li>
</ul></li>
<li class="chapter" data-level="12.5" data-path="image-processing-and-analysis.html"><a href="image-processing-and-analysis.html#radiometric-correction"><i class="fa fa-check"></i><b>12.5</b> Radiometric Correction</a>
<ul>
<li class="chapter" data-level="12.5.1" data-path="image-processing-and-analysis.html"><a href="image-processing-and-analysis.html#signal-to-noise"><i class="fa fa-check"></i><b>12.5.1</b> Signal-to-noise</a></li>
<li class="chapter" data-level="12.5.2" data-path="image-processing-and-analysis.html"><a href="image-processing-and-analysis.html#readout-noise"><i class="fa fa-check"></i><b>12.5.2</b> Readout Noise</a></li>
<li class="chapter" data-level="12.5.3" data-path="image-processing-and-analysis.html"><a href="image-processing-and-analysis.html#thermal-noise"><i class="fa fa-check"></i><b>12.5.3</b> Thermal Noise</a></li>
</ul></li>
<li class="chapter" data-level="12.6" data-path="image-processing-and-analysis.html"><a href="image-processing-and-analysis.html#an-overview-of-landsat-processing"><i class="fa fa-check"></i><b>12.6</b> An overview of Landsat Processing</a></li>
<li class="chapter" data-level="12.7" data-path="image-processing-and-analysis.html"><a href="image-processing-and-analysis.html#image-enhancement"><i class="fa fa-check"></i><b>12.7</b> Image Enhancement</a>
<ul>
<li class="chapter" data-level="12.7.1" data-path="image-processing-and-analysis.html"><a href="image-processing-and-analysis.html#stretching"><i class="fa fa-check"></i><b>12.7.1</b> Stretching</a></li>
<li class="chapter" data-level="12.7.2" data-path="image-processing-and-analysis.html"><a href="image-processing-and-analysis.html#smoothing"><i class="fa fa-check"></i><b>12.7.2</b> Smoothing</a></li>
</ul></li>
<li class="chapter" data-level="12.8" data-path="image-processing-and-analysis.html"><a href="image-processing-and-analysis.html#case-study-spatial-patterns-of-wildfire-in-british-columbia"><i class="fa fa-check"></i><b>12.8</b> Case Study: Spatial Patterns of Wildfire in British Columbia</a></li>
<li class="chapter" data-level="12.9" data-path="image-processing-and-analysis.html"><a href="image-processing-and-analysis.html#summary-4"><i class="fa fa-check"></i><b>12.9</b> Summary</a></li>
<li class="chapter" data-level="" data-path="image-processing-and-analysis.html"><a href="image-processing-and-analysis.html#reflection-questions-9"><i class="fa fa-check"></i>Reflection Questions</a></li>
</ul></li>
<li class="chapter" data-level="13" data-path="global-navigation-satellite-systems.html"><a href="global-navigation-satellite-systems.html"><i class="fa fa-check"></i><b>13</b> Global Navigation Satellite Systems</a>
<ul>
<li class="chapter" data-level="" data-path="global-navigation-satellite-systems.html"><a href="global-navigation-satellite-systems.html#key-terms-12"><i class="fa fa-check"></i>Key Terms</a></li>
<li class="chapter" data-level="13.1" data-path="global-navigation-satellite-systems.html"><a href="global-navigation-satellite-systems.html#how-gnss-work"><i class="fa fa-check"></i><b>13.1</b> How GNSS Work</a></li>
<li class="chapter" data-level="13.2" data-path="global-navigation-satellite-systems.html"><a href="global-navigation-satellite-systems.html#segments-of-gnss"><i class="fa fa-check"></i><b>13.2</b> Segments of GNSS</a></li>
<li class="chapter" data-level="13.3" data-path="global-navigation-satellite-systems.html"><a href="global-navigation-satellite-systems.html#sources-of-error"><i class="fa fa-check"></i><b>13.3</b> Sources of Error</a>
<ul>
<li class="chapter" data-level="13.3.1" data-path="global-navigation-satellite-systems.html"><a href="global-navigation-satellite-systems.html#clock-errors-cdt-dt"><i class="fa fa-check"></i><b>13.3.1</b> Clock Errors <span class="math inline">\(c(dt-dT)\)</span></a></li>
<li class="chapter" data-level="13.3.2" data-path="global-navigation-satellite-systems.html"><a href="global-navigation-satellite-systems.html#ionospheric-delays-i_f"><i class="fa fa-check"></i><b>13.3.2</b> Ionospheric Delays <span class="math inline">\(I_f\)</span></a></li>
<li class="chapter" data-level="13.3.3" data-path="global-navigation-satellite-systems.html"><a href="global-navigation-satellite-systems.html#tropospheric-delays-t"><i class="fa fa-check"></i><b>13.3.3</b> Tropospheric Delays <span class="math inline">\(T\)</span></a></li>
<li class="chapter" data-level="13.3.4" data-path="global-navigation-satellite-systems.html"><a href="global-navigation-satellite-systems.html#multipath-errors-m"><i class="fa fa-check"></i><b>13.3.4</b> Multipath Errors <span class="math inline">\(M\)</span></a></li>
<li class="chapter" data-level="13.3.5" data-path="global-navigation-satellite-systems.html"><a href="global-navigation-satellite-systems.html#ephemeris-errors-e"><i class="fa fa-check"></i><b>13.3.5</b> Ephemeris Errors <span class="math inline">\(E\)</span></a></li>
<li class="chapter" data-level="13.3.6" data-path="global-navigation-satellite-systems.html"><a href="global-navigation-satellite-systems.html#instrument-noise-ε_s-and-ε_r"><i class="fa fa-check"></i><b>13.3.6</b> Instrument Noise <span class="math inline">\(ε_S\)</span> and <span class="math inline">\(ε_R\)</span></a></li>
<li class="chapter" data-level="13.3.7" data-path="global-navigation-satellite-systems.html"><a href="global-navigation-satellite-systems.html#dilution-of-precision"><i class="fa fa-check"></i><b>13.3.7</b> Dilution of Precision</a></li>
</ul></li>
<li class="chapter" data-level="13.4" data-path="global-navigation-satellite-systems.html"><a href="global-navigation-satellite-systems.html#planning-your-gnss-data-collection"><i class="fa fa-check"></i><b>13.4</b> Planning Your GNSS Data Collection</a></li>
<li class="chapter" data-level="" data-path="global-navigation-satellite-systems.html"><a href="global-navigation-satellite-systems.html#reflection-questions-10"><i class="fa fa-check"></i>Reflection Questions</a></li>
<li class="chapter" data-level="" data-path="global-navigation-satellite-systems.html"><a href="global-navigation-satellite-systems.html#practice-questions-4"><i class="fa fa-check"></i>Practice Questions</a></li>
</ul></li>
<li class="chapter" data-level="14" data-path="LiDAR-acquisition-and-analysis.html"><a href="LiDAR-acquisition-and-analysis.html"><i class="fa fa-check"></i><b>14</b> LiDAR Acquisition and Analysis</a>
<ul>
<li class="chapter" data-level="" data-path="LiDAR-acquisition-and-analysis.html"><a href="LiDAR-acquisition-and-analysis.html#key-terms-13"><i class="fa fa-check"></i>Key Terms</a></li>
<li class="chapter" data-level="14.1" data-path="LiDAR-acquisition-and-analysis.html"><a href="LiDAR-acquisition-and-analysis.html#what-is-lidar"><i class="fa fa-check"></i><b>14.1</b> What is LiDAR?</a></li>
<li class="chapter" data-level="14.2" data-path="LiDAR-acquisition-and-analysis.html"><a href="LiDAR-acquisition-and-analysis.html#how-does-lidar-work"><i class="fa fa-check"></i><b>14.2</b> How Does LiDAR Work?</a></li>
<li class="chapter" data-level="14.3" data-path="LiDAR-acquisition-and-analysis.html"><a href="LiDAR-acquisition-and-analysis.html#lidar-history-and-use"><i class="fa fa-check"></i><b>14.3</b> LiDAR History and Use</a></li>
<li class="chapter" data-level="14.4" data-path="LiDAR-acquisition-and-analysis.html"><a href="LiDAR-acquisition-and-analysis.html#components-of-a-lidar-system"><i class="fa fa-check"></i><b>14.4</b> Components of a LiDAR System</a>
<ul>
<li class="chapter" data-level="14.4.1" data-path="LiDAR-acquisition-and-analysis.html"><a href="LiDAR-acquisition-and-analysis.html#lasers"><i class="fa fa-check"></i><b>14.4.1</b> Lasers</a></li>
<li class="chapter" data-level="14.4.2" data-path="LiDAR-acquisition-and-analysis.html"><a href="LiDAR-acquisition-and-analysis.html#global-navigation-satellite-systems-1"><i class="fa fa-check"></i><b>14.4.2</b> Global Navigation Satellite Systems</a></li>
<li class="chapter" data-level="14.4.3" data-path="LiDAR-acquisition-and-analysis.html"><a href="LiDAR-acquisition-and-analysis.html#inertial-measurement-unit-imu"><i class="fa fa-check"></i><b>14.4.3</b> Inertial Measurement Unit (IMU)</a></li>
<li class="chapter" data-level="14.4.4" data-path="LiDAR-acquisition-and-analysis.html"><a href="LiDAR-acquisition-and-analysis.html#clocks"><i class="fa fa-check"></i><b>14.4.4</b> Clocks</a></li>
</ul></li>
<li class="chapter" data-level="14.5" data-path="LiDAR-acquisition-and-analysis.html"><a href="LiDAR-acquisition-and-analysis.html#platform"><i class="fa fa-check"></i><b>14.5</b> Platform</a>
<ul>
<li class="chapter" data-level="14.5.1" data-path="LiDAR-acquisition-and-analysis.html"><a href="LiDAR-acquisition-and-analysis.html#airplanes-and-helicopters"><i class="fa fa-check"></i><b>14.5.1</b> Airplanes and Helicopters</a></li>
<li class="chapter" data-level="14.5.2" data-path="LiDAR-acquisition-and-analysis.html"><a href="LiDAR-acquisition-and-analysis.html#drones"><i class="fa fa-check"></i><b>14.5.2</b> Drones</a></li>
<li class="chapter" data-level="14.5.3" data-path="LiDAR-acquisition-and-analysis.html"><a href="LiDAR-acquisition-and-analysis.html#mobile-laser-scanning"><i class="fa fa-check"></i><b>14.5.3</b> Mobile Laser Scanning</a></li>
<li class="chapter" data-level="14.5.4" data-path="LiDAR-acquisition-and-analysis.html"><a href="LiDAR-acquisition-and-analysis.html#terrestrial-laser-scanning"><i class="fa fa-check"></i><b>14.5.4</b> Terrestrial Laser Scanning</a></li>
<li class="chapter" data-level="14.5.5" data-path="LiDAR-acquisition-and-analysis.html"><a href="LiDAR-acquisition-and-analysis.html#satellites"><i class="fa fa-check"></i><b>14.5.5</b> Satellites</a></li>
<li class="chapter" data-level="14.5.6" data-path="LiDAR-acquisition-and-analysis.html"><a href="LiDAR-acquisition-and-analysis.html#discrete-return"><i class="fa fa-check"></i><b>14.5.6</b> Discrete Return</a></li>
<li class="chapter" data-level="14.5.7" data-path="LiDAR-acquisition-and-analysis.html"><a href="LiDAR-acquisition-and-analysis.html#full-waveform"><i class="fa fa-check"></i><b>14.5.7</b> Full Waveform</a></li>
<li class="chapter" data-level="" data-path="LiDAR-acquisition-and-analysis.html"><a href="LiDAR-acquisition-and-analysis.html#your-turn-5"><i class="fa fa-check"></i>Your Turn!</a></li>
</ul></li>
<li class="chapter" data-level="14.6" data-path="LiDAR-acquisition-and-analysis.html"><a href="LiDAR-acquisition-and-analysis.html#emerging-technology"><i class="fa fa-check"></i><b>14.6</b> Emerging Technology</a></li>
<li class="chapter" data-level="14.7" data-path="LiDAR-acquisition-and-analysis.html"><a href="LiDAR-acquisition-and-analysis.html#lidar-derivatives-and-analysis"><i class="fa fa-check"></i><b>14.7</b> LiDAR Derivatives and Analysis</a></li>
<li class="chapter" data-level="14.8" data-path="LiDAR-acquisition-and-analysis.html"><a href="LiDAR-acquisition-and-analysis.html#bare-earth-elevation"><i class="fa fa-check"></i><b>14.8</b> Bare Earth Elevation</a></li>
<li class="chapter" data-level="14.9" data-path="LiDAR-acquisition-and-analysis.html"><a href="LiDAR-acquisition-and-analysis.html#digital-surface-model-and-canopy-height-models"><i class="fa fa-check"></i><b>14.9</b> Digital Surface Model and Canopy Height Models</a></li>
<li class="chapter" data-level="14.10" data-path="LiDAR-acquisition-and-analysis.html"><a href="LiDAR-acquisition-and-analysis.html#area-based-approach-vs.-individual-tree-crown-approach"><i class="fa fa-check"></i><b>14.10</b> Area Based Approach vs. Individual Tree Crown Approach</a></li>
<li class="chapter" data-level="14.11" data-path="LiDAR-acquisition-and-analysis.html"><a href="LiDAR-acquisition-and-analysis.html#tree-segmentation"><i class="fa fa-check"></i><b>14.11</b> Tree Segmentation</a></li>
<li class="chapter" data-level="14.12" data-path="LiDAR-acquisition-and-analysis.html"><a href="LiDAR-acquisition-and-analysis.html#sources-of-error-1"><i class="fa fa-check"></i><b>14.12</b> Sources of Error</a></li>
<li class="chapter" data-level="14.13" data-path="LiDAR-acquisition-and-analysis.html"><a href="LiDAR-acquisition-and-analysis.html#software-and-analysis-tools"><i class="fa fa-check"></i><b>14.13</b> Software and Analysis Tools</a></li>
<li class="chapter" data-level="14.14" data-path="LiDAR-acquisition-and-analysis.html"><a href="LiDAR-acquisition-and-analysis.html#case-study-creating-lidar-metrics-from-a-raw-point-cloud"><i class="fa fa-check"></i><b>14.14</b> Case Study: Creating LiDAR Metrics from a Raw Point Cloud</a>
<ul>
<li class="chapter" data-level="" data-path="LiDAR-acquisition-and-analysis.html"><a href="LiDAR-acquisition-and-analysis.html#your-turn-6"><i class="fa fa-check"></i>Your Turn!</a></li>
</ul></li>
<li class="chapter" data-level="14.15" data-path="LiDAR-acquisition-and-analysis.html"><a href="LiDAR-acquisition-and-analysis.html#summary-5"><i class="fa fa-check"></i><b>14.15</b> Summary</a></li>
<li class="chapter" data-level="" data-path="LiDAR-acquisition-and-analysis.html"><a href="LiDAR-acquisition-and-analysis.html#reflection-questions-11"><i class="fa fa-check"></i>Reflection Questions</a></li>
<li class="chapter" data-level="" data-path="LiDAR-acquisition-and-analysis.html"><a href="LiDAR-acquisition-and-analysis.html#practice-questions-5"><i class="fa fa-check"></i>Practice Questions</a></li>
<li class="chapter" data-level="" data-path="LiDAR-acquisition-and-analysis.html"><a href="LiDAR-acquisition-and-analysis.html#recommended-readings-1"><i class="fa fa-check"></i>Recommended Readings</a></li>
<li class="chapter" data-level="14.16" data-path="LiDAR-acquisition-and-analysis.html"><a href="LiDAR-acquisition-and-analysis.html#problems-with-data-integration"><i class="fa fa-check"></i><b>14.16</b> Problems with Data Integration</a></li>
<li class="chapter" data-level="14.17" data-path="LiDAR-acquisition-and-analysis.html"><a href="LiDAR-acquisition-and-analysis.html#framing-the-problem"><i class="fa fa-check"></i><b>14.17</b> Framing The Problem</a></li>
<li class="chapter" data-level="14.18" data-path="LiDAR-acquisition-and-analysis.html"><a href="LiDAR-acquisition-and-analysis.html#about-the-data"><i class="fa fa-check"></i><b>14.18</b> About The Data</a></li>
<li class="chapter" data-level="14.19" data-path="LiDAR-acquisition-and-analysis.html"><a href="LiDAR-acquisition-and-analysis.html#data-resolution"><i class="fa fa-check"></i><b>14.19</b> Data Resolution</a></li>
<li class="chapter" data-level="14.20" data-path="LiDAR-acquisition-and-analysis.html"><a href="LiDAR-acquisition-and-analysis.html#integrating-vector-and-raster-data"><i class="fa fa-check"></i><b>14.20</b> Integrating Vector and Raster Data</a></li>
<li class="chapter" data-level="14.21" data-path="LiDAR-acquisition-and-analysis.html"><a href="LiDAR-acquisition-and-analysis.html#rasterization"><i class="fa fa-check"></i><b>14.21</b> Rasterization</a></li>
<li class="chapter" data-level="14.22" data-path="LiDAR-acquisition-and-analysis.html"><a href="LiDAR-acquisition-and-analysis.html#vectorization"><i class="fa fa-check"></i><b>14.22</b> Vectorization</a></li>
<li class="chapter" data-level="14.23" data-path="LiDAR-acquisition-and-analysis.html"><a href="LiDAR-acquisition-and-analysis.html#zonal-statistics"><i class="fa fa-check"></i><b>14.23</b> Zonal Statistics</a></li>
<li class="chapter" data-level="14.24" data-path="LiDAR-acquisition-and-analysis.html"><a href="LiDAR-acquisition-and-analysis.html#smoothing-1"><i class="fa fa-check"></i><b>14.24</b> Smoothing</a></li>
<li class="chapter" data-level="14.25" data-path="LiDAR-acquisition-and-analysis.html"><a href="LiDAR-acquisition-and-analysis.html#simplifying"><i class="fa fa-check"></i><b>14.25</b> Simplifying</a></li>
<li class="chapter" data-level="14.26" data-path="LiDAR-acquisition-and-analysis.html"><a href="LiDAR-acquisition-and-analysis.html#spatial-data-errors"><i class="fa fa-check"></i><b>14.26</b> Spatial Data Errors</a></li>
<li class="chapter" data-level="14.27" data-path="LiDAR-acquisition-and-analysis.html"><a href="LiDAR-acquisition-and-analysis.html#accuracy-vs.-precision"><i class="fa fa-check"></i><b>14.27</b> Accuracy vs. Precision</a></li>
<li class="chapter" data-level="14.28" data-path="LiDAR-acquisition-and-analysis.html"><a href="LiDAR-acquisition-and-analysis.html#quantifying-spatial-errors-rmse-euclids-distance"><i class="fa fa-check"></i><b>14.28</b> Quantifying Spatial Errors RMSE, Euclid’s Distance</a></li>
<li class="chapter" data-level="14.29" data-path="LiDAR-acquisition-and-analysis.html"><a href="LiDAR-acquisition-and-analysis.html#logical-errors"><i class="fa fa-check"></i><b>14.29</b> Logical Errors</a></li>
<li class="chapter" data-level="14.30" data-path="LiDAR-acquisition-and-analysis.html"><a href="LiDAR-acquisition-and-analysis.html#ecological-fallacy-atomistic-fallacy-maup-etc.-its-important-to-include-these-whether-here-or-elsewhere"><i class="fa fa-check"></i><b>14.30</b> Ecological Fallacy, Atomistic Fallacy, MAUP etc. Its important to include these, whether here or elsewhere?</a></li>
<li class="chapter" data-level="14.31" data-path="LiDAR-acquisition-and-analysis.html"><a href="LiDAR-acquisition-and-analysis.html#other-errors"><i class="fa fa-check"></i><b>14.31</b> Other Errors?</a></li>
<li class="chapter" data-level="14.32" data-path="LiDAR-acquisition-and-analysis.html"><a href="LiDAR-acquisition-and-analysis.html#case-study-title-of-case-study-here"><i class="fa fa-check"></i><b>14.32</b> Case Study: Title of Case Study here</a>
<ul>
<li class="chapter" data-level="14.32.1" data-path="LiDAR-acquisition-and-analysis.html"><a href="LiDAR-acquisition-and-analysis.html#large-scale"><i class="fa fa-check"></i><b>14.32.1</b> Large Scale</a></li>
</ul></li>
</ul></li>
<li class="divider"></li>
<li><a href="https://github.com/ubc-geomatics-textbook/geomatics-textbook/issues/new/choose" target="blank">Suggest an edit or report a bug</a></li>

</ul>

      </nav>
    </div>

    <div class="book-body">
      <div class="body-inner">
        <div class="book-header" role="navigation">
          <h1>
            <i class="fa fa-circle-o-notch fa-spin"></i><a href="./">Geomatics for Environmental Management: An Open Textbook for Students and Practitioners</a>
          </h1>
        </div>

        <div class="page-wrapper" tabindex="-1" role="main">
          <div class="page-inner">

            <section class="normal" id="section-">
<div id="spatial-estimation" class="section level1 hasAnchor" number="9">
<h1><span class="header-section-number">Chapter 9</span> Spatial Estimation<a href="spatial-estimation.html#spatial-estimation" class="anchor-section" aria-label="Anchor link to header"></a></h1>
<p>Written by
Sushil Nepal and Paul Pickell</p>
<p><strong>Geostatistics</strong> uses the metrics based on statistical tools to characterize the distribution of a random variable across a geographical region of interest <span class="citation">(<a href="#ref-getis_spatial_2004">Getis et al. 2004</a>)</span>. Like any other data, spatial data may be incomplete, which can limit our analytical capacity in the incomplete regions. In context of spatial data, we wish to understand spatial phenomena like events or processes that occur over large areas, but usually we are limited in our capacity to sample everywhere. Most of the time, only discrete and unrepresentative information on the spatial phenomenon is collected, which does not allow us to create a precise and continuous map of the phenomenon over entire geographic area of interest. How can we best utilize the available samples to represent the phenomenon across the entire geographic area? This chapter introduces some basic ideas on different types of sampling strategies in spatial context. In addition, this chapter also introduces various type of spatial statistics that are available to predict the occurrence of spatial phenomena in unsampled locations.</p>
<div class="box-content learning-objectives-content">
<div id="learning-objectives-8" class="section level2 unnumbered hasAnchor box-title learning-objectives-top">
<h2>Learning Objectives<a href="spatial-estimation.html#learning-objectives-8" class="anchor-section" aria-label="Anchor link to header"></a></h2>
</div>
<ol style="list-style-type: decimal">
<li>Differentiate the advantages of spatial sampling strategies</li>
<li>Describe the relationship between observations at different spatial scales using autocorrelation and semivariogram</li>
<li>Apply methods of spatial interpolation to predict observations at unknown locations</li>
<li>Apply methods of spatial prediction using regression models</li>
</ol>
</div>
<div id="key-terms-8" class="section level2 unnumbered hasAnchor">
<h2>Key Terms<a href="spatial-estimation.html#key-terms-8" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>Spatial autocorrelation,</p>
</div>
<div id="spatial-autocorrelation" class="section level2 hasAnchor" number="9.1">
<h2><span class="header-section-number">9.1</span> Spatial Autocorrelation<a href="spatial-estimation.html#spatial-autocorrelation" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>A key characteristic that distinguishes spatial data from other types of data is the fact that spatial phenomena are frequently spatially autocorrelated. <strong>Spatial autocorrelation</strong> is the relationship between a variable of interest with itself when measured at different locations <span class="citation">(<a href="#ref-cliff_ad_and_ord_spatial_1973">Cliff 1973</a>)</span>. Any two samples are more likely to be correlated or similar to each other when the samples are closer in space compared with two samples that are taken at farther distances. For example, if we measured air temperature at our current location and then walked 1 m away and measured it again, then walked 10 km and measured it again, we would expect that the temperatures sampled 1 m apart would be more similar than the temperatures measured 10 km apart. The precise degree and sign (positive or negative) of spatial autocorrelation will vary from phenomenon to phenomenon because some phenomena change more quickly over space than others. As far as we can tell, all spatial phenomenon exhibit spatial autocorrelation at some, but not all distances. In other words, we have never observed a natural spatial phenomenon that is truly random. Spatial autocorrelation provides a tremendous advantage for estimating statistics and characteristics of populations in space, but also introduces several important caveats.</p>
<p>Consider the following example; <strong>Figure <a href="spatial-estimation.html#fig:10-cluster-sampling">9.14</a></strong> shows the clustering pattern in the given square boxes (can be variable of interest) representing the positive spatial autocorrelation (left) and a complete checkerboard (right) distribution of square boxes (variable of interest) indicating a negative spatial autocorrelation.</p>
</div>
<div class="box-content call-out-content">
<div id="recall-this" class="section level2 unnumbered hasAnchor box-title call-out-top">
<h2>Recall This<a href="spatial-estimation.html#recall-this" class="anchor-section" aria-label="Anchor link to header"></a></h2>
</div>
<p id="box-text">
<div id="domain" class="section level2 hasAnchor" number="9.2">
<h2><span class="header-section-number">9.2</span> Domain<a href="spatial-estimation.html#domain" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>The study area from where spatial sample is taken.</p>
</div>
<div id="attributes" class="section level2 hasAnchor" number="9.3">
<h2><span class="header-section-number">9.3</span> Attributes<a href="spatial-estimation.html#attributes" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>The information attached to the study objects that are spatially distributed in a Domain. Often termed as variable of interest.</p>
</p>
</div>
</div>
<div class="figure"><span style="display:block;" id="fig:10-spatial-autocorrelation"></span>
<img src="geomatics-for-environmental-management-_files/figure-html/10-spatial-autocorrelation-1.png" alt="Example of a positive (left) and negative spatial autocorrelation (right) for a give domain. Nepal, CC-BY-SA-4.0." width="672" />
<p class="caption">
Figure 9.1: Example of a positive (left) and negative spatial autocorrelation (right) for a give domain. Nepal, CC-BY-SA-4.0.
</p>
</div>
<p>Example of a positive (left) and negative spatial autocorrelation (right) for a give domain.</p>
<div id="morans-i" class="section level2 hasAnchor" number="9.4">
<h2><span class="header-section-number">9.4</span> Moran’s I<a href="spatial-estimation.html#morans-i" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p><strong>Moran’s I</strong> <span class="citation">(<a href="#ref-moran_notes_1950">Moran 1950</a>)</span>, is a correlation coefficient that measures the degree of spatial autocorrelation in certain attributes of the data. It is based on the spatial covariance standardized by the variance of the data <span class="citation">(<a href="#ref-moran_notes_1950">Moran 1950</a>)</span>. It works based on the neighborhood list created based on spatial weight matrix <span class="citation">(<a href="#ref-suryowati_comparison_2018">Suryowati, Bekti, and Faradila 2018</a>)</span>. The value of Moran’s I ranges between -1 to 1, where 1 indicates the perfect positive spatial autocorrelation, 0 indicates the random pattern, and -1 indicates the perfect negative autocorrelation <span class="citation">(<a href="#ref-moran_notes_1950">Moran 1950</a>)</span>. Moran’s I is calculated using the following formula <span class="citation">(<a href="#ref-moran_notes_1950">Moran 1950</a>)</span>:</p>
<p><span class="math display">\[
I= \frac{1}{s^2} \frac{\sum_{i}\sum_{j}({y_i-\bar{y})({y_j-\bar{y}})}}
{\sum_{i}\sum_{j}w_{ij}}
\]</span>
Where, <span class="math display">\[I=\text{the Moran I statistics}\]</span>, <span class="math display">\[y_i=\text{variable measure at location i}\]</span>
<span class="math display">\[y_j=\text{variable measure at location j}\]</span></p>
<p><span class="math display">\[S^2=\text{the variance}\]</span>
<span class="math display">\[w_{ij}=\text{the spatial weight matrix}\]</span></p>
</div>
<div id="case-study-1" class="section level2 hasAnchor" number="9.5">
<h2><span class="header-section-number">9.5</span> Case Study 1<a href="spatial-estimation.html#case-study-1" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>For this case study, we will use ground plot data from Change Monitoring Inventory (CMI) program <span class="citation">(for details: <a href="#ref-province_of_bc_provincial_2018">Province of BC 2018</a>)</span> for Williams Lake and 100-miles House timber supply area (TSA) in the province of British Columbia, Canada. William Lake TSA and 100-miles House TSA are divided into 18 and 8 blocks respectively <strong>Figure <a href="spatial-estimation.html#fig:10-spatial-autocorrelation">9.1</a></strong>. There is a total of 456 CMI plots used in this study <strong>Figure <a href="spatial-estimation.html#fig:10-spatial-autocorrelation">9.1</a></strong>. The total basal area (m2/ha) is our variable of interest in this study. For each of the polygon in Williams lake and 100-miles house TSA, total basal area was calculated by taking the sum of the basal area of each CMI plots in each polygon. For this part of exercise, we want to understand if there is any spatial relationship (autocorrelation) between the total basal area measured in each polygon of TSA. We will quantitatively measure the presence or absence of <strong>spatial autocorrelation</strong> using <strong>Moran’s I</strong> and <strong>Geary’s C</strong>.</p>
<pre><code>## OGR data source with driver: ESRI Shapefile 
## Source: &quot;C:\Users\paul\Documents\geomatics-textbook\geomatics-textbook\data\10&quot;, layer: &quot;Block_basa_area&quot;
## with 26 features
## It has 21 fields
## Integer64 fields read as strings:  Field1</code></pre>
<pre><code>## OGR data source with driver: ESRI Shapefile 
## Source: &quot;C:\Users\paul\Documents\geomatics-textbook\geomatics-textbook\data\10&quot;, layer: &quot;100_and_will&quot;
## with 2 features
## It has 16 fields</code></pre>
<div class="figure"><span style="display:block;" id="fig:10-morans-I"></span>
<img src="geomatics-for-environmental-management-_files/figure-html/10-morans-I-1.png" alt="CMI plots location for williams lake TSA and 100 miles house TSA. Basal area has been calculated using the sum of the basal area for each plot (dot) over the given polygon. Nepal, CC-BY-SA-4.0." width="672" />
<p class="caption">
Figure 9.2: CMI plots location for williams lake TSA and 100 miles house TSA. Basal area has been calculated using the sum of the basal area for each plot (dot) over the given polygon. Nepal, CC-BY-SA-4.0.
</p>
</div>
<p>CMI plots location for williams lake TSA and 100 miles house TSA. Basal area has been calculated using the sum of the basal area for each plot (dot) over the given polygon.
:::</p>
</div>
<div id="calculating-morans-i" class="section level2 unnumbered hasAnchor">
<h2>Calculating Moran’s I<a href="spatial-estimation.html#calculating-morans-i" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>We will calculate the Moran’s I for the basal area variable pertaining to the polygon.</p>
</div>
<div id="using-contiguity" class="section level2 unnumbered hasAnchor">
<h2>Using Contiguity<a href="spatial-estimation.html#using-contiguity" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p><strong>Define Neighborhood</strong></p>
<p>The Moran’s I statistic is the correlation coefficient for the relationship between a variable and its surrounding values. But before we go about computing this correlation, we need to come up with a way to define a neighborhood. There are two ways to define neighborhood namely; contiguity for spatial <strong>polygon data</strong> and distance-based approach for the spatial <strong>point data</strong> and polygon data both. For polygon data, contiguity based neighborhood selection can be adopted using two widely used method, respectively known as <strong><em>Rook’s case</em></strong> or <strong><em>Queen’s case</em></strong> <strong>Figure <a href="spatial-estimation.html#fig:10-morans-I">9.2</a></strong>.</p>
<div class="figure"><span style="display:block;" id="fig:10-using-contiguity"></span>
<img src="geomatics-for-environmental-management-_files/figure-html/10-using-contiguity-1.png" alt="Rook's (left) and Queen's (right) case for searching the neighborhood (grey unit) for the darker unit in the center. Nepal, CC-BY-SA-4.0." width="672" />
<p class="caption">
Figure 9.3: Rook’s (left) and Queen’s (right) case for searching the neighborhood (grey unit) for the darker unit in the center. Nepal, CC-BY-SA-4.0.
</p>
</div>
<p>Rook’s (left) and Queen’s (right) case for searching the neighborhood (grey unit) for the darker unit in the center.</p>
<p><strong>Step 1: Build Neighborhood</strong></p>
<p>Since we are working with the polygons, we will use the queen’s contiguity to build the neighborhood list using <strong>polyn2b</strong> function in <strong>spdep</strong> package in R and plot the the linkage**</p>
<div class="sourceCode" id="cb6"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb6-1"><a href="spatial-estimation.html#cb6-1" tabindex="-1"></a><span class="do">####################### Plot the data #######################</span></span>
<span id="cb6-2"><a href="spatial-estimation.html#cb6-2" tabindex="-1"></a><span class="do">### Convert the spatial data into data frame ##########</span></span>
<span id="cb6-3"><a href="spatial-estimation.html#cb6-3" tabindex="-1"></a></span>
<span id="cb6-4"><a href="spatial-estimation.html#cb6-4" tabindex="-1"></a>filename_df <span class="ot">&lt;-</span> <span class="fu">tidy</span>(filename)</span>
<span id="cb6-5"><a href="spatial-estimation.html#cb6-5" tabindex="-1"></a><span class="co"># make sure the shapefile attribute table has an id column</span></span>
<span id="cb6-6"><a href="spatial-estimation.html#cb6-6" tabindex="-1"></a>filename<span class="sc">$</span>id <span class="ot">&lt;-</span> <span class="fu">rownames</span>(filename<span class="sc">@</span>data)</span>
<span id="cb6-7"><a href="spatial-estimation.html#cb6-7" tabindex="-1"></a></span>
<span id="cb6-8"><a href="spatial-estimation.html#cb6-8" tabindex="-1"></a><span class="co"># join the attribute table from the spatial object to the new data frame</span></span>
<span id="cb6-9"><a href="spatial-estimation.html#cb6-9" tabindex="-1"></a>filename_df <span class="ot">&lt;-</span> <span class="fu">left_join</span>(filename_df,</span>
<span id="cb6-10"><a href="spatial-estimation.html#cb6-10" tabindex="-1"></a>                         filename<span class="sc">@</span>data,</span>
<span id="cb6-11"><a href="spatial-estimation.html#cb6-11" tabindex="-1"></a>                         <span class="at">by =</span> <span class="st">&quot;id&quot;</span>)</span>
<span id="cb6-12"><a href="spatial-estimation.html#cb6-12" tabindex="-1"></a></span>
<span id="cb6-13"><a href="spatial-estimation.html#cb6-13" tabindex="-1"></a><span class="co">#Searching neighborhood</span></span>
<span id="cb6-14"><a href="spatial-estimation.html#cb6-14" tabindex="-1"></a>w1 <span class="ot">&lt;-</span> <span class="fu">poly2nb</span>(filename,<span class="at">row.names=</span>filename<span class="sc">$</span>id,<span class="at">queen=</span>T) <span class="do">###### queens case</span></span>
<span id="cb6-15"><a href="spatial-estimation.html#cb6-15" tabindex="-1"></a>coords <span class="ot">&lt;-</span> <span class="fu">coordinates</span>(filename)</span>
<span id="cb6-16"><a href="spatial-estimation.html#cb6-16" tabindex="-1"></a><span class="fu">plot</span>(w1, coords, <span class="at">col=</span><span class="st">&quot;grey&quot;</span>)</span></code></pre></div>
<p><img src="geomatics-for-environmental-management-_files/figure-html/10-using-contiguity-2-1.png" width="672" /></p>
<p><strong>Step 2: Getting a Spatial Weight Matrix for Neighborhood List</strong></p>
<div class="sourceCode" id="cb7"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb7-1"><a href="spatial-estimation.html#cb7-1" tabindex="-1"></a>ww <span class="ot">&lt;-</span> <span class="fu">nb2listw</span>(w1,<span class="at">style=</span><span class="st">&#39;B&#39;</span>)</span></code></pre></div>
<p><strong>Step 3: Calculate Moran’s Correlation Coefficient Using the Spatial Weight Matrix for Neighbors</strong></p>
<div class="sourceCode" id="cb8"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb8-1"><a href="spatial-estimation.html#cb8-1" tabindex="-1"></a><span class="do">## calculating Moran&#39;s I </span></span>
<span id="cb8-2"><a href="spatial-estimation.html#cb8-2" tabindex="-1"></a><span class="fu">moran</span>(filename<span class="sc">$</span>Basal, ww, <span class="at">n=</span><span class="fu">length</span>(ww<span class="sc">$</span>neighbours), <span class="at">S0=</span><span class="fu">Szero</span>(ww))</span></code></pre></div>
<pre><code>## $I
## [1] -0.1112932
## 
## $K
## [1] 4.854083</code></pre>
<p><strong>Step 4: Conduct the Significance Test for the Calculated Moran’s I Value</strong></p>
<div class="sourceCode" id="cb10"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb10-1"><a href="spatial-estimation.html#cb10-1" tabindex="-1"></a><span class="fu">moran.test</span>(filename<span class="sc">$</span>Basal, ww)</span></code></pre></div>
<pre><code>## 
##  Moran I test under randomisation
## 
## data:  filename$Basal  
## weights: ww    
## 
## Moran I statistic standard deviate = -0.55645, p-value = 0.711
## alternative hypothesis: greater
## sample estimates:
## Moran I statistic       Expectation          Variance 
##       -0.11129321       -0.04000000        0.01641516</code></pre>
<p><strong>Using the K-Nearest Neighborhood Imputation</strong></p>
<p><strong>Step 1: We will select 3 Nearest Neighbor Using Distance-based Approach</strong></p>
<p>The function knearneigh in ’spdep” package in R and build a spatial weight</p>
<div class="sourceCode" id="cb12"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb12-1"><a href="spatial-estimation.html#cb12-1" tabindex="-1"></a><span class="co"># Searching neighborhood</span></span>
<span id="cb12-2"><a href="spatial-estimation.html#cb12-2" tabindex="-1"></a>col.knn <span class="ot">&lt;-</span> <span class="fu">knearneigh</span>(coords, <span class="at">k=</span><span class="dv">3</span>)</span>
<span id="cb12-3"><a href="spatial-estimation.html#cb12-3" tabindex="-1"></a>w<span class="ot">&lt;-</span><span class="fu">knn2nb</span>(col.knn,<span class="at">row.names =</span> filename<span class="sc">$</span>id)</span>
<span id="cb12-4"><a href="spatial-estimation.html#cb12-4" tabindex="-1"></a></span>
<span id="cb12-5"><a href="spatial-estimation.html#cb12-5" tabindex="-1"></a>coords <span class="ot">&lt;-</span> <span class="fu">coordinates</span>(filename)</span>
<span id="cb12-6"><a href="spatial-estimation.html#cb12-6" tabindex="-1"></a><span class="fu">plot</span>(w, coords, <span class="at">col=</span><span class="st">&quot;grey&quot;</span>)</span></code></pre></div>
<p><img src="geomatics-for-environmental-management-_files/figure-html/10-using-contiguity-6-1.png" width="672" />
<strong>Step 2: Build a Spatial Weight Matrix for the Neighborhood List</strong></p>
<div class="sourceCode" id="cb13"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb13-1"><a href="spatial-estimation.html#cb13-1" tabindex="-1"></a><span class="co">#spatial weight </span></span>
<span id="cb13-2"><a href="spatial-estimation.html#cb13-2" tabindex="-1"></a>ww1 <span class="ot">&lt;-</span> <span class="fu">nb2listw</span>(w,<span class="at">style=</span><span class="st">&#39;B&#39;</span>)</span>
<span id="cb13-3"><a href="spatial-estimation.html#cb13-3" tabindex="-1"></a><span class="co">#ww1</span></span></code></pre></div>
<p><strong>Step 3: Calculate the Moran’s I Coefficient</strong></p>
<div class="sourceCode" id="cb14"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb14-1"><a href="spatial-estimation.html#cb14-1" tabindex="-1"></a><span class="do">## Calculating Moran&#39;s I </span></span>
<span id="cb14-2"><a href="spatial-estimation.html#cb14-2" tabindex="-1"></a><span class="fu">moran</span>(filename<span class="sc">$</span>Basal, ww1, <span class="at">n=</span><span class="fu">length</span>(ww1<span class="sc">$</span>neighbours), <span class="at">S0=</span><span class="fu">Szero</span>(ww1))</span></code></pre></div>
<pre><code>## $I
## [1] 0.01767042
## 
## $K
## [1] 4.854083</code></pre>
<p><strong>Step 4: Significance Test for Calculated Moran’s I</strong></p>
<div class="sourceCode" id="cb16"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb16-1"><a href="spatial-estimation.html#cb16-1" tabindex="-1"></a><span class="fu">moran.test</span>(filename<span class="sc">$</span>Basal, ww1)</span></code></pre></div>
<pre><code>## 
##  Moran I test under randomisation
## 
## data:  filename$Basal  
## weights: ww1    
## 
## Moran I statistic standard deviate = 0.43976, p-value = 0.3301
## alternative hypothesis: greater
## sample estimates:
## Moran I statistic       Expectation          Variance 
##        0.01767042       -0.04000000        0.01719815</code></pre>
<p>Note that the value of Moran’s I changed based on how we calculated the neighborhood list using two different approach. The interpretation change here based on the way we created the neighborhood. With contiguity based neighbor, we found a negative value for I (-0.11), indicating a negative weak spatial autocorrelation. When we run the significance test we can see that the p-value &lt; 0.05 indicating the autocorrealtion is not significant. While using nearest neighbor we found that I (0.017) indicated a weak positive spatial autocorrelation. One reason for the difference is k-nearest neighbor uses polygon within a greater distance and can include more polygons as compared to contiguous neighbor which uses either “queens” or “rooks” contiguity <span class="citation">(<a href="#ref-suryowati_comparison_2018">Suryowati, Bekti, and Faradila 2018</a>)</span>.</p>
</div>
<div id="gearys-c" class="section level2 hasAnchor" number="9.6">
<h2><span class="header-section-number">9.6</span> Geary’s C<a href="spatial-estimation.html#gearys-c" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>Another more local measure of spatial autocorrelation unlike Moran’s I is <strong>Geary’s C</strong> <span class="citation">(<a href="#ref-geary_contiguity_1954">Geary 1954</a>)</span>. While Moran’s I is calculated by standardizing the spatial autocovariance by the variance of the data. Geary’s c on the other had uses the sum of the squared differences between pairs of data values as it is a measure of covariance <span class="citation">(<a href="#ref-geary_contiguity_1954">Geary 1954</a>)</span>. However, both statistics depends on the spatial nature of data and are based on neighborhood. Both of these statistics depend on a spatial structure specified by a spatial weights matrix. The value of Geary’s C ranges between 0 to some unknown positive value, where 0 indicates the spatial randomness, values less than 1 indicates the positive spatial autocorrelation, while value greater than 1 indicates negative spatial autocorrelation <span class="citation">(<a href="#ref-geary_contiguity_1954">Geary 1954</a>)</span>. It is calculated using following formula:
<span class="math display">\[ C=\frac{(n-1) \sum_{i}^n\sum_{j}^nw_{ij}(y_i-y_j)^2}{2\sum_{i}^n\sum_{j}^nw_{ij}\sum_{i}(y_{i}-\bar{y})^2}\]</span></p>
<p><strong>Step 1 and 2: We will calculate all the neighborhood list exactly how we did for Moran’s I and get our spatial weight matrix</strong></p>
<p><strong>Step 2: In our final step, we will use geary funtion from “spdep” package to calculate the value of Geary’s</strong></p>
<p><strong><em>For Queens Case</em></strong></p>
<div class="sourceCode" id="cb18"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb18-1"><a href="spatial-estimation.html#cb18-1" tabindex="-1"></a><span class="do">## Geary C </span></span>
<span id="cb18-2"><a href="spatial-estimation.html#cb18-2" tabindex="-1"></a><span class="fu">geary</span>(filename<span class="sc">$</span>Basal, ww, <span class="at">n=</span><span class="fu">length</span>(ww<span class="sc">$</span>neighbours),<span class="at">n1=</span><span class="fu">length</span>(ww<span class="sc">$</span>neighbours)<span class="sc">-</span><span class="dv">1</span>, <span class="at">S0=</span><span class="fu">Szero</span>(ww))</span></code></pre></div>
<pre><code>## $C
## [1] 0.9944114
## 
## $K
## [1] 4.854083</code></pre>
<div class="sourceCode" id="cb20"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb20-1"><a href="spatial-estimation.html#cb20-1" tabindex="-1"></a><span class="do">## Significance test for Geary C</span></span>
<span id="cb20-2"><a href="spatial-estimation.html#cb20-2" tabindex="-1"></a><span class="fu">geary.test</span>(filename<span class="sc">$</span>Basal, ww)</span></code></pre></div>
<pre><code>## 
##  Geary C test under randomisation
## 
## data:  filename$Basal 
## weights: ww 
## 
## Geary C statistic standard deviate = 0.02595, p-value = 0.4896
## alternative hypothesis: Expectation greater than statistic
## sample estimates:
## Geary C statistic       Expectation          Variance 
##        0.99441140        1.00000000        0.04638142</code></pre>
<p><strong><em>For Nearest Neighbour Method</em></strong></p>
<div class="sourceCode" id="cb22"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb22-1"><a href="spatial-estimation.html#cb22-1" tabindex="-1"></a><span class="do">## Geary C</span></span>
<span id="cb22-2"><a href="spatial-estimation.html#cb22-2" tabindex="-1"></a><span class="fu">geary</span>(filename<span class="sc">$</span>Basal, ww1, <span class="at">n=</span><span class="fu">length</span>(ww1<span class="sc">$</span>neighbours),<span class="at">n1=</span><span class="fu">length</span>(ww1<span class="sc">$</span>neighbours)<span class="sc">-</span><span class="dv">1</span>, <span class="at">S0=</span><span class="fu">Szero</span>(ww1))</span></code></pre></div>
<pre><code>## $C
## [1] 0.9416159
## 
## $K
## [1] 4.854083</code></pre>
<div class="sourceCode" id="cb24"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb24-1"><a href="spatial-estimation.html#cb24-1" tabindex="-1"></a><span class="do">## Significance test for Geary C</span></span>
<span id="cb24-2"><a href="spatial-estimation.html#cb24-2" tabindex="-1"></a><span class="fu">geary.test</span>(filename<span class="sc">$</span>Basal, ww1)</span></code></pre></div>
<pre><code>## 
##  Geary C test under randomisation
## 
## data:  filename$Basal 
## weights: ww1 
## 
## Geary C statistic standard deviate = 0.3791, p-value = 0.3523
## alternative hypothesis: Expectation greater than statistic
## sample estimates:
## Geary C statistic       Expectation          Variance 
##        0.94161588        1.00000000        0.02371762</code></pre>
<p>Note that the value of Geary’s C indicated a positive spatial autocorrelation using both queens case and k-nearest neighbor. However, the spatial autocorrelation was not significant as given by p-value &lt; 0.05. Both Moran’s I and Geary’s C are in agreement in terms of results.</p>
</div>
<div id="populations-samples-and-statistics" class="section level2 hasAnchor" number="9.7">
<h2><span class="header-section-number">9.7</span> Populations, Samples and Statistics<a href="spatial-estimation.html#populations-samples-and-statistics" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>Suppose you are interested in measuring the heights of trees in a forest. There are a lot of trees in this forest and you cannot measure all of them. So you cleverly decide to sample some locations and infer the mean tree height of the forest from this sample. In this example, the number of trees that you measured are the <strong>sample</strong> <span class="math inline">\(n\)</span>, the forest is the total <strong>population</strong> of trees <span class="math inline">\(N\)</span>, and the <strong>statistic</strong> that you are interested in estimating is the mean tree height of the forest:</p>
<p><span class="math display">\[
x̄ = \frac{1}{n} \sum_{i=1}^{n} x_i
\]</span>
Lowercase <span class="math inline">\(x\)</span> represents any sampled tree and <span class="math inline">\(x̄\)</span> represents the mean of the <strong>sample</strong>, which is an <strong>estimate</strong> of the <strong>population</strong> mean. It is important to recognize that statistics of samples and populations are discussed and represented differently. The true mean tree height of the forest is denoted by the Greek lowercase mu <span class="math inline">\(μ\)</span>, and we can never know this value without measuring every tree. So instead, we <strong>infer</strong> the population statistic using the sampled data and hope that the sample statistic will be close to the true population statistic, but we must accept that they are rarely equivalent <span class="math inline">\(x̄≠μ\)</span>. The same equation above can be re-written for the population mean:</p>
<p><span class="math display">\[
μ = \frac{1}{N} \sum_{i=1}^{N} X_i
\]</span></p>
<p>Notice here we are using <span class="math inline">\(μ\)</span> to signify the population mean tree height, uppercase <span class="math inline">\(N\)</span> signifies all the trees in the population, and uppercase <span class="math inline">\(X_i\)</span> is one tree in the population. At this point, you might take a moment to appreciate that as our sample <span class="math inline">\(n\)</span> approaches <span class="math inline">\(N\)</span>, our sample mean <span class="math inline">\(x̄\)</span> should also approach the population mean <span class="math inline">\(μ\)</span>. In other words, the more trees we sample, the more likely we are going to have an accurate estimate of <span class="math inline">\(μ\)</span>. It might surprise you that this conclusion is likely true for large samples <span class="math inline">\(n\)</span>, but not small samples <span class="math inline">\(n\)</span>. Why? Because any randomly-selected tree from our forest <span class="math inline">\(n=1\)</span> could be much taller or shorter than the mean just due to random chance alone. In fact, if our forest has two distinct cohorts of trees, one very young emerging below the canopy and one established in the overstory (i.e., bi-modal distribution), then the population mean might never be approximated by any particular tree. This is problematic for us, because we want to accurately estimate the population statistic whilst exhausting as few of our resources as possible to do so (i.e., time, people, equipment, budget).</p>
<p>When we made our measures of tree heights, it would be reasonable for us to expect that the tree heights that we sampled are going to be different (i.e., most trees will not have the same height). The magnitude of those differences in the sample are captured by the <strong>variance</strong>, which is a measure of the dispersion of our tree heights <span class="math inline">\(x\)</span> relative to the sample mean <span class="math inline">\(x̄\)</span>:</p>
<p><span class="math display">\[
s^2 = \frac{1}{n} \sum_{i=1}^{n} (x_i-x̄)^2
\]</span>
We square the differences so that the variance is always positively signed and consequently variance always has squared units, hence <span class="math inline">\(s^2\)</span>. If we take the square root of the variance, we have the <strong>standard deviation</strong>:</p>
<p><span class="math display">\[
s = \sqrt{s^2}
\]</span>
The population standard deviation is represented by Greek lowercase sigma <span class="math inline">\(σ\)</span> and population variance is <span class="math inline">\(σ^2\)</span>.</p>
</div>
<div id="significance-testing" class="section level2 hasAnchor" number="9.8">
<h2><span class="header-section-number">9.8</span> Significance Testing<a href="spatial-estimation.html#significance-testing" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>The significance level of a test statistic from the sample is compared with the critical value of the test statistic obtained by repeatedly reordering the data with random proportions <span class="citation">(<a href="#ref-jacquez_spatial_1999">Jacquez 1999</a>)</span>. Interpretation of this significance level in classical statistics is done using a <strong>p-value</strong> which, if less than or equal to a defined threshold, also know as <strong>alpha α</strong> (usually 5% or 0.05), then the <strong>null hypothesis</strong> of “no difference from random” is rejected <span class="citation">(<a href="#ref-jacquez_spatial_1999">Jacquez 1999</a>)</span>. In other words, when the p-value is less than or equal to 0.05, we conclude that the statistic we observe for the sample is unlikely to have occurred due to random chance alone. This interpretation is important because recall that if our sample is small, there is a random chance that any statistic we calculate from it could be due to that particular sample rather than represent a true characteristic of the larger population. For example, imagine the case where we randomly sample some trees, but by chance we happen to only sample young trees and so our mean tree height from the sample is not representative of the population. The p-value represents the probability that our statistic from the sample is observed due to random chance, so we want this value to be as low as possible.</p>
<p>While <span class="math inline">\(α=0.05\)</span> is widely used, there are cases where we may set a higher standard. For example, where the risk of incorrectly rejecting the null hypothesis, known as a “false positive” or <strong>Type I error</strong>, could have significant consequences on human health or safety. Consider the case where a new drug is being tested for efficacy and the p-value in the clinical trial is 0.05, so the null hypothesis that placebo is better than the drug is rejected. But there is a 5% probability that there is no difference between the new drug and a placebo. The implication is that 5% of the human population who take the new drug will not experience any benefits. If the population eligible for this drug is large, this can translate to many people being impacted by this decision. You can see how this can be problematic because there might be alternative therapies or drugs that are more effective than this new drug that the population are not utilizing. A similar case might exist where we believe that the null hypothesis is true, but it is in fact false, known as a “false negative” or <strong>Type II error</strong>. In these cases, we want to be sure that our result is not spurious, so the p-value standard may be raised to 0.01 or even 0.001, so that only one person in a hundred or one person in a thousand will experience no difference from the placebo.</p>
</div>
<div id="classical-statistics-vs.-geostatistics" class="section level2 hasAnchor" number="9.9">
<h2><span class="header-section-number">9.9</span> Classical Statistics vs. Geostatistics<a href="spatial-estimation.html#classical-statistics-vs.-geostatistics" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>In classical statistics, the variance is assumed to be totally random when samples are drawn from a defined population <span class="citation">(<a href="#ref-jacquez_spatial_1999">Jacquez 1999</a>)</span> and are assumed to come from one distribution <span class="citation">(<a href="#ref-steel_principles_1980">Steel and Torrie 1980</a>)</span>. Inferences about the population can be made by comparing a statistic calculated for the sample to the distribution of that statistic under the null hypothesis for the assumed distribution <span class="citation">(<a href="#ref-jacquez_spatial_1999">Jacquez 1999</a>)</span>.</p>
<p>In geostatistics, the variance of a spatial phenomenon is assumed to be partly random and each point in the field represents a sample from some distribution <span class="citation">(<a href="#ref-jacquez_spatial_1999">Jacquez 1999</a>)</span>. However, the distribution at any one point may differ completely from all other points in its shape, mean, and variance. The distribution of differences in sample values separated by a specified distance is assumed to be the same over the entire field. Sample values that exhibit spatial autocorrelation due to their proximity to each other will have relatively small random variance of the distribution of differences. If the sample values do not exhibit spatial autocorrelation, then the variance is larger. The <strong>semivariance</strong> or half of the variance is used to measure the similarity between points at a given distance apart. The distance at which we compare the semivariance of sample values is known as the <strong>lag distance</strong>. If we graph semivariance and lag distance, we have created a <strong>semivariogram</strong>. Since we are usually dealing with samples and not the full population, we will almost never know the exact semi-variogram, instead we must rely on fitting models to <strong>estimate</strong> this relationship.</p>
<p>Thus, geostatistics is distinguished from classical statistics by the fact that we need to estimate the semivariogram function and then incorporate the semivariogram function to estimate the values at unsampled locations using various predictive spatial methods.</p>
</div>
<div id="semivariogram-modeling" class="section level2 hasAnchor" number="9.10">
<h2><span class="header-section-number">9.10</span> Semivariogram Modeling<a href="spatial-estimation.html#semivariogram-modeling" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>The semivariogram is a basic geostatistical tool for measuring spatial autocorrelation of a variable measured at different spatial location. A semivariogram is a measure of variance of a variable between two locations separated by certain lag distance <span class="citation">(<a href="#ref-isaaks_introduction_1989">Isaaks and Srivastava 1989</a>)</span>. For example, we can measure how a variable <span class="math inline">\(y\)</span> changes in value between sites <span class="math inline">\(i\)</span> and <span class="math inline">\(j\)</span> by calculating the variance between the sites <span class="math inline">\(y_i-y_j\)</span>. If the surface represented by the two points is continuous and the lag is a small distance, we would expect the variance to be small <span class="citation">(<a href="#ref-isaaks_introduction_1989">Isaaks and Srivastava 1989</a>)</span>. With increasing lag distance, we would expect the variance to increase. Let us translate this intuitive statement into a equation known as the empirical variogram:</p>
<p><span class="math display">\[\gamma{(h)}=\frac{1}{2N}\sum_{i,j=1}^{N(h)}{({y_i}-y_j)}^2\]</span></p>
<p>Where, <span class="math display">\[\gamma{h}=\text{semivariance at a spatial lag h}\]</span>
<span class="math display">\[ i=\text{measure spatial coordinate (latitude/UTM easting)}\]</span>
<span class="math display">\[ j=\text{measure spatial coordinate (longitude/UTM northing)}\]</span>
<span class="math display">\[y_{i}=\text{measured value of variable of interest at the spatial location i} \]</span>
<span class="math display">\[y_{j}=\text{measured value of variable of interest at the spatial location j} \]</span>
<span class="math display">\[N=\text{number of sampled differences or lag} \]</span></p>
<p>Like the familiar variance, it is a sum of squared differences divided by the number <span class="math inline">\(N\)</span> of sampled differences. Unlike simple variance about a mean that we discussed earlier, the semivariogram measures difference between two sample values. The <strong>semi</strong> in semivariogram comes from the fact that the variance is divided in half.</p>
<p>A semivariogram is a graph that consists of semivariance on the y-axis and a lag distance on the x-axis Figure <a href="spatial-estimation.html#fig:10-semivariogram-modelling">9.4</a>. There are some important features of a semivariogram that can be used to interpret the nature and structure of spatial autocorrelation.</p>
<div class="figure"><span style="display:block;" id="fig:10-semivariogram-modelling"></span>
<img src="geomatics-for-environmental-management-_files/figure-html/10-semivariogram-modelling-1.png" alt="An example semivariogram with all the components using the 'Fulmar'data from 'gstat' package in R. Nepal, CC-BY-SA-4.0." width="672" />
<p class="caption">
Figure 9.4: An example semivariogram with all the components using the ‘Fulmar’data from ’gstat’ package in R. Nepal, CC-BY-SA-4.0.
</p>
</div>
<p><strong>Range <span class="math inline">\(a\)</span>:</strong> The distance at which a variogram model first flattens out. This is the distance up to which the variable is considered to be spatially autocorrelated (Figure <a href="spatial-estimation.html#fig:10-semivariogram-modelling">9.4</a>). For variogram models that are bounded and have sills, the range is generally accepted to be 95% of the sill.</p>
<p><strong>Nugget <span class="math inline">\(c_0\)</span>:</strong> Nugget refers to unaccounted autocorrelation due to a smaller lag distance than sampling distance or due to errors and imprecision arising from sampling (Figure <a href="spatial-estimation.html#fig:10-semivariogram-modelling">9.4</a>). The nugget is also where the variance function <span class="math inline">\(\gamma{(h)}\)</span> intercepts the y-axis. Without the nugget, we would expect all variogram models to evaluate to zero variance at zero lag <span class="math inline">\(\gamma{(0)}=0\)</span>, and conceptually this makes sense because how can you have variance between any observation and itself?</p>
<p><strong>Sill <span class="math inline">\(s\)</span>:</strong> The value of variance that a variogram model attains at a given range (Figure <a href="spatial-estimation.html#fig:10-semivariogram-modelling">9.4</a>).</p>
<p><span class="math display">\[
s=c_0+c_1
\]</span></p>
<p><strong>Partial sill <span class="math inline">\(c_1\)</span>:</strong> The sill minus the nugget.</p>
<p><span class="math display">\[
c_1=s-c_0
\]</span></p>
<p><strong>Partial sill to total sill ratio:</strong> The structural variance explained by the fitted variogram model <span class="citation">(<a href="#ref-rossi_geostatistical_1992">Rossi et al. 1992</a>)</span>. This is the amount of variance that is spatially autocorrelated <span class="citation">(<a href="#ref-rossi_geostatistical_1992">Rossi et al. 1992</a>)</span>.</p>
<p><span class="math display">\[ Ratio =\frac {s}{s+a}\]</span></p>
<p>Usually, we are interested in modeling the semivariance (semivariogram) or variance (variogram) of a process so that we can make predictions from a model rather than an incomplete set of sampled observations. In this way, we can fit a model to our paired observations and use a continuous variogram function to estimate the variance at any lag. These models are known as <strong>theoretical variograms</strong> and in the following sections we will compare several commonly-used models, summarized in Figure <a href="spatial-estimation.html#fig:10-theoretical-variogram-models">9.5</a>.</p>
<div class="figure"><span style="display:block;" id="fig:10-theoretical-variogram-models"></span>
<img src="images/10-theoretical-variogram-models.png" alt="Comparison of theoretical variogram models. The upper bound of the variance in the plot is the sill for variogram models that have sills and the upper limit of the lag in the plot is the range for variogram models that have ranges. Note that the linear and power models are not bounded and extend infinitely beyond the plot space. The exponential, quadratic, and Gaussian models approach the sill asymptotically as lag distances approach infinity. Pickell, CC-BY-SA-4.0." width="75%" />
<p class="caption">
Figure 9.5: Comparison of theoretical variogram models. The upper bound of the variance in the plot is the sill for variogram models that have sills and the upper limit of the lag in the plot is the range for variogram models that have ranges. Note that the linear and power models are not bounded and extend infinitely beyond the plot space. The exponential, quadratic, and Gaussian models approach the sill asymptotically as lag distances approach infinity. Pickell, CC-BY-SA-4.0.
</p>
</div>
<div id="nugget-variogram-model" class="section level3 hasAnchor" number="9.10.1">
<h3><span class="header-section-number">9.10.1</span> Nugget variogram model<a href="spatial-estimation.html#nugget-variogram-model" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>A <strong>nugget model</strong> is the simplest model that assumes there is no relationship between variance and lag and consequently there is no range for this model. In other words, the variance is assumed to be constant. This is also the least likely case for most natural spatial phenomena. If you used this model to make spatial predictions, then your predictions would be made as if your data had no spatial component at all, so this is also the least useful model for spatial prediction. The nugget model is expressed as:</p>
<p><span class="math display">\[
\begin{array}{ccc}
\gamma{(h)} = 0 &amp; \text{for }h=0, \\
\gamma{(h)} = 1 &amp; \text{ for }h&gt;0
\end{array}
\]</span></p>
</div>
<div id="linear-variogram-model" class="section level3 hasAnchor" number="9.10.2">
<h3><span class="header-section-number">9.10.2</span> Linear variogram model<a href="spatial-estimation.html#linear-variogram-model" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>A <strong>linear model</strong> assumes a linear and constant slope <span class="math inline">\(b\)</span> between variance and lag. Like the nugget model, the linear model has no defined range or sill. Unlike the linear model, variance is assumed to be infinite and therefore it is not possible to distinguish between correlated and uncorrelated lags. Note the special case of <span class="math inline">\(b=0\)</span> is equivalent to the nugget model. A linear effect in spatial autocorrelation suggests a trend in your spatial data. The linear model is expressed as:</p>
<p><span class="math display">\[
\gamma{(h)} = bh+c_0
\]</span>
Where <span class="math inline">\(b\)</span> is the slope to be estimated.</p>
</div>
<div id="quadratic-variogram-model" class="section level3 hasAnchor" number="9.10.3">
<h3><span class="header-section-number">9.10.3</span> Quadratic variogram model<a href="spatial-estimation.html#quadratic-variogram-model" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>A <strong>quadratic or logistic model</strong> assumes variance increases near-exponentially, but the shape is more “S”-shaped or sigmoid. The quadratic model is expressed as:</p>
<p><span class="math display">\[
\gamma{(h)} = \frac{ah^2}{1+bh^2}+c_0
\]</span>
Where <span class="math inline">\(b\)</span> is the slope to be estimated.</p>
</div>
<div id="exponential-variogram-model" class="section level3 hasAnchor" number="9.10.4">
<h3><span class="header-section-number">9.10.4</span> Exponential variogram model<a href="spatial-estimation.html#exponential-variogram-model" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>An <strong>exponential model</strong> assumes spatial autocorrelation decreases exponentially with increasing lag distance. The variance in the exponential variogram approaches the sill asymptotically as <span class="math inline">\(h → ∞\)</span>, so unlike the spherical and nugget models, an exponential model never assumes a repeating variance beyond the range. Since the variance will continue to marginally increase with infinite lag distance, the range is defined as 95% of the sill <span class="math inline">\(a=0.95s\)</span> or <span class="math inline">\(3a\)</span> beyond which lag distances <span class="math inline">\(h\)</span> are considered not spatially autocorrelated for the given variable. The exponential model is expressed as:</p>
<p><span class="math display">\[
\gamma{(h)} = c_1(1-e^{-\frac{h}{a}})+c_0
\]</span></p>
</div>
<div id="gaussian-variogram-model" class="section level3 hasAnchor" number="9.10.5">
<h3><span class="header-section-number">9.10.5</span> Gaussian variogram model<a href="spatial-estimation.html#gaussian-variogram-model" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>A <strong>Gaussian model</strong> assumes that spatial autocorrelation is extremely high at short lag distances (i.e., variance is low) and then falls quickly towards zero (i.e., variance is high) at farther lag distances. This is a good model to use if you expect high local autocorrelation or phenomena that change rapidly with distance. The range is defined as 95% of the sill <span class="math inline">\(a=0.95s\)</span> or <span class="math inline">\(\sqrt{3}a\)</span> beyond which lag distances <span class="math inline">\(h\)</span> are considered not spatially autocorrelated for the given variable. The Gaussian model is expressed as:</p>
<p><span class="math display">\[
\gamma{(h)} = c_1(1-e^{-(\frac{h}{a})^2})+c_0
\]</span></p>
</div>
<div id="spherical-variogram-model" class="section level3 hasAnchor" number="9.10.6">
<h3><span class="header-section-number">9.10.6</span> Spherical variogram model<a href="spatial-estimation.html#spherical-variogram-model" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>A <strong>spherical model</strong> assumes a progressive, but not constant, decrease of spatial autocorrelation (i.e., increasing variance) until the range, beyond which autocorrelation is zero and variance remains the same. Note that the slope of a spherical model is generally higher (i.e., faster) than a linear model where <span class="math inline">\(h&lt;a\)</span>. The spherical model is one of the most commonly used models because the assumption of zero autocorrelation beyond the range <span class="math inline">\(h&gt;a\)</span>. The spherical model is expressed as:</p>
<p><span class="math display">\[
\begin{array}{ccc}
\gamma{(h)} = c_1(\frac{3}{2}\frac{h}{a}-\frac{1}{2}(\frac{h}{a})^3)+c_0 &amp; \text{for }0&lt;h≤a, \\
\gamma{(h)} = s = c_0 + c_1 = 0 &amp; \text{ for }h&gt;a
\end{array}
\]</span></p>
</div>
<div id="power-variogram-model" class="section level3 hasAnchor" number="9.10.7">
<h3><span class="header-section-number">9.10.7</span> Power variogram model<a href="spatial-estimation.html#power-variogram-model" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>A <strong>power model</strong> modulates the variance by raising the lag to a power <span class="math inline">\(λ\)</span>:</p>
<p><span class="math display">\[
\begin{array}{ccc}
\gamma{(h)} = h^λ &amp; \text{for }0&lt;λ&lt;2, \\
\gamma{(h)} = bh+c_0 &amp; \text{for }λ=1
\end{array}
\]</span></p>
<p>The power model has no range or sill that can be estimated and the variance process is considered to be infinite, the same as the exponential and Gaussian models. Notably, <span class="math inline">\(λ=1\)</span> is equivalent to the linear model.</p>
</div>
<div id="case-study-selecting-the-appropriate-variogram-model" class="section level3 unnumbered hasAnchor">
<h3>Case Study: Selecting the appropriate variogram model<a href="spatial-estimation.html#case-study-selecting-the-appropriate-variogram-model" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>We will look at some different models for estimating the semivariogram. We will use the ground plot data from the young stand monitoring (YSM) program data <span class="citation">(<a href="#ref-province_of_bc_provincial_2018">Province of BC 2018</a>)</span> for Fort Saint Johns Timber Supply Area (TSA) in the province of British Columbia, Canada. Fort Saint Johns is divided into six blocks respectively Figure <a href="spatial-estimation.html#fig:10-FSJ-plot">9.6</a>. There are a total of 108 YSM plots used in this study (Figure <a href="spatial-estimation.html#fig:10-FSJ-plot">9.6</a>). The total basal area (<span class="math inline">\(m^2/ha\)</span>) is the variable that we want to predict spatially. For each of the YSM plots, we will calculate the total basal area by adding the basal area for all trees within each plot. We will explore different variogram models with these data and check which model provides the best fit for the variogram.</p>
<div class="figure"><span style="display:block;" id="fig:10-FSJ-plot"></span>
<img src="images/10-FSJ-plot.png" alt="Location of Fort Saint Johns Timber Supply Area (TSA) in British Columbia (BC), Canada and the young stand monitoring (YSM) plots. Nepal, CC-BY-SA-4.0." width="1650" />
<p class="caption">
Figure 9.6: Location of Fort Saint Johns Timber Supply Area (TSA) in British Columbia (BC), Canada and the young stand monitoring (YSM) plots. Nepal, CC-BY-SA-4.0.
</p>
</div>
<div class="figure"><span style="display:block;" id="fig:10-gaussian"></span>
<img src="geomatics-for-environmental-management-_files/figure-html/10-gaussian-1.png" alt="Semivariogram comparing different variogram models for basal area (m2/ha) of the young stand monitoring plots. Nepal, CC-BY-SA-4.0." width="672" />
<p class="caption">
Figure 9.7: Semivariogram comparing different variogram models for basal area (m2/ha) of the young stand monitoring plots. Nepal, CC-BY-SA-4.0.
</p>
</div>
<p>Just looking at the variograms, it appears that all of the four models fit our data well and indicates there is a strong correlation in basal area per hectare of live trees between the plots. However, we will use all the components of semivariogram models to pick our best fitting variogram.</p>
<table>
<caption><span id="tab:10-circular-2">Table 9.1: </span>Summary of various component of variogram for four different models.</caption>
<thead>
<tr class="header">
<th align="left">Model</th>
<th align="left">Range</th>
<th align="left">Nugget</th>
<th align="left">Sill</th>
<th align="left">Partial_sill</th>
<th align="left">Sill_to_Sill</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="left">Circular</td>
<td align="left">7433.68</td>
<td align="left">552.71</td>
<td align="left">2338.27</td>
<td align="left">1785.56</td>
<td align="left">0.76</td>
</tr>
<tr class="even">
<td align="left">Gaussian</td>
<td align="left">4446.62</td>
<td align="left">0.00</td>
<td align="left">2995.05</td>
<td align="left">4446.62</td>
<td align="left">1.00</td>
</tr>
<tr class="odd">
<td align="left">Spherical</td>
<td align="left">9729.37</td>
<td align="left">14.13</td>
<td align="left">2980.05</td>
<td align="left">2966.37</td>
<td align="left">0.99</td>
</tr>
<tr class="even">
<td align="left">Exponential</td>
<td align="left">3871.76</td>
<td align="left">0.00</td>
<td align="left">2994.05</td>
<td align="left">2994.05</td>
<td align="left">1.00</td>
</tr>
</tbody>
</table>
<p>We can see that the p-to-s ratio is highest for Gaussian and exponential semivariogram. This indicates the most total amount of semivariance that is spatially autocorrelated. Similarly, we can see that both models are indicating that we are observing a spatial autocorrelation in basal area at a very shorter range. Since with, exponential semivariogram autocorrelation only disappear at a infinite distance in reality, it is better to pick a Gaussian model in most of the similar cases like we have in this example.</p>
</div>
</div>
<div id="sampling" class="section level2 hasAnchor" number="9.11">
<h2><span class="header-section-number">9.11</span> Sampling<a href="spatial-estimation.html#sampling" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p><strong>Sampling</strong> can be defined as the process of selecting some part of a population in order to make an inference, and estimate some parameters about the whole population<span class="citation">(<a href="#ref-thompson_sampling_2012">S. K. Thompson 2012</a>)</span>. For example, to estimate the amount of biomass of trees in the University of British Columbia Malcolm Knapp Research Forest, scientists collect data on tree size and height from 100 randomly distributed small plots across the forest. Based on some allometric equations that relate these tree size measures to the mass of different species, biomass of the entire Malcolm Knapp Research Forest can be estimated. Similarly, to estimate the amount of recoverable oil in a region, a few (highly expensive) sample holes can be drilled (example adapted from <span class="citation">S. K. Thompson (<a href="#ref-thompson_sampling_2012">2012</a>)</span>). The situation is similar in a national opinion survey, in which only a sample of the people in the population are contacted, and the opinions in the sample are used to estimate the proportions with the various opinions in the whole population (example adapted from <span class="citation">S. K. Thompson (<a href="#ref-thompson_sampling_2012">2012</a>)</span>).</p>
<p>Sampling should not be confused with observational study. In an observational study, one has little-to-no control over the inclusion of units in the study whereas sampling usually consists of a well-defined protocol for defining both the population under study and the inclusion criteria of units to sample <span class="citation">(<a href="#ref-thompson_sampling_2012">S. K. Thompson 2012</a>)</span>. Broadly, sampling can be categorized into two groups <span class="citation">(<a href="#ref-teddlie_mixed_2007">Teddlie and Yu 2007</a>)</span>:</p>
<ol style="list-style-type: decimal">
<li>Probability sampling</li>
<li>Non-probability sampling</li>
</ol>
<p>Before getting into the details about different types of sampling. We will make ourself familiar with some sampling key terms and their definitions.</p>
</div>
<div class="box-content call-out-content">
<div id="recall-this-1" class="section level2 unnumbered hasAnchor box-title call-out-top">
<h2>Recall This<a href="spatial-estimation.html#recall-this-1" class="anchor-section" aria-label="Anchor link to header"></a></h2>
</div>
<p id="box-text">
<div id="population" class="section level2 hasAnchor" number="9.12">
<h2><span class="header-section-number">9.12</span> Population<a href="spatial-estimation.html#population" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>Any large spatially defined entity of plots, people, trees, animals etc., from which samples are drawn and measurement of certain characteristics is conducted.</p>
</div>
<div id="sampling-design" class="section level2 hasAnchor" number="9.13">
<h2><span class="header-section-number">9.13</span> Sampling Design<a href="spatial-estimation.html#sampling-design" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>The procedure by which the sample of units is selected from the population is called the sampling design.</p>
</div>
<div id="sampling-unit" class="section level2 hasAnchor" number="9.14">
<h2><span class="header-section-number">9.14</span> Sampling Unit<a href="spatial-estimation.html#sampling-unit" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>The smallest entity within a population from which the information about population is drawn is known as sampling unit. For example, in a survey of potential internet user over entire BC , sampling unit can be the certain number of household in each city across BC.</p>
</p>
</div>
</div>
<div id="probability-sampling" class="section level2 hasAnchor" number="9.15">
<h2><span class="header-section-number">9.15</span> Probability Sampling<a href="spatial-estimation.html#probability-sampling" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>Probability sampling techniques are mostly used in studies that use extensive amount of quantitative analysis <span class="citation">(<a href="#ref-tashakkori_sage_2010">Tashakkori and Teddlie 2010</a>)</span>. It involves selecting a large number of units from a population where the probability of inclusion for every member of the population is determinable <span class="citation">(<a href="#ref-tashakkori_sage_2010">Tashakkori and Teddlie 2010</a>)</span>.</p>
</div>
<div id="simple-random-sampling" class="section level2 hasAnchor" number="9.16">
<h2><span class="header-section-number">9.16</span> Simple Random Sampling<a href="spatial-estimation.html#simple-random-sampling" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>In simple random sampling, each sampling unit within a given population has equal probability of being selected in a sample <span class="citation">(<a href="#ref-thompson_sampling_2012">S. K. Thompson 2012</a>)</span>.For example, suppose we would like to measure the tree heights of all the trees from a simple random sample of 60 plots with their spatial locations (given by plots center co-ordinates) from a forest divided into 625 spatially defined plots as given in <strong>Figure <a href="spatial-estimation.html#fig:10-simple-random-sampling">9.8</a></strong>. Notice, there is no distinctive pattern on how plots are being selected for the measurement of tree heights, this justify the <strong>random part</strong> of the simple random sampling.</p>
<p>As an investigator, when we make a sequence of selections from a population, at each step, new and distinct set of sampling units are being selected in the sample, each having equal probability of being selected at each step.</p>
<p>For example, when we take another sample of 60 plots, we can see that different <strong>sampling units (plots)</strong> are being selected from what we obtained, this represent the <strong>equal probability</strong> of each sampling unit being selected.</p>
<div class="figure"><span style="display:block;" id="fig:10-simple-random-sampling"></span>
<img src="geomatics-for-environmental-management-_files/figure-html/10-simple-random-sampling-1.png" alt="Simple random sample of 60 units from a population of 625 units. Nepal, CC-BY-SA-4.0." width="672" />
<p class="caption">
Figure 9.8: Simple random sample of 60 units from a population of 625 units. Nepal, CC-BY-SA-4.0.
</p>
</div>
<p>Simple random sample of 60 units from a population of 625 units.</p>
<div class="figure"><span style="display:block;" id="fig:10-simple-random-sampling-2"></span>
<img src="geomatics-for-environmental-management-_files/figure-html/10-simple-random-sampling-2-1.png" alt="Another simple random sample of 60 units. Nepal, CC-BY-SA-4.0." width="672" />
<p class="caption">
Figure 9.9: Another simple random sample of 60 units. Nepal, CC-BY-SA-4.0.
</p>
</div>
</div>
<div id="stratified-random-sampling" class="section level2 hasAnchor" number="9.17">
<h2><span class="header-section-number">9.17</span> Stratified Random Sampling<a href="spatial-estimation.html#stratified-random-sampling" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>When a population under study is not <strong>homogeneous</strong> (similar in biological characteristics) across the entire study area and consists of some sort of gradient, stratified random sampling method is used <span class="citation">(<a href="#ref-thompson_sampling_2012">S. K. Thompson 2012</a>)</span>. The principle of stratification is to partition the population in such a way that the units within a stratum are as similar as possible <span class="citation">(<a href="#ref-teddlie_mixed_2007">Teddlie and Yu 2007</a>)</span>. Random samples from each strata are drawn to ensure adequate sampling of all groups <span class="citation">(<a href="#ref-teddlie_mixed_2007">Teddlie and Yu 2007</a>)</span>. Even though one stratum may differ markedly from another, a stratified sample with the desired number of units from each stratum in the population will tend to be “representative” of the population as a whole <span class="citation">(<a href="#ref-howell_area_2020">Howell et al. 2020</a>)</span>.</p>
<p>For example, a forest under study is divided <strong>(stratified)</strong> into similar regions Figure <a href="spatial-estimation.html#fig:10-simple-random-sampling-2">9.9</a> defined by elevation, soil moisture, and soil nutrient gradient and random samples are taken within each strata. The stratification of a study region despite of its size can help to spread the sample over the entire study area.</p>
<div class="figure"><span style="display:block;" id="fig:10-stratified-random-sampling"></span>
<img src="geomatics-for-environmental-management-_files/figure-html/10-stratified-random-sampling-1.png" alt="Stratified random sample within unequal strata within a study area. Nepal, CC-BY-SA-4.0." width="672" />
<p class="caption">
Figure 9.10: Stratified random sample within unequal strata within a study area. Nepal, CC-BY-SA-4.0.
</p>
</div>
<p>Stratified random sample within unequal strata within a study area.</p>
<div class="figure"><span style="display:block;" id="fig:10-stratified-random-sampling-2"></span>
<img src="geomatics-for-environmental-management-_files/figure-html/10-stratified-random-sampling-2-1.png" alt="Stratified random sample from equal strata within a study area. Nepal, CC-BY-SA-4.0." width="672" />
<p class="caption">
Figure 9.11: Stratified random sample from equal strata within a study area. Nepal, CC-BY-SA-4.0.
</p>
</div>
<p>Stratified random sample from equal strata within a study area.</p>
</div>
<div id="systematic-sampling" class="section level2 hasAnchor" number="9.18">
<h2><span class="header-section-number">9.18</span> Systematic Sampling<a href="spatial-estimation.html#systematic-sampling" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>A systematic sample uses a fixed grid or array to assign plots in a regular pattern <strong>Figure <a href="spatial-estimation.html#fig:10-stratified-random-sampling-2">9.11</a></strong> <span class="citation">(<a href="#ref-mcroberts_sampling_2014">McRoberts, Tomppo, and Czaplewski 2014</a>)</span>. The advantage of systematic sampling is that it maximizes the average distance between the plots and therefore minimizes spatial correlation among observations and increases statistical efficiency <span class="citation">(<a href="#ref-mcroberts_sampling_2014">McRoberts, Tomppo, and Czaplewski 2014</a>)</span>. In addition, a systematic sample, which is clearly seen to be representative in some sense, can be very convincing to decision-makers who lack experience with sampling <span class="citation">(<a href="#ref-mcroberts_sampling_2014">McRoberts, Tomppo, and Czaplewski 2014</a>)</span>. Raster grids such as digital elevation models (DEM) are some examples of systematic sample.</p>
<div class="figure"><span style="display:block;" id="fig:10-systematic-sampling"></span>
<img src="geomatics-for-environmental-management-_files/figure-html/10-systematic-sampling-1.png" alt="Sample every second observation in the row. Nepal, CC-BY-SA-4.0." width="672" />
<p class="caption">
Figure 9.12: Sample every second observation in the row. Nepal, CC-BY-SA-4.0.
</p>
</div>
<p>Sample every second observation in the row</p>
<div class="figure"><span style="display:block;" id="fig:10-systematic-sampling-2"></span>
<img src="geomatics-for-environmental-management-_files/figure-html/10-systematic-sampling-2-1.png" alt="Sample all the observation in every second column. Nepal, CC-BY-SA-4.0." width="672" />
<p class="caption">
Figure 9.13: Sample all the observation in every second column. Nepal, CC-BY-SA-4.0.
</p>
</div>
<p>Sample all the observation in every second column</p>
</div>
<div id="cluster-sampling" class="section level2 hasAnchor" number="9.19">
<h2><span class="header-section-number">9.19</span> Cluster Sampling<a href="spatial-estimation.html#cluster-sampling" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>In cluster sampling, rather than sampling individual units, which might be geographically spread over great distances, we can sample groups (clusters) of plots that occur naturally in the study area <span class="citation">(<a href="#ref-teddlie_mixed_2007">Teddlie and Yu 2007</a>)</span>. Cluster sampling is employed when we want to be more efficient in terms of the use of time and money to generate a more efficient probability sample <span class="citation">(<a href="#ref-teddlie_mixed_2007">Teddlie and Yu 2007</a>)</span>.</p>
<div class="figure"><span style="display:block;" id="fig:10-cluster-sampling"></span>
<img src="geomatics-for-environmental-management-_files/figure-html/10-cluster-sampling-1.png" alt="Cluster of plots selected from entire study area. Nepal, CC-BY-SA-4.0." width="672" />
<p class="caption">
Figure 9.14: Cluster of plots selected from entire study area. Nepal, CC-BY-SA-4.0.
</p>
</div>
<p>Cluster of plots selected from entire study area</p>
</div>
<div id="non-probability-sampling" class="section level2 hasAnchor" number="9.20">
<h2><span class="header-section-number">9.20</span> Non-probability Sampling<a href="spatial-estimation.html#non-probability-sampling" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>Non-probability sampling is generally used in qualitative studies. They are also know as <strong>purposive or adaptive sampling</strong>, and defined as selecting units (e.g.,individuals, groups of individuals, institutions) based on specific purposes associated with answering some research questions. <strong>Purposive or Adaptive</strong> sampling can be classified into three broad categories <span class="citation">(<a href="#ref-teddlie_mixed_2007">Teddlie and Yu 2007</a>)</span>:</p>
</div>
<div id="representative-sampling" class="section level2 hasAnchor" number="9.21">
<h2><span class="header-section-number">9.21</span> Representative Sampling<a href="spatial-estimation.html#representative-sampling" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>This type of sampling is used when we want to select samples that will represent broader groups as closely as possible <span class="citation">(<a href="#ref-teddlie_mixed_2007">Teddlie and Yu 2007</a>)</span>. One of the example of representative sampling is selecting 100 Douglas fir and 50 Spruce tree from study area within Malcom Knapp Forest, BC consisting of 500 Douglas fir and 300 Spruce trees for the measurement of tree height.</p>
</div>
<div id="unique-case-sampling" class="section level2 hasAnchor" number="9.22">
<h2><span class="header-section-number">9.22</span> Unique Case Sampling<a href="spatial-estimation.html#unique-case-sampling" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>In this sampling, we want to focus on more specific case which is unique and rare in terms of one or more characteristics <span class="citation">(<a href="#ref-teddlie_mixed_2007">Teddlie and Yu 2007</a>)</span>. One of the example of unique case sampling could be understanding the genetic makeup of person who is not affected by Covid-19 virus.</p>
</div>
<div id="sequential-sampling" class="section level2 hasAnchor" number="9.23">
<h2><span class="header-section-number">9.23</span> Sequential Sampling<a href="spatial-estimation.html#sequential-sampling" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>In this sampling method, we would pick up a single or group of cases in an interval of time, analyzes the results and then move on to the next group of cases and so on <span class="citation">(<a href="#ref-teddlie_mixed_2007">Teddlie and Yu 2007</a>)</span>. The goal of the research project is to generate some theory (or broadly defined themes) <span class="citation">(<a href="#ref-teddlie_mixed_2007">Teddlie and Yu 2007</a>)</span>.</p>
</div>
<div id="spatial-interpolation" class="section level2 hasAnchor" number="9.24">
<h2><span class="header-section-number">9.24</span> Spatial Interpolation<a href="spatial-estimation.html#spatial-interpolation" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p><strong>Spatial interpolation</strong> can be defined as the process of predicting the given <strong>variable of interest</strong> at an unmeasured location given we have the sample in the proximity of the unknown location. Spatial interpolation methods can be categorized into two broad groups:</p>
<ol style="list-style-type: decimal">
<li>Methods without using semivariogram</li>
<li>Methods using semivariogram</li>
</ol>
<p>We will discuss both method with a case study in detail.</p>
</div>
<div id="case-study-3" class="section level2 hasAnchor" number="9.25">
<h2><span class="header-section-number">9.25</span> Case Study 3<a href="spatial-estimation.html#case-study-3" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>For this case study, we will use ground plot data from Young stand monitoring (YSM) program data <span class="citation">(<a href="#ref-province_of_bc_provincial_2018">Province of BC 2018</a>)</span> for Fort Saint Johns timber supply area (TSA) in the province of British Columbia, Canada. Fort Saint Johns is divided into 6 blocks respectively <strong>Figure <a href="spatial-estimation.html#fig:10-FSJ-plot">9.6</a></strong>. There are a total of 108 YSM plots used in this study <strong>Figure <a href="spatial-estimation.html#fig:10-FSJ-plot">9.6</a></strong>. The total basal area (m2/ha) is our variable of interest in this study. For each of the YSM plot the total basal area was calculated by adding the basal area for all trees within the plot. We will use this dataset to explore different interpolation technique to find the variable of interest (basal area) within the unsampled locations.</p>
<div class="figure"><span style="display:block;" id="fig:10-FSJ-plot1"></span>
<img src="images/10-FSJ-plot.png" alt=" Location of Fort Saint Johns TSA and the young stand change monitoring plots. Nepal, CC-BY-SA-4.0." width="1650" />
<p class="caption">
Figure 9.15:  Location of Fort Saint Johns TSA and the young stand change monitoring plots. Nepal, CC-BY-SA-4.0.
</p>
</div>
</div>
<div id="methods-without-using-semi-variogram" class="section level2 hasAnchor" number="9.26">
<h2><span class="header-section-number">9.26</span> Methods Without Using Semi-variogram<a href="spatial-estimation.html#methods-without-using-semi-variogram" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<div class="sourceCode" id="cb26"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb26-1"><a href="spatial-estimation.html#cb26-1" tabindex="-1"></a>filename <span class="ot">&lt;-</span><span class="fu">read_sf</span>(<span class="at">dsn=</span><span class="st">&quot;data/10&quot;</span>,<span class="at">layer=</span><span class="st">&quot;Fort_St_Jh&quot;</span>)</span>
<span id="cb26-2"><a href="spatial-estimation.html#cb26-2" tabindex="-1"></a>plot1<span class="ot">&lt;-</span> <span class="fu">read.csv</span>(<span class="st">&quot;data/10/FJS_plots.csv&quot;</span>,<span class="at">header=</span>T)</span></code></pre></div>
</div>
<div id="nearest-neighbor" class="section level2 hasAnchor" number="9.27">
<h2><span class="header-section-number">9.27</span> Nearest Neighbor<a href="spatial-estimation.html#nearest-neighbor" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>Nearest neighbor interpolation approach uses the value of variable of interest from the nearest sampled location and assign the value to the unsampled location of interest <span class="citation">(<a href="#ref-titus_comparison_2013">Titus and Geroge 2013</a>)</span>. It is very simple method and is most widely used for image processing in remote sensing research <span class="citation">(<a href="#ref-titus_comparison_2013">Titus and Geroge 2013</a>)</span>.</p>
<p><strong>Step 1:Match the projection of plot data with the study area boundary</strong></p>
<div class="sourceCode" id="cb27"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb27-1"><a href="spatial-estimation.html#cb27-1" tabindex="-1"></a><span class="co"># spatstat Used for the dirichlet tessellation function</span></span>
<span id="cb27-2"><a href="spatial-estimation.html#cb27-2" tabindex="-1"></a><span class="co"># maptools Used for conversion from SPDF to ppp</span></span>
<span id="cb27-3"><a href="spatial-estimation.html#cb27-3" tabindex="-1"></a><span class="co"># raster Used to clip out thiessen polygons</span></span>
<span id="cb27-4"><a href="spatial-estimation.html#cb27-4" tabindex="-1"></a>spdf <span class="ot">&lt;-</span> <span class="fu">as_Spatial</span>(filename)</span>
<span id="cb27-5"><a href="spatial-estimation.html#cb27-5" tabindex="-1"></a>dsp <span class="ot">&lt;-</span> <span class="fu">SpatialPoints</span>(plot1[,<span class="dv">14</span><span class="sc">:</span><span class="dv">15</span>], <span class="at">proj4string=</span><span class="fu">CRS</span>(<span class="st">&quot;+proj=utm +zone=10 +ellps=GRS80 +datum=NAD83&quot;</span>))</span>
<span id="cb27-6"><a href="spatial-estimation.html#cb27-6" tabindex="-1"></a>dsp <span class="ot">&lt;-</span> <span class="fu">SpatialPointsDataFrame</span>(dsp, plot1)</span>
<span id="cb27-7"><a href="spatial-estimation.html#cb27-7" tabindex="-1"></a><span class="do">###############</span></span>
<span id="cb27-8"><a href="spatial-estimation.html#cb27-8" tabindex="-1"></a>TA <span class="ot">&lt;-</span> <span class="fu">CRS</span>(<span class="st">&quot;+proj=utm +zone=10 +ellps=GRS80 +datum=NAD83&quot;</span>)</span>
<span id="cb27-9"><a href="spatial-estimation.html#cb27-9" tabindex="-1"></a><span class="fu">library</span>(rgdal)</span>
<span id="cb27-10"><a href="spatial-estimation.html#cb27-10" tabindex="-1"></a>dta <span class="ot">&lt;-</span> <span class="fu">spTransform</span>(dsp, TA)</span>
<span id="cb27-11"><a href="spatial-estimation.html#cb27-11" tabindex="-1"></a>cata <span class="ot">&lt;-</span> <span class="fu">spTransform</span>(spdf, TA)</span></code></pre></div>
<p><strong>Step 2: Create polygons throughout the study area where interpolation is to be done and rasterize the polygons</strong></p>
<div class="sourceCode" id="cb28"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb28-1"><a href="spatial-estimation.html#cb28-1" tabindex="-1"></a><span class="co">#fig_cap &lt;- paste0(&quot;An intermediate step in creating polygon and rasterizing it over the entire Fort Saint Johns TSA. Nepal, CC-BY-SA-4.0.&quot;)</span></span>
<span id="cb28-2"><a href="spatial-estimation.html#cb28-2" tabindex="-1"></a><span class="co">#v &lt;- voronoi(dta)</span></span>
<span id="cb28-3"><a href="spatial-estimation.html#cb28-3" tabindex="-1"></a><span class="co">#plot(v)</span></span>
<span id="cb28-4"><a href="spatial-estimation.html#cb28-4" tabindex="-1"></a><span class="do">### FUNCTION BELOW CRASHES R, COMMENTING OUT FOR NOW</span></span>
<span id="cb28-5"><a href="spatial-estimation.html#cb28-5" tabindex="-1"></a><span class="co">#vca &lt;- intersect(v, cata)</span></span>
<span id="cb28-6"><a href="spatial-estimation.html#cb28-6" tabindex="-1"></a><span class="co">#spplot(vca, &#39;baha_L&#39;, col.regions=rev(get_col_regions()))</span></span>
<span id="cb28-7"><a href="spatial-estimation.html#cb28-7" tabindex="-1"></a><span class="do">################### rasterize the data ####################</span></span>
<span id="cb28-8"><a href="spatial-estimation.html#cb28-8" tabindex="-1"></a><span class="co">#r &lt;- raster(cata, res=100)</span></span>
<span id="cb28-9"><a href="spatial-estimation.html#cb28-9" tabindex="-1"></a><span class="co">#vr &lt;- rasterize(vca, r, &#39;baha_L&#39;)</span></span></code></pre></div>
<p>An intermediate step in creating polygon and rasterizing it over the entire Fort Saint Johns TSA.</p>
<p><strong>Step 3: Nearest neighbor with five unsampled points to be interpolated at a time and plot the results</strong></p>
<div class="sourceCode" id="cb29"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb29-1"><a href="spatial-estimation.html#cb29-1" tabindex="-1"></a><span class="do">### COMMENTING BELOW BECAUSE ABOVE CHUNK FAILS</span></span>
<span id="cb29-2"><a href="spatial-estimation.html#cb29-2" tabindex="-1"></a><span class="co">#fig_cap &lt;- paste0(&quot;Predicted basal area over the entire Fort Saint Johns TSA using five nearest neighbor. Nepal, CC-BY-SA-4.0.&quot;)</span></span>
<span id="cb29-3"><a href="spatial-estimation.html#cb29-3" tabindex="-1"></a><span class="do">## gstat package to create semivariogram model, kriging an dinterpolation</span></span>
<span id="cb29-4"><a href="spatial-estimation.html#cb29-4" tabindex="-1"></a><span class="co">#gs &lt;- gstat(formula=baha_L~1, locations=dta, nmax=5, set=list(idp = 0))</span></span>
<span id="cb29-5"><a href="spatial-estimation.html#cb29-5" tabindex="-1"></a><span class="co">#nn &lt;- interpolate(r, gs)</span></span>
<span id="cb29-6"><a href="spatial-estimation.html#cb29-6" tabindex="-1"></a><span class="co">#nnmsk &lt;- mask(nn,vr)</span></span>
<span id="cb29-7"><a href="spatial-estimation.html#cb29-7" tabindex="-1"></a><span class="co">#tm_shape(nnmsk) +</span></span>
<span id="cb29-8"><a href="spatial-estimation.html#cb29-8" tabindex="-1"></a><span class="co">#  tm_raster(n=8,palette = &quot;RdBu&quot;, auto.palette.mapping = FALSE,title=&quot;Predicted basal area&quot;) +</span></span>
<span id="cb29-9"><a href="spatial-estimation.html#cb29-9" tabindex="-1"></a><span class="co">#  tm_legend(legend.outside=FALSE)</span></span></code></pre></div>
<p>Predicted basal area over the entire Fort Saint Johns TSA using five nearest neighbor.</p>
<p><strong>Step 4: Leaflet map for some interactions</strong></p>
<p>Predicted basal area over the entire Fort Saint Johns TSA using five nearest neighbor projected over the province of British Columbia.</p>
</div>
<div id="thiessian-polygon" class="section level2 hasAnchor" number="9.28">
<h2><span class="header-section-number">9.28</span> Thiessian Polygon<a href="spatial-estimation.html#thiessian-polygon" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>In this method, the domain is determined into the area/polygons of regions containing one sampling point from the original data <span class="citation">(<a href="#ref-coulston_effect_nodate">Coulston and Reams, n.d.</a>)</span>.The thiessen polygons are assigned with the same values of the variable of interest as the point sampled <span class="citation">(<a href="#ref-yamada_thiessen_2016">Yamada 2016</a>)</span>.</p>
<p><strong>Step 1: Match the projection of the Shape file and the plot data</strong></p>
<div class="sourceCode" id="cb30"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb30-1"><a href="spatial-estimation.html#cb30-1" tabindex="-1"></a><span class="co"># project the plot data based to UTM zone 10 and NAD83</span></span>
<span id="cb30-2"><a href="spatial-estimation.html#cb30-2" tabindex="-1"></a>dsp <span class="ot">&lt;-</span> <span class="fu">SpatialPoints</span>(plot1[,<span class="dv">14</span><span class="sc">:</span><span class="dv">15</span>], <span class="at">proj4string=</span><span class="fu">CRS</span>(<span class="st">&quot;+proj=utm +zone=10 +ellps=GRS80 +datum=NAD83&quot;</span>))</span>
<span id="cb30-3"><a href="spatial-estimation.html#cb30-3" tabindex="-1"></a><span class="co"># convert the data into spatial object</span></span>
<span id="cb30-4"><a href="spatial-estimation.html#cb30-4" tabindex="-1"></a>dsp <span class="ot">&lt;-</span> <span class="fu">SpatialPointsDataFrame</span>(dsp, plot1)</span>
<span id="cb30-5"><a href="spatial-estimation.html#cb30-5" tabindex="-1"></a><span class="do">## change the projection of both shape file and plot data</span></span>
<span id="cb30-6"><a href="spatial-estimation.html#cb30-6" tabindex="-1"></a>TA <span class="ot">&lt;-</span> <span class="fu">CRS</span>(<span class="st">&quot;+proj=utm +zone=10 +ellps=GRS80 +datum=NAD83&quot;</span>)</span>
<span id="cb30-7"><a href="spatial-estimation.html#cb30-7" tabindex="-1"></a><span class="fu">library</span>(rgdal)</span>
<span id="cb30-8"><a href="spatial-estimation.html#cb30-8" tabindex="-1"></a>dta <span class="ot">&lt;-</span> <span class="fu">spTransform</span>(dsp, TA)</span>
<span id="cb30-9"><a href="spatial-estimation.html#cb30-9" tabindex="-1"></a>cata <span class="ot">&lt;-</span> <span class="fu">spTransform</span>(spdf, TA)</span></code></pre></div>
<p>Step 2: Create the thiessian polygon around the sample points for entire TSA using</p>
<div class="sourceCode" id="cb31"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb31-1"><a href="spatial-estimation.html#cb31-1" tabindex="-1"></a><span class="co">#&quot;dirichlet&quot; function from &quot;spatstat&quot; package</span></span>
<span id="cb31-2"><a href="spatial-estimation.html#cb31-2" tabindex="-1"></a><span class="co"># Create a tessellated surface</span></span>
<span id="cb31-3"><a href="spatial-estimation.html#cb31-3" tabindex="-1"></a>th  <span class="ot">&lt;-</span>  <span class="fu">as</span>(<span class="fu">dirichlet</span>(<span class="fu">as.ppp</span>(dta)), <span class="st">&quot;SpatialPolygons&quot;</span>)</span>
<span id="cb31-4"><a href="spatial-estimation.html#cb31-4" tabindex="-1"></a></span>
<span id="cb31-5"><a href="spatial-estimation.html#cb31-5" tabindex="-1"></a><span class="co"># The dirichlet function does not carry over projection information</span></span>
<span id="cb31-6"><a href="spatial-estimation.html#cb31-6" tabindex="-1"></a><span class="co"># requiring that this information be added manually to the thiessian polygons</span></span>
<span id="cb31-7"><a href="spatial-estimation.html#cb31-7" tabindex="-1"></a><span class="fu">proj4string</span>(th) <span class="ot">&lt;-</span> <span class="fu">proj4string</span>(dta)</span></code></pre></div>
<p>Step 3: The tessellated surface does not store attribute information from the point data layer. Hence, the information from the data layer should be carried over to tessellated surface</p>
<div class="sourceCode" id="cb32"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb32-1"><a href="spatial-estimation.html#cb32-1" tabindex="-1"></a><span class="co">#We&#39;ll use the over() function from the &quot;sp&quot; package to join the point attributes to the thiessian polygon via spatial join</span></span>
<span id="cb32-2"><a href="spatial-estimation.html#cb32-2" tabindex="-1"></a>th.z     <span class="ot">&lt;-</span> <span class="fu">over</span>(th,dta, <span class="at">fn=</span>mean)</span>
<span id="cb32-3"><a href="spatial-estimation.html#cb32-3" tabindex="-1"></a>th.spdf  <span class="ot">&lt;-</span>  <span class="fu">SpatialPolygonsDataFrame</span>(th, th.z)</span>
<span id="cb32-4"><a href="spatial-estimation.html#cb32-4" tabindex="-1"></a></span>
<span id="cb32-5"><a href="spatial-estimation.html#cb32-5" tabindex="-1"></a><span class="co"># Finally, we&#39;ll clip the tessellated  surface to the Texas boundaries</span></span>
<span id="cb32-6"><a href="spatial-estimation.html#cb32-6" tabindex="-1"></a>th.clp   <span class="ot">&lt;-</span> raster<span class="sc">::</span><span class="fu">intersect</span>(cata,th.spdf)</span></code></pre></div>
<p>Step 4: Visualize the results</p>
<div class="sourceCode" id="cb33"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb33-1"><a href="spatial-estimation.html#cb33-1" tabindex="-1"></a>fig_cap <span class="ot">&lt;-</span> <span class="fu">paste0</span>(<span class="st">&quot;Predicted basal area over the entire Fort Saint Johns TSA using thiessan polygons. Nepal, CC-BY-SA-4.0.&quot;</span>)</span>
<span id="cb33-2"><a href="spatial-estimation.html#cb33-2" tabindex="-1"></a><span class="co"># Map the data</span></span>
<span id="cb33-3"><a href="spatial-estimation.html#cb33-3" tabindex="-1"></a><span class="co">#using package &quot;tmap&quot;</span></span>
<span id="cb33-4"><a href="spatial-estimation.html#cb33-4" tabindex="-1"></a><span class="fu">tm_shape</span>(th.clp) <span class="sc">+</span></span>
<span id="cb33-5"><a href="spatial-estimation.html#cb33-5" tabindex="-1"></a>  <span class="fu">tm_polygons</span>(<span class="at">col=</span><span class="st">&quot;baha_L&quot;</span>, <span class="at">palette=</span><span class="st">&quot;RdBu&quot;</span>, <span class="at">auto.palette.mapping =</span> <span class="cn">FALSE</span>,<span class="at">title=</span><span class="st">&quot;Predicted basal area&quot;</span>) <span class="sc">+</span></span>
<span id="cb33-6"><a href="spatial-estimation.html#cb33-6" tabindex="-1"></a>  <span class="fu">tm_legend</span>(<span class="at">legend.outside=</span><span class="cn">FALSE</span>)</span></code></pre></div>
<div class="figure"><span style="display:block;" id="fig:10-nearest-neighbor-8"></span>
<img src="geomatics-for-environmental-management-_files/figure-html/10-nearest-neighbor-8-1.png" alt="Predicted basal area over the entire Fort Saint Johns TSA using thiessan polygons. Nepal, CC-BY-SA-4.0." width="672" />
<p class="caption">
Figure 9.16: Predicted basal area over the entire Fort Saint Johns TSA using thiessan polygons. Nepal, CC-BY-SA-4.0.
</p>
</div>
<p><strong>Inverse Distance Weighting</strong></p>
<p>*<strong>Inverse distance weighting (IWD)</strong> <span class="citation">(<a href="#ref-shepard_two-_1968">Shepard 1968</a>)</span> estimates the variable of interest by assigning more weight to closer points using the weighting function (w) based on the weighting exponent know as power (p) <span class="citation">(<a href="#ref-babak_statistical_2009">Babak and Deutsch 2009</a>)</span>. The influence of one data point on the other decreases as the distance increases. Hence, higher power of the exponent will result in point of interest having less effect on the points far from it <span class="citation">(<a href="#ref-babak_statistical_2009">Babak and Deutsch 2009</a>)</span>. It is a simple technique that does not require prior information to be applied to spatial prediction <span class="citation">(<a href="#ref-shepard_two-_1968">Shepard 1968</a>)</span>. Lower value of exponents mean more averaging, and the weights are more evenly distributed among the surrounding data points <span class="citation">(<a href="#ref-shepard_two-_1968">Shepard 1968</a>)</span>.</p>
<p><strong>Step 1: Fix the projections between data points and shape file</strong></p>
<div class="sourceCode" id="cb34"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb34-1"><a href="spatial-estimation.html#cb34-1" tabindex="-1"></a><span class="co"># project the data based on the colorado plateau boundry projection</span></span>
<span id="cb34-2"><a href="spatial-estimation.html#cb34-2" tabindex="-1"></a></span>
<span id="cb34-3"><a href="spatial-estimation.html#cb34-3" tabindex="-1"></a>dsp <span class="ot">&lt;-</span> <span class="fu">SpatialPoints</span>(plot1[,<span class="dv">14</span><span class="sc">:</span><span class="dv">15</span>], <span class="at">proj4string=</span><span class="fu">CRS</span>(<span class="st">&quot;+proj=utm +zone=10 +ellps=GRS80 +datum=NAD83&quot;</span>))</span>
<span id="cb34-4"><a href="spatial-estimation.html#cb34-4" tabindex="-1"></a><span class="co"># convert the data into spatial object</span></span>
<span id="cb34-5"><a href="spatial-estimation.html#cb34-5" tabindex="-1"></a>dsp <span class="ot">&lt;-</span> <span class="fu">SpatialPointsDataFrame</span>(dsp, plot1)</span>
<span id="cb34-6"><a href="spatial-estimation.html#cb34-6" tabindex="-1"></a></span>
<span id="cb34-7"><a href="spatial-estimation.html#cb34-7" tabindex="-1"></a>TA <span class="ot">&lt;-</span> <span class="fu">CRS</span>(<span class="st">&quot;+proj=utm +zone=10 +ellps=GRS80 +datum=NAD83&quot;</span>)</span>
<span id="cb34-8"><a href="spatial-estimation.html#cb34-8" tabindex="-1"></a><span class="fu">library</span>(rgdal)</span>
<span id="cb34-9"><a href="spatial-estimation.html#cb34-9" tabindex="-1"></a>dta <span class="ot">&lt;-</span> <span class="fu">spTransform</span>(dsp, TA)</span>
<span id="cb34-10"><a href="spatial-estimation.html#cb34-10" tabindex="-1"></a>cata <span class="ot">&lt;-</span> <span class="fu">spTransform</span>(spdf, TA)</span></code></pre></div>
<p><strong>Step 2: Create empty grid or over-lay empty grid over the study area</strong></p>
<p>An empty grid over Fort Saint Johns TSA is created, where n is the total number of cells over which interpolation is to be done.</p>
<div class="sourceCode" id="cb35"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb35-1"><a href="spatial-estimation.html#cb35-1" tabindex="-1"></a>grd              <span class="ot">&lt;-</span> <span class="fu">as.data.frame</span>(<span class="fu">spsample</span>(dta, <span class="st">&quot;regular&quot;</span>, <span class="at">n=</span><span class="dv">5000</span>))</span>
<span id="cb35-2"><a href="spatial-estimation.html#cb35-2" tabindex="-1"></a><span class="fu">names</span>(grd)       <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">&quot;X&quot;</span>, <span class="st">&quot;Y&quot;</span>)</span>
<span id="cb35-3"><a href="spatial-estimation.html#cb35-3" tabindex="-1"></a><span class="fu">coordinates</span>(grd) <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">&quot;X&quot;</span>, <span class="st">&quot;Y&quot;</span>)</span>
<span id="cb35-4"><a href="spatial-estimation.html#cb35-4" tabindex="-1"></a><span class="fu">gridded</span>(grd)     <span class="ot">&lt;-</span> <span class="cn">TRUE</span>  <span class="co"># Create SpatialPixel object</span></span>
<span id="cb35-5"><a href="spatial-estimation.html#cb35-5" tabindex="-1"></a><span class="fu">fullgrid</span>(grd)    <span class="ot">&lt;-</span> <span class="cn">TRUE</span>  <span class="co"># Create SpatialGrid object</span></span>
<span id="cb35-6"><a href="spatial-estimation.html#cb35-6" tabindex="-1"></a></span>
<span id="cb35-7"><a href="spatial-estimation.html#cb35-7" tabindex="-1"></a><span class="co"># Add P&#39;s projection information to the empty grid</span></span>
<span id="cb35-8"><a href="spatial-estimation.html#cb35-8" tabindex="-1"></a><span class="fu">proj4string</span>(dta) <span class="ot">&lt;-</span> <span class="fu">proj4string</span>(dta) <span class="co"># Temp fix until new proj env is adopted</span></span>
<span id="cb35-9"><a href="spatial-estimation.html#cb35-9" tabindex="-1"></a><span class="fu">proj4string</span>(grd) <span class="ot">&lt;-</span> <span class="fu">proj4string</span>(dta)</span></code></pre></div>
<p><strong>Step 3: Interpolate the grid cells using a power value of 2</strong></p>
<p>Power values can be adjusted depending on characteristics of variable being interpolated</p>
<div class="sourceCode" id="cb36"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb36-1"><a href="spatial-estimation.html#cb36-1" tabindex="-1"></a>P.idw <span class="ot">&lt;-</span> gstat<span class="sc">::</span><span class="fu">idw</span>(baha_L <span class="sc">~</span> <span class="dv">1</span>, dta, <span class="at">newdata=</span>grd, <span class="at">idp=</span><span class="fl">2.0</span>)</span></code></pre></div>
<pre><code>## [inverse distance weighted interpolation]</code></pre>
<div class="sourceCode" id="cb38"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb38-1"><a href="spatial-estimation.html#cb38-1" tabindex="-1"></a><span class="co"># Convert to raster object then clip to Texas</span></span>
<span id="cb38-2"><a href="spatial-estimation.html#cb38-2" tabindex="-1"></a>r       <span class="ot">&lt;-</span> <span class="fu">raster</span>(P.idw)</span>
<span id="cb38-3"><a href="spatial-estimation.html#cb38-3" tabindex="-1"></a>r.m     <span class="ot">&lt;-</span> <span class="fu">mask</span>(r, cata)</span></code></pre></div>
<p><strong>Step 4: Plot the results from inverse distance weighting interpolation using</strong></p>
<div class="sourceCode" id="cb39"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb39-1"><a href="spatial-estimation.html#cb39-1" tabindex="-1"></a>fig_cap <span class="ot">&lt;-</span> <span class="fu">paste0</span>(<span class="st">&quot;Predicted basal area over the entire Fort Saint Johns TSA using inverse distance weighting. Nepal, CC-BY-SA-4.0.&quot;</span>)</span>
<span id="cb39-2"><a href="spatial-estimation.html#cb39-2" tabindex="-1"></a><span class="fu">tm_shape</span>(r.m) <span class="sc">+</span> </span>
<span id="cb39-3"><a href="spatial-estimation.html#cb39-3" tabindex="-1"></a>  <span class="fu">tm_raster</span>(<span class="at">n=</span><span class="dv">8</span>,<span class="at">palette =</span> <span class="st">&quot;RdBu&quot;</span>, <span class="at">auto.palette.mapping =</span> <span class="cn">FALSE</span>,</span>
<span id="cb39-4"><a href="spatial-estimation.html#cb39-4" tabindex="-1"></a>            <span class="at">title=</span><span class="st">&quot;Predicted basal area&quot;</span>) <span class="sc">+</span> </span>
<span id="cb39-5"><a href="spatial-estimation.html#cb39-5" tabindex="-1"></a>  <span class="fu">tm_shape</span>(dta) <span class="sc">+</span> <span class="fu">tm_dots</span>(<span class="at">size=</span><span class="fl">0.2</span>) <span class="sc">+</span></span>
<span id="cb39-6"><a href="spatial-estimation.html#cb39-6" tabindex="-1"></a>  <span class="fu">tm_legend</span>(<span class="at">legend.outside=</span><span class="cn">FALSE</span>)</span></code></pre></div>
<div class="figure"><span style="display:block;" id="fig:10-idw-4"></span>
<img src="geomatics-for-environmental-management-_files/figure-html/10-idw-4-1.png" alt="Predicted basal area over the entire Fort Saint Johns TSA using inverse distance weighting. Nepal, CC-BY-SA-4.0." width="672" />
<p class="caption">
Figure 9.17: Predicted basal area over the entire Fort Saint Johns TSA using inverse distance weighting. Nepal, CC-BY-SA-4.0.
</p>
</div>
<p>Predicted basal area over the entire Fort Saint Johns TSA using inverse distance weighting.</p>
<p><strong>Step 5: Leaflet map for some interaction</strong></p>
<div class="figure"><span style="display:block;" id="fig:10-idw-5"></span>
<div class="leaflet html-widget html-fill-item-overflow-hidden html-fill-item" id="htmlwidget-9604d4c68bc5b2ba82c0" style="width:672px;height:480px;"></div>
<script type="application/json" data-for="htmlwidget-9604d4c68bc5b2ba82c0">{"x":{"options":{"crs":{"crsClass":"L.CRS.EPSG3857","code":null,"proj4def":null,"projectedBounds":null,"options":{}}},"calls":[{"method":"addTiles","args":["https://{s}.tile.openstreetmap.org/{z}/{x}/{y}.png",null,null,{"minZoom":0,"maxZoom":18,"tileSize":256,"subdomains":"abc","errorTileUrl":"","tms":false,"noWrap":false,"zoomOffset":0,"zoomReverse":false,"opacity":1,"zIndex":1,"detectRetina":false,"attribution":"&copy; <a href=\"https://openstreetmap.org\">OpenStreetMap<\/a> contributors, <a href=\"https://creativecommons.org/licenses/by-sa/2.0/\">CC-BY-SA<\/a>"}]},{"method":"addRasterImage","args":["data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAEcAAABGCAYAAACe7Im6AAAWsElEQVR4nM2cS6wty3nXf19Vdfdaa++zzz3nnnuvrx/BQVieMbAn8SACZDGACRLiEaSAFIglY8VCsjACS8hPJZGJLF4yD4MEGGFQBhEDlIyIgEgwQIkyQDykYAd8r499H+fss/d6dXfVl8FX1V299j6JfXOvdVpae69XV1f963v8v39VL1FVnrVDv/FJhbpfApIfDvuPlG9DUuTP/T252dLv75BnDRz9t59Uw+X7AEfy11QhJRgjOozQj/Y6eOgapG2gCfbae/AutyXIH//SU0EN7+hIf8Bjspgy4PkTcC6DIbPRwPxcBLxD1KMidr5zSAgzIM6BkwkYA/npx7NnOd/4GUVBY8oAKYggLg+uzLoUkLL51BaU8picGDDBnQC0BEn+2OdvRemZAwcg/au/aqONmi0gW8VtFlAfxR0Vw0xkBrScU4PjBCQ/h6k9+fG/LWAe/Mwd7i/9IzFLSLMlPG0OJyuSefC+shRfAVlbnFTAFBBlCfgzFXMWR0xMQbdOTpw8h3lAUn1hAqAK3qfnZTDVLbNfefZMgpO+/gml8dlicmBduNItllAA+N2OYo06n6vF5coX9Bm2nPT1T+g0WCcZBzlxjdOzZGk1xQd1Bpcc20nRQJcWdZ2leHEUvlRnyWcKnPQvP65kE5dFbLgFmOlzblqOMg9UFZwax3EYBzr0BtjzHdJsQBOaRpDMj8olftjZavw7P6HiHIQq+3gHbZ6n7D5yWwAtQfOpAZY5pccIQ4RhtO9v1rBqYRxhiOi7X8A9+CCkAT0+gXGPpsEsC8V9+NPyQwNn/PJPaBpG4yzB4YIBIzVrDTMPkRqAUzBugCMzc1Zs9ocR3R/hcosmxb38PLz8PNq1SLNG7n0Azl6G7UN0+xCGLRp70GhxiR+CW6V//FOqxwFVzZxOISYS4FQnSoKTHAtgJipPOeqPa7cqgVWNOJKUtD0S+4H2PQ/g3ntw7TmMR+i3kP4/9NcQ+wmQEuzdh/66vKPgpH/yl7VOsyKgSdFR0TGhweGUzIBTJmM5Y9QA3Ki18suaBDqxuFLeiwnpGtz9cyNzL91H7r4ffAtX30b7S9j36HiwxiQDKwJqz99Zy6k7r5DGROpHKw0A1wZQ8JkBo35ONCiyMKD8pJQUqTKdQvxWHdoG5DjkEkKR5gKagHqPXH0bXIOOO1BFhy2y3aFdC003u2Vu+h0FR85W5veAjpFx1zNcHYiHEeeFcNYZSMECstwW/5Le5PF1ypUczNcden6GW7+IjgfUP0Su90YmnSDbPXr4LSN9Zxvccz9qcef6O7B/jQkVmdt+x8DRf/9ppQmWOoE0RIbLPbtXnnDYHehWHasXE64LhHU7W0nlSqoWgyRRuRwQIzpE6Acb/LpDuhbxK9i8iKQexp19duxhjHC1RR9fw3FA3v0AXT+PdM9B6CCsIA7ZctQAeqfA0V/+W8q6s8H0A+IdmpRx2/P6w9d49PBN3vuBHyHsWnMxwbLTaX2jGYzaclTtnP2R8dE1w9WBsGlpGg8PLpHudUBRTUYHEMtehwF9dM14daBpAjz/qmUmcZDG3HhFB7hpsG8NjF/61MIf9IV76J0NdC3SNNA2+C7g1w1N29KsWpNfVgHfhmU6z2lcbuMw5T1VdBjpnxzYvfqE3XeeoG88QV5/THr826TrV+Gwy4Qum6R3yN0NzUt3kU2HHHp0/ybaX+VsNdojjW9fKtdf+pTpL//mZ1Svdmb+f/gDc4XceFi3hLsbNu9NvLv1vLh9mbBpaO6uaS5WuFVr3wveaiiY3H+qnKfaytiuBI9vA2FjwJMUtgek2c6EstZ1ugZx54bVqrH3B7MYdS5nKzeBKW8HOHStXSR4WLXGeh9f2WA1QROQzQqCp704o/3RdyFdgx6OsLNgTfDQZGC8y6KVznrLJD247ILmpm1K+E2LCw45W+UBDzMg5XDOaijvzQJzypeYUIng1QLblF3t/1sCR//jZxVV5KNfEPycfqUMYIzzRVpzK7ACUs/XcPEALl9HXvkeeuiXg0lZzdP8ns9pPvhZB06KNN4edwwMaRv7rDBk3DxYJyAefB53iW1FObTO3ajRfmBw9D99Xsvs6q9+Tifi5QRCqY9k7kQTjEd0K7OkYUB3j5HtfgZ0alzRGA1cxdI73tprcrpedRkMswTphtnKgl9aTBl0HvMcu1yVFbOVSmbV6FsHZxK6Ic9SVe8U/jGB5a2WOX+AXLwPVEkPfxP5v99GX7+0QrBrZ4A0S6M5/RP8fE3v0CYYyAiqimQOY7MvJ7HpBBCq/5XEKgoqJ0qjvkVwdCFwW8dkGCFmQlLAmfRbb5S9OZ+ygF7tGa8OBOcsZlVZCK9mJWSrKtdDENUsLWQmW9wtVdR/UZwWUE4AWmRCZlasy5ruLVpOjgO+gXFAU8rsVmYlrZhzStBfweW30DQg/QB31nbhxuc0PscAKW2LzOtMxVXGCIejBdPies5NpO3m4KvXnPzPYCk1HkuXDPqrn1VEkD/6OdH/8kUtyvtTj/rCN6RJmTta3h8jerxGxz2M0axss7KsVlS6Ok6oAiWOVVkqAy3DOAG56M/JoG8FpnxGmcObQXgBztSn//wFRQT9tS+qej99wX3kMwKQfv0r6j70KTHJMYtJY4QYzffjiUvlgUpK0CuQVTbNbiNCrbrdOgnTMkoBUG5ffuEWICrg9FYAqtcL4PQ05swRXZ2rWyD99y+rNGdIs0F/8x8qPkAcTRIY40SkGEcLyGXgp1X0lGIxawCLFUXKPOn3NPulYp/cqwSJqhib1qBkGpjheJsFsQy+t7DvGRyFE22g6pRH2jvI6j6IR4crpL9CNc6SwThC02QRO83nVjNnj1wkqZpeUq5ba701OMVCcuzRNl8jJbPUip+o97OWo9WK5206NNxifYVglv7V5UNR6Opg6j3SnCHrF+Du++3tq/+HjkeQAULOXOusgwyjxYPaUkTMEsvCWkxZ6KsELYB00tm5djCJoWuR9blNUNyjxx4ZCz/JltV2iHg0HjNP0iUo3oPkcKHJis7pOx7xjX2uqQKnzNgEUJk9Z192AXUNZqS1T3sktBDW4AKELeqvDaSYCz4hi1AbxK/QcYemLRJdLmOKcBWra0vWg/NstsHO37xo192/YTsp6j6LIC6AhFxhx9kCcx8krI1SqELs0dRnMZ0JIFyTgTEQ3GTS+SGpLMFGSD16vEQuv4lcfhM9XkIaKsQdElbIxY9Yw3X6rDovYY1cvA8JKzh1X8kzOeYAPxWLxmE0eMR5A6uOYzFZUogRxhEdj2Y1qVgvUzviV0j3HLJ5KWs4K0SKpFrGHquKXLLlFOqMK/aNREElonIw4jXurJE4ZMQTiENlgGELb/5v9PrNueNlRpMixx4e/i/S1W8g73nBiF09ITHHiCFauyuzyontgrny4Q0bx7A1rtQPBmYuIElqbq5Yn0vRKs7ErNU9WN2H42MY90yasSroiGoC6aeJEgMnzYGsigMCtmIQEsRcPaecsgFjwwmNA4w53kx7aPLA84YiYjJQdoc5RjEDOLHd03WpifyNaLoCTaYP74/W1rG3761aoxQhTG2IywQvZPqQPcEsP1Z91DkGUfUdCGQlrlbdi0sIeZOV0wkcGW3RS52zVFzEJ+/MABf6LpZFzjaw0aowrGJXqbzLQkgBafqfZYYY7dr9AIcjenmNXm6NTD53ZtfudE75LpcbIqjbwv41y7Sph/FgGbdMYIw5nFi/5Y98VjI4hYaL1TU1ekJVaMpM/lQt8JfYU6fGyWWYs0QZYL2uVGJLCQ9Ol7zGOTR4aFsLluPRONUYrTDdHujfuMa1nqYLVqMVl52kChu0dStZuVOeV+vpMsW7JSk1y5lcKxgIKbuNy4CEXBzmWAPFVFlcZB5sTsNiVqHFAip2LZPmMxuSDahixd4hrrGMmYbl973Dd1liPdVm0jyJrFok11DajJZZJQd4EftuP5qLlo1SEziTnlEGmAedlygkFsQFdUdzgViz3xNrgQX5UpdFqqZBXGOzNhyXa5qF9E2ELFuQYqDouCxPQoDzNSFbmqy6qv7SqUDVwqsaA1GdUQiTYh3qcsHcDxbDVCdhDsDJn/6KLHZAwSwF5IvrcYv229zBapZLmZBK1smPYraFoIVgyya+M0vwYa6Xpq1ny8e06XEcTfqMsfTYqvnNCnnuHLk4M004VMpfiaG1uliD69fI6i7SnFlWSwkt2S/NAwzTIG/oHzmWRLXUiVSbEe0iGjyS8gDqi1PJCE4Q3yHtBfgWHa4tYyw2ClRgOzez6okHVTNS4libJ3GyuJpjuexOzLXe5HZqkxM29jobgpyvs6I4JyUDJ0aMW5S38xVLg6WsqPmJcwZMzMVnYa2lqKyLOJG8eLZBYn9z6XsKoA6ddn6Giu5Hpqo+5Syp1TVOjykJVJOekgXnOMKwM/ceD9ZOE2btehFzAI4DdGVgOvOdAo6cgFP8uu8tmO2PBpK3TdETLcjnG4l7DH5rHYrDcktstjDNLkjoEN8Z3RdvdF+uTVQbY3a9MoE10FPQu+laMPVbZWvcLWUlIfjKEOavBwDdH42kNXMweupRrGWMcBzQ6x16ubXgfXFmSl5ZBcgBXfuj8QpxRsaGEYlx4aJQ4lOHNOdWCzVn9ugvIY2o6yt9uHL9Uw14AqhwqpOyQyK4KkTkUoXoFpY4V+U1M61Tay1bTnWXTpuD9NE122+9Dk44+4N5/Sjv3CqpW8bR1rcxaj8vv+TZr2KOuBbpLnJB20B7DvFQ0X1OXPLkdQFrUcPVL0sDJSM61OcdHcwV+QSOrDtLYb6K+OXwzrSUJljNkRQYpgFqTMR+RLybraZr0bO1nT+MyGj0XGr2XMucpaNJcwfziIat7bgatmg8zNzlxoPf48jXKOpiCAY8gBuq/ki1taVYzsUmb4PPq16FHRerWZ/hNi/ZuvLx1XlgzuHWLWfvu48/65B7d2yPzMUZsnkh0/THM7OdtuyXPhfXKACN6LADeQOGqxwTRqu2+6PFm1KoLoCp25z+zJmMaiKKfNHmpeHhGtWdxbO0tLg5lYeMqHez2edZFd/C+oGtImz3FoQFW9Y9W+Fjwr10D87WZoE5bkz7DWOaAaqAnVw5K4OSZ1BLEVtUuZTJaNaspwK4kNYZlcqFioWSE0wdX0zCQBOqoyWJWw4Dp3ABIafA7Huao/v+CaT/Cf/nt2wx7s7a1r/P18i9O8iDIS/e5zaOe1S+i8ajVdHDaBmxz1pQuVnDOQMmaQ6QySp86ec0XYJl0V4KoautcBF35Wb2qrNsLFpV7ksaIWWXv3UfcjHPmEDLSfniMSJ9D7vXSK+8ho7JdkUAXJwhL30Q4hF9/bdtTUlBdgfbl5PSDMqxn9bFpQ126bp4TWJZpIypdLQN6L0L6Drkemv9KxZUjhs3eFRpnhqYiPQD6rNoh6LD3iawLBDcCk7CyJakeYaK1jHaDim5s5n9vmwAWD8Ajej2oTHpMRrdH4aZD5VzihYUNSsAmWDWSaCk2zEapXcC9y5M5N/uzAr7upwopQ9A+X+ScctkD9a29AO4reF4m8BfgyN/8udF/8PfrMJ+BU4lWOEdxIRe7dDrHW7ToXf+h0X+4zBpI4uAWQKoWE00zfQUT2pgmK6n/YBe7+m/d0W3O8IfOtiE7A62z3BM4MU2RzUegtyewsvrpDb5JXYVVaAJdr7zVQlVWw7M5f4kc6Z5tseIjnPD6ThYxfvoCmlfsc0AMS1rrAJQ4UaCCVOlv6eSxzTDeVtbtrI0RobXntB030WaYNzqakfqI27dwjm2Zc5n7XfStzmxyAzKYUC3O/RqD05w9y8skYQq3d8KTvHRE6vRsniXdV7XBrt4THC1M6txVclRg3MLLZ9XDepMY5OiJdaJSRHr9963rDdENCZ0f6R/tGPc93T3zwjrdtluaa5wmkIS85h0GNCrPYeHl4gT1s/fzTKFLtugKjXlT/2CmBvo7B41MP2IHntLs97ZZiGwuHDsDaBhNOspATOexJuU0PoR02wl6QTEMvttQLomF4/mNq7xhFWD7xoreXwW0ut1qpLlitv5E6AEJLi8DaapqvHTgFyO4hLFvNPsWjqMpONgEkbjrRZLCmNCGef7oeo6prRRp9wprM3ETBdr1cwcKGKTVeovAVk1NA/uZJlhA+t2doXFIp6DtrE9PTGakQ6jKYebjtWDOxl0WfKv6liCo2kOitPtg1VaV0hDxNX3V8YiuBsnkTxIrTlJYdxlYk4tpIhe5aazLLxpT67gNd/EmnnRqkMuNnDvws7bHy2DFUWziHS1aOfH6e4cOV+btXhvfekrfekGQ6bq+G21S659XHCgHrdqzBwnpsrEWbTeLzMx2EIVmONYBkjKAIqSJ5gbtBbkdTwwbWvLWpF4cwfd2CZJKfFQ0jyOzKp1qPhLkVg7kIn4lsxZgvhTLUcnC1lYmRPEe7QB1+QY4J1JFjGZqc4IVbIC89VK9hssTae8tc01Hula64oImrKIlhI6jujuiI4J6YLFOW9KoRx6pGztHeLM6GuRbhhMGlGyVFEADkwrm4utcoL8iZ+b4FmAI3/+74t+45N6a3HoHFKCuirse9LuOEsqsLiYbYctVH12MR0Gxt2R4eoIqjR3VgQRxOdzJaJHNU5ztWe4PhD3A2HT4poeV+6RKDGv7Bus+6xpWi43K65mu7DpskZ32yJisQlODvkL/2B5g1rlwxPCSdFxnL8zRnudXUzKzySUjud1bR0jOiZSHxmvj4zbnngcq4yV2XhWF7WfXWK4PnB47Yr+0Q7dZiK4PxqIw3hLtV4IaCGlZcTVomHw1U845Ed1fH97AiUjnpYzJF7QIZH6HudN7pDCgotJZSqg1f3h4h3Nnc7uoAt5PVwzlS/Bqdx21DVoUoarA+O2B4Rw1uKHEe2HXIBXN+MrFj/K3TapmuBJq64I3+kdgdVxw3IA3E9+VcoA3U/9U3F/5WuT18wRS3L2Gs0K9v0ktOuhR3cHe2wPxO0BPebdDzmw+3VLOOtwXchCWW5Wl7PsgsO1Ht81hPMOvypb5iqqUGfW4va3TrKcWE7hQra2ps3SVp5qOe4vfnUJYwHFg/v4v5g+G7/0Z1RyCtcsn1qJI+g4kvbmOn5lbibB4VIAl5CSAUNeDV3URTkONd52398RQmyRxhlDn5aWmZn9lB2X7dyIK9X9FNMy0OL+8t8DnBtg/fTXJH3tp9V97J8vQVPFbxqTSFXNQvo4dcZlwihdY1KFAj7iywYG5/JtASdm7aY/iAg+ZJfxYmm4XtcqIN04Tsjh4ncsnPEg723R0TWzdPqDggPgPvbP5PQ93+VZTGq3KQ6jaT6NJ5x1yPkaWXc2oKzySQmg0xgqhlyzaOcQSilQZZtqhXZx/3lNVMrTAnr1CygLa/GNbaoK67y5qhrvDwLObUf4G//OYqIqqR/pH+3YvfKY/XefkPrRwHnfi+gfeBc8f9cUxHIfeRvy3SzVjJ4w5kVWaUKWcqsAXAfaKRzK8lHFGZ1+MsaBDyYBhzXS3YX184uxve33lT/6+Ef18NoWnPDyL/7XydLSf/tZlSc7uLxG/uzflfSvP6GLhcMSN6p/twbWE1qx+NkYXwHqyg398+/naPALC0KCbdvr7sL6Bdv99cKHbyeBb9dhd+Utm3Y/9pmFS5bfp9By+0+dpYprnS4TnVhGyar6i39t/v2L4l41PxPJ2+AKeAFwyLTPUMAF1LfLJbtn8ceF3o5Df+UzOllN8OZO2ZKk2WQelsx62jvmUt1z8K6PTPj8DqbOC0on2BA+AAAAAElFTkSuQmCC",[[58.29784649218971,-123.8906598934373],[56.18722149467096,-119.8937661150344]],0.5,null,null,null]},{"method":"addLegend","args":[{"colors":["#FEF0D9 , #FFDDB0 13.0044359660043%, #FEC382 28.8521447729482%, #FD9B63 44.699853579892%, #F27249 60.5475623868358%, #E04730 76.3952711937796%, #C22111 92.2429800007235%, #B30000 "],"labels":["10","20","30","40","50","60"],"na_color":null,"na_label":"NA","opacity":0.5,"position":"topright","type":"numeric","title":"Predicted basal area","extra":{"p_1":0.1300443596600432,"p_n":0.9224298000072347},"layerId":null,"className":"info legend","group":null}]}],"limits":{"lat":[56.18722149467096,58.29784649218971],"lng":[-123.8906598934373,-119.8937661150344]}},"evals":[],"jsHooks":[]}</script>
<p class="caption">
Figure 9.18: Predicted basal area over the entire Fort Saint Johns TSA using inverse distance weighting projected over the province of Brithish Columbia. Nepal, CC-BY-SA-4.0.
</p>
</div>
<p><strong>Figure 10.23.</strong> <span class="math inline">\(\ref{fig:figs}\)</span> Predicted basal area over the entire Fort Saint Johns TSA using inverse distance weighting projected over the province of British Columbia.</p>
</div>
<div id="methods-using-semi-variogram" class="section level2 hasAnchor" number="9.29">
<h2><span class="header-section-number">9.29</span> Methods Using Semi-variogram<a href="spatial-estimation.html#methods-using-semi-variogram" class="anchor-section" aria-label="Anchor link to header"></a></h2>
</div>
<div id="kriging" class="section level2 hasAnchor" number="9.30">
<h2><span class="header-section-number">9.30</span> Kriging<a href="spatial-estimation.html#kriging" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>The spatial interpolation technique such as inverse distance weighting(IWD), nearest neighbor, and polygon approach are based on the surrounding neighborhood. There is another group of interpolation methods generally know as <strong>kriging</strong> <span class="citation">(<a href="#ref-krige_statistical_1951">Krige 1951</a>)</span> which is based on both surrounding neighborhood and statistical models, especially <strong>spatial autocorrelation</strong>. Kriging uses the variogram modeling approach we studied in section <strong>10.3</strong> as a statistical model and incorporates the information about <strong>spatial autocorrelation</strong> while performing the interpolation. Since kriging uses the geostatistical model it has capacity of both prediction and provides some measure of the accuracy of prediction <span class="citation">(<a href="#ref-goovaerts_kriging_2008">Goovaerts 2008</a>)</span>.The basic assumption of kriging is that the distance based samples reflect some degree of spatial correlation <span class="citation">(<a href="#ref-goovaerts_kriging_2008">Goovaerts 2008</a>)</span>. We should note one thing that kriging works with raster surfaces where variable of interest are to be interpolated using the sampled locations. Kriging works with the following basic mathematical model:
<span class="math display">\[\hat{Z_{s_0}}=\sum_{i}^N \lambda_{i}Z_{s_i}\]</span></p>
<p>Where, <span class="math display">\[\hat{Z_{s_o}}=\text{variable of interest to predicted at unsampled loaction}\ s_0 \]</span>
<span class="math display">\[ \lambda=\text{an unknown value of weight at the measured } s_{i} location\]</span>
<span class="math display">\[Z_{s_i}=\text{measured value at the sampled location} \ s_i\]</span></p>
<p>The goal of kriging is to determine the weights <span class="math display">\[\lambda_i\]</span> that will minimize the variance estimator of the predicted value and actual value at the unsampled location:
<span class="math display">\[ Var|\hat{Z}_{s_o}-Z_{s_o}|\]</span>
The <span class="math display">\[\hat{Z}_{s_0}\]</span> is decomposed into a trend component <span class="math display">\[\mu_{s_o}\]</span>, which is the mean function as seen in the following equation:
<span class="math display">\[\hat{Z}_{s_o} = \mu_{s_o} + \epsilon_{s_o}\]</span>
Where,<br />
<span class="math display">\[\epsilon_{s_o} = \text{spatially autocorrelated erros}\]</span></p>
<div id="linear-kriging" class="section level3 hasAnchor" number="9.30.1">
<h3><span class="header-section-number">9.30.1</span> Linear Kriging<a href="spatial-estimation.html#linear-kriging" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>Linear kriging are distribution free linear interpolation techniques that are in alignment with linear regression methods <span class="citation">(<a href="#ref-asa_comparison_2012">Asa et al. 2012</a>)</span>. There are three principle linear kriging techniques as discussed below:</p>
</div>
</div>
<div id="case-study-4" class="section level2 hasAnchor" number="9.31">
<h2><span class="header-section-number">9.31</span> Case Study 4<a href="spatial-estimation.html#case-study-4" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>For this case study, we will use ground plot data from Young stand monitoring (YSM) program data <span class="citation">(<a href="#ref-province_of_bc_provincial_2018">Province of BC 2018</a>)</span> for Fort Saint Johns timber supply area (TSA) in the province of British Columbia, Canada. Fort Saint Johns is divided into 6 blocks respectively Figure <a href="spatial-estimation.html#fig:10-FSJ-plot">9.6</a>. There are a total of 108 YSM plots used in this study Figure <a href="spatial-estimation.html#fig:10-FSJ-plot">9.6</a>. The total basal area (m2/ha) is our variable of interest in this study. For each of the YSM plot the total basal area was calculated by adding the basal area for all trees within the plot. We will use this dataset to explore different interpolation technique to find the variable of interest (basal area) in the unsampled locations.</p>
</div>
<div id="simple-kriging" class="section level2 hasAnchor" number="9.32">
<h2><span class="header-section-number">9.32</span> Simple Kriging<a href="spatial-estimation.html#simple-kriging" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>Simple kriging works with the assumption that the mean is known and constant over entire domain and calculated as the average of the data <span class="citation">(<a href="#ref-wackernagel_multivariate_2002">Wackernagel 2002</a>)</span>. The number of sampled points used to make the prediction of the variable of interest in unmeasured location depends upon the range of semivariogram model used <span class="citation">(<a href="#ref-burrough_principles_1998">Burrough and McDonnell 1998</a>)</span>.</p>
<p><span class="math display">\[\hat{Z}_{s_o}=\mu_{s_o} + \epsilon_{s_o}\]</span>
Where, <span class="math display">\[\hat{Z}_{s_o}=\text{variable of interest predicted at a given saptial location}\ s_{o}\]</span>
<span class="math display">\[\mu_{s_o}=\text{an known constant mean} \]</span></p>
<p>Step 1: Make sure the projection of the point data and shape file is same</p>
<div class="sourceCode" id="cb40"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb40-1"><a href="spatial-estimation.html#cb40-1" tabindex="-1"></a><span class="co"># summarize the data to individual plots</span></span>
<span id="cb40-2"><a href="spatial-estimation.html#cb40-2" tabindex="-1"></a>data<span class="ot">&lt;-</span>plot1 <span class="sc">%&gt;%</span> </span>
<span id="cb40-3"><a href="spatial-estimation.html#cb40-3" tabindex="-1"></a>  <span class="fu">group_by</span>(utm_eastin,utm_northi) <span class="sc">%&gt;%</span></span>
<span id="cb40-4"><a href="spatial-estimation.html#cb40-4" tabindex="-1"></a>  <span class="fu">summarise</span>(<span class="at">total=</span> <span class="fu">sum</span>(baha_L))</span>
<span id="cb40-5"><a href="spatial-estimation.html#cb40-5" tabindex="-1"></a><span class="co"># convert the data to saptial point data frame and change the projection to NAD83</span></span>
<span id="cb40-6"><a href="spatial-estimation.html#cb40-6" tabindex="-1"></a>dsp <span class="ot">&lt;-</span> <span class="fu">SpatialPoints</span>(data[,<span class="dv">1</span><span class="sc">:</span><span class="dv">2</span>], <span class="at">proj4string=</span><span class="fu">CRS</span>(<span class="st">&quot;+proj=utm +zone=10 +ellps=GRS80 +datum=NAD83&quot;</span>))</span>
<span id="cb40-7"><a href="spatial-estimation.html#cb40-7" tabindex="-1"></a>dsp <span class="ot">&lt;-</span> <span class="fu">SpatialPointsDataFrame</span>(dsp, data)</span>
<span id="cb40-8"><a href="spatial-estimation.html#cb40-8" tabindex="-1"></a></span>
<span id="cb40-9"><a href="spatial-estimation.html#cb40-9" tabindex="-1"></a><span class="co"># Make the projection similar for plot and polygon data</span></span>
<span id="cb40-10"><a href="spatial-estimation.html#cb40-10" tabindex="-1"></a>TA <span class="ot">&lt;-</span> <span class="fu">CRS</span>(<span class="st">&quot;+proj=utm +zone=10 +ellps=GRS80 +datum=NAD83&quot;</span>)</span>
<span id="cb40-11"><a href="spatial-estimation.html#cb40-11" tabindex="-1"></a>dta <span class="ot">&lt;-</span> <span class="fu">spTransform</span>(dsp, TA)</span>
<span id="cb40-12"><a href="spatial-estimation.html#cb40-12" tabindex="-1"></a>cata <span class="ot">&lt;-</span> <span class="fu">spTransform</span>(spdf, TA)</span></code></pre></div>
<p>Step 2: Create an empty grid</p>
<p>A grid with the total number of n cells where basal area is to be predicted is overlaid over Forty Saint Johns. The grid will be a raster</p>
<div class="sourceCode" id="cb41"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb41-1"><a href="spatial-estimation.html#cb41-1" tabindex="-1"></a>grd              <span class="ot">&lt;-</span> <span class="fu">as.data.frame</span>(<span class="fu">spsample</span>(dta, <span class="st">&quot;regular&quot;</span>, <span class="at">n=</span><span class="dv">10000</span>))</span>
<span id="cb41-2"><a href="spatial-estimation.html#cb41-2" tabindex="-1"></a><span class="fu">names</span>(grd)       <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">&quot;X&quot;</span>, <span class="st">&quot;Y&quot;</span>)</span>
<span id="cb41-3"><a href="spatial-estimation.html#cb41-3" tabindex="-1"></a><span class="fu">coordinates</span>(grd) <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">&quot;X&quot;</span>, <span class="st">&quot;Y&quot;</span>)</span>
<span id="cb41-4"><a href="spatial-estimation.html#cb41-4" tabindex="-1"></a><span class="fu">gridded</span>(grd)     <span class="ot">&lt;-</span> <span class="cn">TRUE</span>  <span class="co"># Create SpatialPixel object</span></span>
<span id="cb41-5"><a href="spatial-estimation.html#cb41-5" tabindex="-1"></a><span class="fu">fullgrid</span>(grd)    <span class="ot">&lt;-</span> <span class="cn">TRUE</span>  <span class="co"># Create SpatialGrid object</span></span>
<span id="cb41-6"><a href="spatial-estimation.html#cb41-6" tabindex="-1"></a></span>
<span id="cb41-7"><a href="spatial-estimation.html#cb41-7" tabindex="-1"></a><span class="co"># Add projection information to the empty grid relative to the plot and polygon projection </span></span>
<span id="cb41-8"><a href="spatial-estimation.html#cb41-8" tabindex="-1"></a><span class="fu">proj4string</span>(dta) <span class="ot">&lt;-</span> <span class="fu">proj4string</span>(dta) <span class="co"># Temp fix until new proj env is adopted</span></span>
<span id="cb41-9"><a href="spatial-estimation.html#cb41-9" tabindex="-1"></a><span class="fu">proj4string</span>(grd) <span class="ot">&lt;-</span> <span class="fu">proj4string</span>(dta)</span></code></pre></div>
<p>Step 3: Calculate the overall mean of the variable to be interpolated</p>
<p>Simple kriging, which assumes that mean is a known constant over entire domain need a mean value of variable of interest (basal area)</p>
<div class="sourceCode" id="cb42"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb42-1"><a href="spatial-estimation.html#cb42-1" tabindex="-1"></a>basal<span class="ot">&lt;-</span><span class="fu">mean</span>(data<span class="sc">$</span>total)</span>
<span id="cb42-2"><a href="spatial-estimation.html#cb42-2" tabindex="-1"></a>basal</span></code></pre></div>
<pre><code>## [1] 95.72555</code></pre>
<p>Step 4: Semivariogram modeling</p>
<p>Start by fitting the semivariogram model for the variable of interest (basal area) and see which model best fit the data</p>
<div class="sourceCode" id="cb44"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb44-1"><a href="spatial-estimation.html#cb44-1" tabindex="-1"></a>fig_cap <span class="ot">&lt;-</span> <span class="fu">paste0</span>(<span class="st">&quot;Variogram models fitted for basal area using the YSM plot data. Nepal, CC-BY-SA-4.0.&quot;</span>)</span>
<span id="cb44-2"><a href="spatial-estimation.html#cb44-2" tabindex="-1"></a><span class="do">#### Exponential variogram ###############</span></span>
<span id="cb44-3"><a href="spatial-estimation.html#cb44-3" tabindex="-1"></a>TheVariogram<span class="ot">=</span><span class="fu">variogram</span>(total<span class="sc">~</span><span class="dv">1</span>, <span class="at">data=</span>dta)</span>
<span id="cb44-4"><a href="spatial-estimation.html#cb44-4" tabindex="-1"></a>TheVariogramModel <span class="ot">&lt;-</span> <span class="fu">vgm</span>(<span class="at">psill=</span><span class="dv">2500</span>, <span class="at">model=</span><span class="st">&quot;Exp&quot;</span>, <span class="at">nugget=</span><span class="dv">1500</span>, <span class="at">range=</span><span class="dv">20000</span>)</span>
<span id="cb44-5"><a href="spatial-estimation.html#cb44-5" tabindex="-1"></a>FittedModel <span class="ot">&lt;-</span> <span class="fu">fit.variogram</span>(TheVariogram, <span class="at">model=</span>TheVariogramModel) </span>
<span id="cb44-6"><a href="spatial-estimation.html#cb44-6" tabindex="-1"></a>preds <span class="ot">=</span> <span class="fu">variogramLine</span>(FittedModel, <span class="at">maxdist =</span> <span class="fu">max</span>(TheVariogram<span class="sc">$</span>dist))</span>
<span id="cb44-7"><a href="spatial-estimation.html#cb44-7" tabindex="-1"></a>g<span class="ot">&lt;-</span><span class="fu">ggplot</span>(TheVariogram,<span class="fu">aes</span>(<span class="at">x=</span>dist,<span class="at">y=</span>gamma))<span class="sc">+</span><span class="fu">geom_point</span>()<span class="sc">+</span></span>
<span id="cb44-8"><a href="spatial-estimation.html#cb44-8" tabindex="-1"></a>  <span class="fu">geom_line</span>(<span class="at">data =</span> preds)<span class="sc">+</span> <span class="fu">theme_classic</span>()<span class="sc">+</span> </span>
<span id="cb44-9"><a href="spatial-estimation.html#cb44-9" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">x =</span> <span class="st">&quot;lag distance (h)&quot;</span>, <span class="at">y =</span> <span class="st">&quot;Semi-variance&quot;</span>)<span class="sc">+</span></span>
<span id="cb44-10"><a href="spatial-estimation.html#cb44-10" tabindex="-1"></a>   <span class="fu">theme_bw</span>()<span class="sc">+</span> <span class="fu">ggtitle</span>(<span class="st">&quot;Exponential&quot;</span>)<span class="sc">+</span></span>
<span id="cb44-11"><a href="spatial-estimation.html#cb44-11" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">text =</span> <span class="fu">element_text</span>(<span class="at">size =</span><span class="dv">14</span>))<span class="sc">+</span></span>
<span id="cb44-12"><a href="spatial-estimation.html#cb44-12" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">axis.title.x=</span><span class="fu">element_blank</span>(),</span>
<span id="cb44-13"><a href="spatial-estimation.html#cb44-13" tabindex="-1"></a>        <span class="at">axis.title.y=</span><span class="fu">element_text</span>(<span class="at">size=</span><span class="dv">14</span>),</span>
<span id="cb44-14"><a href="spatial-estimation.html#cb44-14" tabindex="-1"></a>        <span class="at">axis.text.x =</span><span class="fu">element_blank</span>(),</span>
<span id="cb44-15"><a href="spatial-estimation.html#cb44-15" tabindex="-1"></a>        <span class="at">axis.text.y =</span><span class="fu">element_text</span>(<span class="at">size=</span><span class="dv">14</span>))</span>
<span id="cb44-16"><a href="spatial-estimation.html#cb44-16" tabindex="-1"></a></span>
<span id="cb44-17"><a href="spatial-estimation.html#cb44-17" tabindex="-1"></a><span class="do">#### Spherical Variogram</span></span>
<span id="cb44-18"><a href="spatial-estimation.html#cb44-18" tabindex="-1"></a>TheVariogramModel1 <span class="ot">&lt;-</span> <span class="fu">vgm</span>(<span class="at">psill=</span><span class="dv">2500</span>, <span class="at">model=</span><span class="st">&quot;Sph&quot;</span>, <span class="at">nugget=</span><span class="dv">1500</span>, <span class="at">range=</span><span class="dv">20000</span>)</span>
<span id="cb44-19"><a href="spatial-estimation.html#cb44-19" tabindex="-1"></a>FittedModel1 <span class="ot">&lt;-</span> <span class="fu">fit.variogram</span>(TheVariogram, <span class="at">model=</span>TheVariogramModel1) </span>
<span id="cb44-20"><a href="spatial-estimation.html#cb44-20" tabindex="-1"></a>preds1 <span class="ot">=</span> <span class="fu">variogramLine</span>(FittedModel1, <span class="at">maxdist =</span> <span class="fu">max</span>(TheVariogram<span class="sc">$</span>dist))</span>
<span id="cb44-21"><a href="spatial-estimation.html#cb44-21" tabindex="-1"></a>h<span class="ot">&lt;-</span><span class="fu">ggplot</span>(TheVariogram,<span class="fu">aes</span>(<span class="at">x=</span>dist,<span class="at">y=</span>gamma))<span class="sc">+</span><span class="fu">geom_point</span>()<span class="sc">+</span></span>
<span id="cb44-22"><a href="spatial-estimation.html#cb44-22" tabindex="-1"></a>  <span class="fu">geom_line</span>(<span class="at">data =</span> preds1)<span class="sc">+</span> <span class="fu">theme_classic</span>()<span class="sc">+</span> </span>
<span id="cb44-23"><a href="spatial-estimation.html#cb44-23" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">x =</span> <span class="st">&quot;lag distance (h)&quot;</span>, <span class="at">y =</span> <span class="st">&quot;Semi-variance&quot;</span>)<span class="sc">+</span></span>
<span id="cb44-24"><a href="spatial-estimation.html#cb44-24" tabindex="-1"></a>   <span class="fu">theme_bw</span>()<span class="sc">+</span><span class="fu">ggtitle</span>(<span class="st">&quot;Spherical&quot;</span>)<span class="sc">+</span></span>
<span id="cb44-25"><a href="spatial-estimation.html#cb44-25" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">text =</span> <span class="fu">element_text</span>(<span class="at">size =</span><span class="dv">14</span>))<span class="sc">+</span></span>
<span id="cb44-26"><a href="spatial-estimation.html#cb44-26" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">axis.title.x=</span><span class="fu">element_blank</span>(),</span>
<span id="cb44-27"><a href="spatial-estimation.html#cb44-27" tabindex="-1"></a>        <span class="at">axis.title.y=</span><span class="fu">element_blank</span>(),</span>
<span id="cb44-28"><a href="spatial-estimation.html#cb44-28" tabindex="-1"></a>        <span class="at">axis.text.x =</span><span class="fu">element_blank</span>(),</span>
<span id="cb44-29"><a href="spatial-estimation.html#cb44-29" tabindex="-1"></a>        <span class="at">axis.text.y =</span><span class="fu">element_blank</span>(),</span>
<span id="cb44-30"><a href="spatial-estimation.html#cb44-30" tabindex="-1"></a>        <span class="at">axis.ticks.y=</span> <span class="fu">element_blank</span>())</span>
<span id="cb44-31"><a href="spatial-estimation.html#cb44-31" tabindex="-1"></a></span>
<span id="cb44-32"><a href="spatial-estimation.html#cb44-32" tabindex="-1"></a><span class="do">## Gaussian Variogram</span></span>
<span id="cb44-33"><a href="spatial-estimation.html#cb44-33" tabindex="-1"></a>TheVariogramModel2 <span class="ot">&lt;-</span> <span class="fu">vgm</span>(<span class="at">psill=</span><span class="dv">2500</span>, <span class="at">model=</span><span class="st">&quot;Gau&quot;</span>, <span class="at">nugget=</span><span class="dv">1500</span>, <span class="at">range=</span><span class="dv">20000</span>)</span>
<span id="cb44-34"><a href="spatial-estimation.html#cb44-34" tabindex="-1"></a>FittedModel2 <span class="ot">&lt;-</span> <span class="fu">fit.variogram</span>(TheVariogram, <span class="at">model=</span>TheVariogramModel2) </span>
<span id="cb44-35"><a href="spatial-estimation.html#cb44-35" tabindex="-1"></a>preds2 <span class="ot">=</span> <span class="fu">variogramLine</span>(FittedModel2, <span class="at">maxdist =</span> <span class="fu">max</span>(TheVariogram<span class="sc">$</span>dist))</span>
<span id="cb44-36"><a href="spatial-estimation.html#cb44-36" tabindex="-1"></a>i<span class="ot">&lt;-</span><span class="fu">ggplot</span>(TheVariogram,<span class="fu">aes</span>(<span class="at">x=</span>dist,<span class="at">y=</span>gamma))<span class="sc">+</span><span class="fu">geom_point</span>()<span class="sc">+</span></span>
<span id="cb44-37"><a href="spatial-estimation.html#cb44-37" tabindex="-1"></a>  <span class="fu">geom_line</span>(<span class="at">data =</span> preds2)<span class="sc">+</span> <span class="fu">theme_classic</span>()<span class="sc">+</span> </span>
<span id="cb44-38"><a href="spatial-estimation.html#cb44-38" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">x =</span> <span class="st">&quot;lag distance (h)&quot;</span>, <span class="at">y =</span> <span class="st">&quot;Semi-variance&quot;</span>)<span class="sc">+</span></span>
<span id="cb44-39"><a href="spatial-estimation.html#cb44-39" tabindex="-1"></a>   <span class="fu">theme_bw</span>()<span class="sc">+</span><span class="fu">ggtitle</span>(<span class="st">&quot;Gaussian&quot;</span>)<span class="sc">+</span></span>
<span id="cb44-40"><a href="spatial-estimation.html#cb44-40" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">text =</span> <span class="fu">element_text</span>(<span class="at">size =</span><span class="dv">14</span>))<span class="sc">+</span></span>
<span id="cb44-41"><a href="spatial-estimation.html#cb44-41" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">axis.title.x=</span><span class="fu">element_text</span>(<span class="at">size=</span><span class="dv">14</span>),</span>
<span id="cb44-42"><a href="spatial-estimation.html#cb44-42" tabindex="-1"></a>        <span class="at">axis.title.y=</span><span class="fu">element_text</span>(<span class="at">size=</span><span class="dv">14</span>),</span>
<span id="cb44-43"><a href="spatial-estimation.html#cb44-43" tabindex="-1"></a>        <span class="at">axis.text.x =</span><span class="fu">element_text</span>(<span class="at">size =</span><span class="dv">14</span>),</span>
<span id="cb44-44"><a href="spatial-estimation.html#cb44-44" tabindex="-1"></a>        <span class="at">axis.text.y =</span><span class="fu">element_text</span>(<span class="at">size=</span><span class="dv">14</span>))</span>
<span id="cb44-45"><a href="spatial-estimation.html#cb44-45" tabindex="-1"></a></span>
<span id="cb44-46"><a href="spatial-estimation.html#cb44-46" tabindex="-1"></a><span class="do">## circular Variogram</span></span>
<span id="cb44-47"><a href="spatial-estimation.html#cb44-47" tabindex="-1"></a>TheVariogramModel3 <span class="ot">&lt;-</span> <span class="fu">vgm</span>(<span class="at">psill=</span><span class="dv">2500</span>, <span class="at">model=</span><span class="st">&quot;Cir&quot;</span>, <span class="at">nugget=</span><span class="dv">1500</span>, <span class="at">range=</span><span class="dv">20000</span>)</span>
<span id="cb44-48"><a href="spatial-estimation.html#cb44-48" tabindex="-1"></a>FittedModel3 <span class="ot">&lt;-</span> <span class="fu">fit.variogram</span>(TheVariogram, <span class="at">model=</span>TheVariogramModel3) </span>
<span id="cb44-49"><a href="spatial-estimation.html#cb44-49" tabindex="-1"></a>preds3 <span class="ot">=</span> <span class="fu">variogramLine</span>(FittedModel3, <span class="at">maxdist =</span> <span class="fu">max</span>(TheVariogram<span class="sc">$</span>dist))</span>
<span id="cb44-50"><a href="spatial-estimation.html#cb44-50" tabindex="-1"></a>j<span class="ot">&lt;-</span><span class="fu">ggplot</span>(TheVariogram,<span class="fu">aes</span>(<span class="at">x=</span>dist,<span class="at">y=</span>gamma))<span class="sc">+</span><span class="fu">geom_point</span>()<span class="sc">+</span></span>
<span id="cb44-51"><a href="spatial-estimation.html#cb44-51" tabindex="-1"></a>  <span class="fu">geom_line</span>(<span class="at">data =</span> preds3)<span class="sc">+</span> <span class="fu">theme_classic</span>()<span class="sc">+</span> </span>
<span id="cb44-52"><a href="spatial-estimation.html#cb44-52" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">x =</span> <span class="st">&quot;lag distance (h)&quot;</span>, <span class="at">y =</span> <span class="st">&quot;Semi-variance&quot;</span>)<span class="sc">+</span></span>
<span id="cb44-53"><a href="spatial-estimation.html#cb44-53" tabindex="-1"></a>  <span class="fu">theme_bw</span>()<span class="sc">+</span><span class="fu">ggtitle</span>(<span class="st">&quot;Circular&quot;</span>)<span class="sc">+</span></span>
<span id="cb44-54"><a href="spatial-estimation.html#cb44-54" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">text =</span> <span class="fu">element_text</span>(<span class="at">size =</span><span class="dv">14</span>))<span class="sc">+</span></span>
<span id="cb44-55"><a href="spatial-estimation.html#cb44-55" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">axis.title.x=</span><span class="fu">element_text</span>(<span class="at">size=</span><span class="dv">14</span>),</span>
<span id="cb44-56"><a href="spatial-estimation.html#cb44-56" tabindex="-1"></a>        <span class="at">axis.title.y=</span><span class="fu">element_blank</span>(),</span>
<span id="cb44-57"><a href="spatial-estimation.html#cb44-57" tabindex="-1"></a>        <span class="at">axis.ticks =</span> <span class="fu">element_blank</span>(),</span>
<span id="cb44-58"><a href="spatial-estimation.html#cb44-58" tabindex="-1"></a>        <span class="at">axis.text.x =</span><span class="fu">element_text</span>(<span class="at">size =</span><span class="dv">14</span>),</span>
<span id="cb44-59"><a href="spatial-estimation.html#cb44-59" tabindex="-1"></a>        <span class="at">axis.text.y =</span><span class="fu">element_blank</span>())</span>
<span id="cb44-60"><a href="spatial-estimation.html#cb44-60" tabindex="-1"></a></span>
<span id="cb44-61"><a href="spatial-estimation.html#cb44-61" tabindex="-1"></a><span class="do">########### combine all the plots together #########</span></span>
<span id="cb44-62"><a href="spatial-estimation.html#cb44-62" tabindex="-1"></a><span class="do">####################################################################################</span></span>
<span id="cb44-63"><a href="spatial-estimation.html#cb44-63" tabindex="-1"></a>grids_bs <span class="ot">&lt;-</span> <span class="fu">plot_grid</span>(g,h,i,j,<span class="at">ncol=</span><span class="dv">2</span>,<span class="at">align =</span> <span class="st">&quot;h&quot;</span>)</span>
<span id="cb44-64"><a href="spatial-estimation.html#cb44-64" tabindex="-1"></a>grids_bs</span></code></pre></div>
<div class="figure"><span style="display:block;" id="fig:10-simple-kriging-4"></span>
<img src="geomatics-for-environmental-management-_files/figure-html/10-simple-kriging-4-1.png" alt="Variogram models fitted for basal area using the YSM plot data. Nepal, CC-BY-SA-4.0." width="672" />
<p class="caption">
Figure 9.19: Variogram models fitted for basal area using the YSM plot data. Nepal, CC-BY-SA-4.0.
</p>
</div>
<p>Variogram models fitted for basal area using the YSM plot data.</p>
<p>Step 5: Put all the variogram parameters in a table and see which fits best</p>
<p>Table 10.2 Summary of various components of variogram from four variogram models.</p>
<table>
<colgroup>
<col width="17%" />
<col width="11%" />
<col width="10%" />
<col width="11%" />
<col width="18%" />
<col width="30%" />
</colgroup>
<thead>
<tr class="header">
<th align="left">Model</th>
<th align="left">Range</th>
<th align="left">Nugget</th>
<th align="left">Sill</th>
<th align="left">Partial_sill</th>
<th align="left">Partial_sill_to_Sill</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="left">Exponential</td>
<td align="left">3872.10</td>
<td align="left">0.00</td>
<td align="left">2994.10</td>
<td align="left">2994.10</td>
<td align="left">1</td>
</tr>
<tr class="even">
<td align="left">Spherical</td>
<td align="left">9704.83</td>
<td align="left">0.00</td>
<td align="left">2994.64</td>
<td align="left">2994.64</td>
<td align="left">1</td>
</tr>
<tr class="odd">
<td align="left">Gaussian</td>
<td align="left">4552.88</td>
<td align="left">0.00</td>
<td align="left">2995.03</td>
<td align="left">2995.03</td>
<td align="left">1</td>
</tr>
<tr class="even">
<td align="left">Circular</td>
<td align="left">7801.57</td>
<td align="left">729.25</td>
<td align="left">2161.74</td>
<td align="left">1432.49</td>
<td align="left">0.66</td>
</tr>
</tbody>
</table>
<p>Looking into the variogram and the parameter (Figure <a href="spatial-estimation.html#fig:10-simple-kriging-4">9.19</a>, Table: (#tab:10-simple-kriging-5), we can see that exponential variogram fits the data quite well compared to spherical and Gaussian as it has short range, low nugget and high partial sill to total sill ratio. As pointed earlier, the spatial autocorrelation only disappear at infinite lag using exponential model and best way to go is Gaussian for our data.</p>
<p>Step 6: We will use beta = 95.73, as we know the assume mean is a known constant over the domain for simple kriging</p>
<div class="sourceCode" id="cb45"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb45-1"><a href="spatial-estimation.html#cb45-1" tabindex="-1"></a>simple<span class="ot">&lt;-</span> <span class="fu">krige</span>(total <span class="sc">~</span> <span class="dv">1</span>, dta, grd, <span class="at">model=</span>FittedModel2,<span class="at">beta=</span><span class="fl">95.73</span>)</span></code></pre></div>
<pre><code>## [using simple kriging]</code></pre>
<p>Step 6: Visualize the predicted surface</p>
<div class="sourceCode" id="cb47"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb47-1"><a href="spatial-estimation.html#cb47-1" tabindex="-1"></a>fig_cap <span class="ot">&lt;-</span> <span class="fu">paste0</span>(<span class="st">&quot;Predicted basal area using simple kriging. Nepal, CC-BY-SA-4.0.&quot;</span>)</span>
<span id="cb47-2"><a href="spatial-estimation.html#cb47-2" tabindex="-1"></a><span class="co">#convert the kriging results to raster</span></span>
<span id="cb47-3"><a href="spatial-estimation.html#cb47-3" tabindex="-1"></a>raster_krig      <span class="ot">&lt;-</span> <span class="fu">raster</span>(simple)</span>
<span id="cb47-4"><a href="spatial-estimation.html#cb47-4" tabindex="-1"></a>raster_clip    <span class="ot">&lt;-</span> <span class="fu">mask</span>(raster_krig, cata)</span>
<span id="cb47-5"><a href="spatial-estimation.html#cb47-5" tabindex="-1"></a></span>
<span id="cb47-6"><a href="spatial-estimation.html#cb47-6" tabindex="-1"></a><span class="co"># Plot the kriging result using the library tmap</span></span>
<span id="cb47-7"><a href="spatial-estimation.html#cb47-7" tabindex="-1"></a><span class="fu">tm_shape</span>(raster_clip) <span class="sc">+</span> </span>
<span id="cb47-8"><a href="spatial-estimation.html#cb47-8" tabindex="-1"></a>  <span class="fu">tm_raster</span>(<span class="at">n=</span><span class="dv">8</span>,<span class="at">palette =</span> <span class="st">&quot;RdBu&quot;</span>, <span class="at">auto.palette.mapping =</span> <span class="cn">FALSE</span>,</span>
<span id="cb47-9"><a href="spatial-estimation.html#cb47-9" tabindex="-1"></a>            <span class="at">title=</span><span class="st">&quot;Predicted basal area using simple kriging&quot;</span>) <span class="sc">+</span> </span>
<span id="cb47-10"><a href="spatial-estimation.html#cb47-10" tabindex="-1"></a>  <span class="fu">tm_shape</span>(dta) <span class="sc">+</span> <span class="fu">tm_dots</span>(<span class="at">size=</span><span class="fl">0.2</span>) <span class="sc">+</span></span>
<span id="cb47-11"><a href="spatial-estimation.html#cb47-11" tabindex="-1"></a>  <span class="fu">tm_legend</span>(<span class="at">legend.outside=</span><span class="cn">FALSE</span>)</span></code></pre></div>
<div class="figure"><span style="display:block;" id="fig:10-simple-kriging-7"></span>
<img src="geomatics-for-environmental-management-_files/figure-html/10-simple-kriging-7-1.png" alt="Predicted basal area using simple kriging. Nepal, CC-BY-SA-4.0." width="672" />
<p class="caption">
Figure 9.20: Predicted basal area using simple kriging. Nepal, CC-BY-SA-4.0.
</p>
</div>
<p>Predicted basal area using simple kriging.</p>
<p>Step 7: Cross validation</p>
<div class="sourceCode" id="cb48"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb48-1"><a href="spatial-estimation.html#cb48-1" tabindex="-1"></a>cv_sK <span class="ot">&lt;-</span> <span class="fu">krige.cv</span>(total<span class="sc">~</span> <span class="dv">1</span>, dta, <span class="at">model=</span>FittedModel2, <span class="at">nfold=</span><span class="fu">nrow</span>(dta),</span>
<span id="cb48-2"><a href="spatial-estimation.html#cb48-2" tabindex="-1"></a><span class="at">verbose=</span><span class="cn">FALSE</span>)</span>
<span id="cb48-3"><a href="spatial-estimation.html#cb48-3" tabindex="-1"></a><span class="do">### calculate RMSE</span></span>
<span id="cb48-4"><a href="spatial-estimation.html#cb48-4" tabindex="-1"></a>res <span class="ot">&lt;-</span> <span class="fu">as.data.frame</span>(cv_sK)<span class="sc">$</span>residual</span>
<span id="cb48-5"><a href="spatial-estimation.html#cb48-5" tabindex="-1"></a><span class="fu">sqrt</span>(<span class="fu">mean</span>(res<span class="sc">^</span><span class="dv">2</span>))</span></code></pre></div>
<pre><code>## [1] 60.42301</code></pre>
<div class="sourceCode" id="cb50"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb50-1"><a href="spatial-estimation.html#cb50-1" tabindex="-1"></a><span class="do">#### Mean residual</span></span>
<span id="cb50-2"><a href="spatial-estimation.html#cb50-2" tabindex="-1"></a><span class="fu">mean</span>(res)</span></code></pre></div>
<pre><code>## [1] -0.6926475</code></pre>
<div class="sourceCode" id="cb52"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb52-1"><a href="spatial-estimation.html#cb52-1" tabindex="-1"></a><span class="do">#### Mean squared deviation of the prediction VS the sample</span></span>
<span id="cb52-2"><a href="spatial-estimation.html#cb52-2" tabindex="-1"></a><span class="fu">mean</span>(res<span class="sc">^</span><span class="dv">2</span><span class="sc">/</span><span class="fu">as.data.frame</span>(cv_sK)<span class="sc">$</span>var1.var)</span></code></pre></div>
<pre><code>## [1] 5.258013</code></pre>
</div>
<div id="ordinary-kriging" class="section level2 hasAnchor" number="9.33">
<h2><span class="header-section-number">9.33</span> Ordinary Kriging<a href="spatial-estimation.html#ordinary-kriging" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>Ordinary krigning <span class="citation">(<a href="#ref-matheron_intrinsic_1973">G. Matheron 1973</a>)</span> is one of the most widely used method of kriging which assume that the mean for variable of interest is an unknown constant within the domain. The mean is calculated based on the sample that is within the search window, i.e.,local mean instead of assumed constant mean over entire domain <span class="citation">(<a href="#ref-clark_practical_2007">I. Clark and Harper 2007</a>)</span> <span class="citation">(<a href="#ref-goovaerts_kriging_2008">Goovaerts 2008</a>)</span>. It assumes the following model:</p>
<p><span class="math display">\[\hat{Z}_{s_o}=\mu_{s_o} + \epsilon_{s_o}\]</span>
Where, <span class="math display">\[\hat{Z}_{s_o}=\text{variable of interest predicted at a given saptial location}\ s_{o}\]</span></p>
<p><span class="math display">\[\mu_{s_o}=\text{an unknown constant mean}\]</span></p>
<p>Steps 1, 3, 4, are similar to what we did for simple kriging and we don’t need step 2 as mean is assumed to be a unknown constant</p>
<p>Step 5: Using ordinary kriging</p>
<p>Krigging model is specified only using variable of interest.</p>
<div class="sourceCode" id="cb54"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb54-1"><a href="spatial-estimation.html#cb54-1" tabindex="-1"></a>ordinary<span class="ot">&lt;-</span> <span class="fu">krige</span> (total <span class="sc">~</span> <span class="dv">1</span>, dta, grd, <span class="at">model=</span>FittedModel2)</span></code></pre></div>
<pre><code>## [using ordinary kriging]</code></pre>
<p>Step 6: Visualize the predicted surface</p>
<div class="sourceCode" id="cb56"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb56-1"><a href="spatial-estimation.html#cb56-1" tabindex="-1"></a>fig_cap <span class="ot">&lt;-</span> <span class="fu">paste0</span>(<span class="st">&quot;Predicted basal area using ordinary kriging. Nepal, CC-BY-SA-4.0.&quot;</span>)</span>
<span id="cb56-2"><a href="spatial-estimation.html#cb56-2" tabindex="-1"></a><span class="co">#convert the kriging results to raster</span></span>
<span id="cb56-3"><a href="spatial-estimation.html#cb56-3" tabindex="-1"></a>raster_Ok      <span class="ot">&lt;-</span> <span class="fu">raster</span>(ordinary)</span>
<span id="cb56-4"><a href="spatial-estimation.html#cb56-4" tabindex="-1"></a>Ok_clip    <span class="ot">&lt;-</span> <span class="fu">mask</span>(raster_Ok, cata)</span>
<span id="cb56-5"><a href="spatial-estimation.html#cb56-5" tabindex="-1"></a></span>
<span id="cb56-6"><a href="spatial-estimation.html#cb56-6" tabindex="-1"></a><span class="co"># Plot the kriging result using the library tmap</span></span>
<span id="cb56-7"><a href="spatial-estimation.html#cb56-7" tabindex="-1"></a><span class="fu">tm_shape</span>(Ok_clip) <span class="sc">+</span> </span>
<span id="cb56-8"><a href="spatial-estimation.html#cb56-8" tabindex="-1"></a>  <span class="fu">tm_raster</span>(<span class="at">n=</span><span class="dv">8</span>,<span class="at">palette =</span> <span class="st">&quot;RdBu&quot;</span>, <span class="at">auto.palette.mapping =</span> <span class="cn">FALSE</span>,</span>
<span id="cb56-9"><a href="spatial-estimation.html#cb56-9" tabindex="-1"></a>            <span class="at">title=</span><span class="st">&quot;Predicted basal area using ordinary kriging&quot;</span>) <span class="sc">+</span> </span>
<span id="cb56-10"><a href="spatial-estimation.html#cb56-10" tabindex="-1"></a>  <span class="fu">tm_shape</span>(dta) <span class="sc">+</span> <span class="fu">tm_dots</span>(<span class="at">size=</span><span class="fl">0.2</span>) <span class="sc">+</span></span>
<span id="cb56-11"><a href="spatial-estimation.html#cb56-11" tabindex="-1"></a>  <span class="fu">tm_legend</span>(<span class="at">legend.outside=</span><span class="cn">FALSE</span>)</span></code></pre></div>
<div class="figure"><span style="display:block;" id="fig:10-ordinary-kriging-2"></span>
<img src="geomatics-for-environmental-management-_files/figure-html/10-ordinary-kriging-2-1.png" alt="Predicted basal area using ordinary kriging. Nepal, CC-BY-SA-4.0." width="672" />
<p class="caption">
Figure 9.21: Predicted basal area using ordinary kriging. Nepal, CC-BY-SA-4.0.
</p>
</div>
<p>Predicted basal area using ordinary kriging.</p>
<p>Step 7: Cross validation**</p>
<div class="sourceCode" id="cb57"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb57-1"><a href="spatial-estimation.html#cb57-1" tabindex="-1"></a>cv_oK <span class="ot">&lt;-</span> <span class="fu">krige.cv</span>(total<span class="sc">~</span> <span class="dv">1</span>, dta, <span class="at">model=</span>FittedModel2, <span class="at">nfold=</span><span class="fu">nrow</span>(dta),</span>
<span id="cb57-2"><a href="spatial-estimation.html#cb57-2" tabindex="-1"></a><span class="at">verbose=</span><span class="cn">FALSE</span>)</span>
<span id="cb57-3"><a href="spatial-estimation.html#cb57-3" tabindex="-1"></a><span class="do">### calculate RMSE</span></span>
<span id="cb57-4"><a href="spatial-estimation.html#cb57-4" tabindex="-1"></a>res <span class="ot">&lt;-</span> <span class="fu">as.data.frame</span>(cv_oK)<span class="sc">$</span>residual</span>
<span id="cb57-5"><a href="spatial-estimation.html#cb57-5" tabindex="-1"></a><span class="fu">sqrt</span>(<span class="fu">mean</span>(res<span class="sc">^</span><span class="dv">2</span>))</span></code></pre></div>
<pre><code>## [1] 60.42301</code></pre>
<div class="sourceCode" id="cb59"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb59-1"><a href="spatial-estimation.html#cb59-1" tabindex="-1"></a><span class="do">#### Mean residual</span></span>
<span id="cb59-2"><a href="spatial-estimation.html#cb59-2" tabindex="-1"></a><span class="fu">mean</span>(res)</span></code></pre></div>
<pre><code>## [1] -0.6926475</code></pre>
<div class="sourceCode" id="cb61"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb61-1"><a href="spatial-estimation.html#cb61-1" tabindex="-1"></a><span class="do">#### Mean squared deviation of the prediction VS the sample</span></span>
<span id="cb61-2"><a href="spatial-estimation.html#cb61-2" tabindex="-1"></a><span class="fu">mean</span>(res<span class="sc">^</span><span class="dv">2</span><span class="sc">/</span><span class="fu">as.data.frame</span>(cv_oK)<span class="sc">$</span>var1.var)</span></code></pre></div>
<pre><code>## [1] 5.258013</code></pre>
</div>
<div id="universal-kriging" class="section level2 hasAnchor" number="9.34">
<h2><span class="header-section-number">9.34</span> Universal Kriging<a href="spatial-estimation.html#universal-kriging" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>The universal kriging is one of the variant of ordinary kriging. This method assume that the mean varies from location to location in a deterministic way (trend or drift) while the variance is constant throughout the domain <span class="citation">(<a href="#ref-matheron_traite_1962">G. Matheron 1962</a>)</span>. One example could be measurements of temperatures, which are commonly related to elevation (at a known rate of oC by m difference).</p>
<p>Step 1: This is similar to what we did for simple kriging and we will calculate the mean based on the drift or trend in data (more localized mean) using the spatial location of the plots</p>
<div class="sourceCode" id="cb63"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb63-1"><a href="spatial-estimation.html#cb63-1" tabindex="-1"></a><span class="co"># Add X and Y to our original point dataframe, it is just how universal kriging formula takes the value of the co-ordinates.</span></span>
<span id="cb63-2"><a href="spatial-estimation.html#cb63-2" tabindex="-1"></a>dta<span class="sc">$</span>X <span class="ot">&lt;-</span> <span class="fu">coordinates</span>(dta)[,<span class="dv">1</span>]</span>
<span id="cb63-3"><a href="spatial-estimation.html#cb63-3" tabindex="-1"></a>dta<span class="sc">$</span>Y<span class="ot">&lt;-</span> <span class="fu">coordinates</span>(dta)[,<span class="dv">2</span>]</span>
<span id="cb63-4"><a href="spatial-estimation.html#cb63-4" tabindex="-1"></a></span>
<span id="cb63-5"><a href="spatial-estimation.html#cb63-5" tabindex="-1"></a><span class="do">## We will model the trend or drift using the location as X and y </span></span>
<span id="cb63-6"><a href="spatial-estimation.html#cb63-6" tabindex="-1"></a>TheVariogram4<span class="ot">=</span><span class="fu">variogram</span>(total<span class="sc">~</span>X<span class="sc">+</span>Y, <span class="at">data=</span>dta)</span>
<span id="cb63-7"><a href="spatial-estimation.html#cb63-7" tabindex="-1"></a>TheVariogramModel4 <span class="ot">&lt;-</span> <span class="fu">vgm</span>(<span class="at">psill=</span><span class="dv">2500</span>, <span class="at">model=</span><span class="st">&quot;Gau&quot;</span>, <span class="at">nugget=</span><span class="dv">1500</span>, <span class="at">range=</span><span class="dv">20000</span>)</span>
<span id="cb63-8"><a href="spatial-estimation.html#cb63-8" tabindex="-1"></a>FittedModel4 <span class="ot">&lt;-</span> <span class="fu">fit.variogram</span>(TheVariogram4, <span class="at">model=</span>TheVariogramModel4) </span>
<span id="cb63-9"><a href="spatial-estimation.html#cb63-9" tabindex="-1"></a>preds4 <span class="ot">=</span> <span class="fu">variogramLine</span>(FittedModel4, <span class="at">maxdist =</span> <span class="fu">max</span>(TheVariogram4<span class="sc">$</span>dist))</span>
<span id="cb63-10"><a href="spatial-estimation.html#cb63-10" tabindex="-1"></a></span>
<span id="cb63-11"><a href="spatial-estimation.html#cb63-11" tabindex="-1"></a>g<span class="ot">&lt;-</span><span class="fu">ggplot</span>(TheVariogram4,<span class="fu">aes</span>(<span class="at">x=</span>dist,<span class="at">y=</span>gamma))<span class="sc">+</span><span class="fu">geom_point</span>()<span class="sc">+</span></span>
<span id="cb63-12"><a href="spatial-estimation.html#cb63-12" tabindex="-1"></a>  <span class="fu">geom_line</span>(<span class="at">data =</span> preds4)<span class="sc">+</span> <span class="fu">theme_classic</span>()<span class="sc">+</span> </span>
<span id="cb63-13"><a href="spatial-estimation.html#cb63-13" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">x =</span> <span class="st">&quot;lag distance (h)&quot;</span>, <span class="at">y =</span> <span class="st">&quot;Semi-variance&quot;</span>)<span class="sc">+</span></span>
<span id="cb63-14"><a href="spatial-estimation.html#cb63-14" tabindex="-1"></a>   <span class="fu">theme_bw</span>()<span class="sc">+</span> <span class="fu">ggtitle</span>(<span class="st">&quot;Gaussian&quot;</span>)<span class="sc">+</span></span>
<span id="cb63-15"><a href="spatial-estimation.html#cb63-15" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">text =</span> <span class="fu">element_text</span>(<span class="at">size =</span><span class="dv">14</span>))<span class="sc">+</span></span>
<span id="cb63-16"><a href="spatial-estimation.html#cb63-16" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">axis.title.x=</span><span class="fu">element_blank</span>(),</span>
<span id="cb63-17"><a href="spatial-estimation.html#cb63-17" tabindex="-1"></a>        <span class="at">axis.title.y=</span><span class="fu">element_text</span>(<span class="at">size=</span><span class="dv">14</span>),</span>
<span id="cb63-18"><a href="spatial-estimation.html#cb63-18" tabindex="-1"></a>        <span class="at">axis.text.x =</span><span class="fu">element_blank</span>(),</span>
<span id="cb63-19"><a href="spatial-estimation.html#cb63-19" tabindex="-1"></a>        <span class="at">axis.text.y =</span><span class="fu">element_text</span>(<span class="at">size=</span><span class="dv">14</span>))</span>
<span id="cb63-20"><a href="spatial-estimation.html#cb63-20" tabindex="-1"></a></span>
<span id="cb63-21"><a href="spatial-estimation.html#cb63-21" tabindex="-1"></a><span class="do">## using locations of the sample to calculate the localized mean</span></span>
<span id="cb63-22"><a href="spatial-estimation.html#cb63-22" tabindex="-1"></a>universal<span class="ot">&lt;-</span> <span class="fu">krige</span>(total<span class="sc">~</span>X<span class="sc">+</span>Y,dta, grd, <span class="at">model=</span>FittedModel4)</span></code></pre></div>
<pre><code>## [using universal kriging]</code></pre>
<p>Step 2: Visualize the results as we usually</p>
<div class="sourceCode" id="cb65"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb65-1"><a href="spatial-estimation.html#cb65-1" tabindex="-1"></a>fig_cap <span class="ot">&lt;-</span> <span class="fu">paste0</span>(<span class="st">&quot;Predicted basal area using universal kriging. Nepal, CC-BY-SA-4.0.&quot;</span>)</span>
<span id="cb65-2"><a href="spatial-estimation.html#cb65-2" tabindex="-1"></a><span class="co">#convert the kriging results to raster</span></span>
<span id="cb65-3"><a href="spatial-estimation.html#cb65-3" tabindex="-1"></a>raster_uk      <span class="ot">&lt;-</span> <span class="fu">raster</span>(universal)</span>
<span id="cb65-4"><a href="spatial-estimation.html#cb65-4" tabindex="-1"></a>uk_clip    <span class="ot">&lt;-</span> <span class="fu">mask</span>(raster_uk, cata)</span>
<span id="cb65-5"><a href="spatial-estimation.html#cb65-5" tabindex="-1"></a></span>
<span id="cb65-6"><a href="spatial-estimation.html#cb65-6" tabindex="-1"></a><span class="co"># Plot the kriging result using the library tmap</span></span>
<span id="cb65-7"><a href="spatial-estimation.html#cb65-7" tabindex="-1"></a><span class="fu">tm_shape</span>(uk_clip) <span class="sc">+</span> </span>
<span id="cb65-8"><a href="spatial-estimation.html#cb65-8" tabindex="-1"></a>  <span class="fu">tm_raster</span>(<span class="at">n=</span><span class="dv">8</span>,<span class="at">palette =</span> <span class="st">&quot;RdBu&quot;</span>, <span class="at">auto.palette.mapping =</span> <span class="cn">FALSE</span>,</span>
<span id="cb65-9"><a href="spatial-estimation.html#cb65-9" tabindex="-1"></a>            <span class="at">title=</span><span class="st">&quot;Predicted basal area using universal kriging&quot;</span>) <span class="sc">+</span> </span>
<span id="cb65-10"><a href="spatial-estimation.html#cb65-10" tabindex="-1"></a>  <span class="fu">tm_shape</span>(dta) <span class="sc">+</span> <span class="fu">tm_dots</span>(<span class="at">size=</span><span class="fl">0.2</span>) <span class="sc">+</span></span>
<span id="cb65-11"><a href="spatial-estimation.html#cb65-11" tabindex="-1"></a>  <span class="fu">tm_legend</span>(<span class="at">legend.outside=</span><span class="cn">FALSE</span>)</span></code></pre></div>
<div class="figure"><span style="display:block;" id="fig:10-universal-kriging-2"></span>
<img src="geomatics-for-environmental-management-_files/figure-html/10-universal-kriging-2-1.png" alt="Predicted basal area using universal kriging. Nepal, CC-BY-SA-4.0." width="672" />
<p class="caption">
Figure 9.22: Predicted basal area using universal kriging. Nepal, CC-BY-SA-4.0.
</p>
</div>
<p>Predicted basal area using universal kriging.</p>
<p>Step 3: Cross validation</p>
<div class="sourceCode" id="cb66"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb66-1"><a href="spatial-estimation.html#cb66-1" tabindex="-1"></a>cv_uK <span class="ot">&lt;-</span> <span class="fu">krige.cv</span>(total<span class="sc">~</span> X<span class="sc">+</span>Y, dta, <span class="at">model=</span>FittedModel4, <span class="at">nfold=</span><span class="fu">nrow</span>(dta),</span>
<span id="cb66-2"><a href="spatial-estimation.html#cb66-2" tabindex="-1"></a><span class="at">verbose=</span><span class="cn">FALSE</span>)</span>
<span id="cb66-3"><a href="spatial-estimation.html#cb66-3" tabindex="-1"></a><span class="do">### calculate RMSE</span></span>
<span id="cb66-4"><a href="spatial-estimation.html#cb66-4" tabindex="-1"></a>res <span class="ot">&lt;-</span> <span class="fu">as.data.frame</span>(cv_uK)<span class="sc">$</span>residual</span>
<span id="cb66-5"><a href="spatial-estimation.html#cb66-5" tabindex="-1"></a><span class="fu">sqrt</span>(<span class="fu">mean</span>(res<span class="sc">^</span><span class="dv">2</span>))</span></code></pre></div>
<pre><code>## [1] 68.48368</code></pre>
<div class="sourceCode" id="cb68"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb68-1"><a href="spatial-estimation.html#cb68-1" tabindex="-1"></a><span class="do">#### Mean residual</span></span>
<span id="cb68-2"><a href="spatial-estimation.html#cb68-2" tabindex="-1"></a><span class="fu">mean</span>(res)</span></code></pre></div>
<pre><code>## [1] -1.374287</code></pre>
<div class="sourceCode" id="cb70"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb70-1"><a href="spatial-estimation.html#cb70-1" tabindex="-1"></a><span class="do">#### Mean squared deviation of the prediction VS the sample</span></span>
<span id="cb70-2"><a href="spatial-estimation.html#cb70-2" tabindex="-1"></a><span class="fu">mean</span>(res<span class="sc">^</span><span class="dv">2</span><span class="sc">/</span><span class="fu">as.data.frame</span>(cv_uK)<span class="sc">$</span>var1.var)</span></code></pre></div>
<pre><code>## [1] 10.97501</code></pre>
</div>
<div id="which-method-is-the-best-given-our-data" class="section level2 unnumbered hasAnchor">
<h2>Which method is the best given our data?<a href="spatial-estimation.html#which-method-is-the-best-given-our-data" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>We will put the cross validation results together and cross compare across three methods.</p>
<p><strong>Table 10.3</strong> Cross-validation results for different type of kriging.</p>
<table>
<thead>
<tr class="header">
<th align="left">Method</th>
<th align="left">RMSE</th>
<th align="left">ME</th>
<th align="left">MSDR</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="left">Simple</td>
<td align="left">60.42</td>
<td align="left">-0.69</td>
<td align="left">5.25</td>
</tr>
<tr class="even">
<td align="left">Ordinary</td>
<td align="left">60.42</td>
<td align="left">-0.69</td>
<td align="left">5.25</td>
</tr>
<tr class="odd">
<td align="left">Universal</td>
<td align="left">68.48</td>
<td align="left">-1.37</td>
<td align="left">10.97</td>
</tr>
</tbody>
</table>
<p>From the cross validation results (Table 10.3), we want root mean squared error (RMSE) to be low for greater predictive accuracy <span class="citation">(<a href="#ref-tziachris_spatial_2017">Tziachris et al. 2017</a>)</span>. We also want mean error (ME) to be as close to 0 as possible <span class="citation">(<a href="#ref-tziachris_spatial_2017">Tziachris et al. 2017</a>)</span>. And we want mean squared deviation Ratio (MSDR) to be closer to 1 for the good kriging model <span class="citation">(<a href="#ref-tziachris_spatial_2017">Tziachris et al. 2017</a>)</span>. The RMSE is lowest for simple and ordinary kriging, the ME is negative and below zero, and the MSDR of the predictions vs. the sample is low and closer to 1 for both simple and ordinary kriging (Table 10.3). This means the variability in predictions from both kriging are somewhat closer to real values than universal kriging <span class="citation">(<a href="#ref-tziachris_spatial_2017">Tziachris et al. 2017</a>)</span>. Looks like universal kriging is predicting more negative basal area for some of the location within TSA. The choice between simple and ordinary kriging may vary with researchers discretion here.</p>
</div>
<div id="co-kriging" class="section level2 hasAnchor" number="9.35">
<h2><span class="header-section-number">9.35</span> Co-Kriging<a href="spatial-estimation.html#co-kriging" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>Co-kriging uses the information about different covariates to predict the value of the variable of interest at an unsampled location <span class="citation">(<a href="#ref-cressie_statistics_1994">Cressie 1994</a>)</span>. It utilizes the autocorrelation of the variable of interest and the cross correlations between the variable of interest with all the covariates to make the prediction <span class="citation">(<a href="#ref-cressie_statistics_1994">Cressie 1994</a>)</span>. In order to implement co-kriging we need to have a strong correlation between the covariates <span class="citation">(<a href="#ref-tziachris_spatial_2017">Tziachris et al. 2017</a>)</span>. The spatial variability of one variable should be correlated with the spatial variability of the other covariates <span class="citation">(<a href="#ref-tziachris_spatial_2017">Tziachris et al. 2017</a>)</span>.</p>
</div>
<div id="non-linear-kriging" class="section level2 hasAnchor" number="9.36">
<h2><span class="header-section-number">9.36</span> Non-Linear Kriging<a href="spatial-estimation.html#non-linear-kriging" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>In principle, nonlinear kriging algorithms are linear kriging algorithms applied to nonlinear transformations of the data points into a continuous variable <span class="citation">(<a href="#ref-deutsch_gslib_1993">Deutsch and Journel 1993</a>)</span>. We will briefly talk about four principal non-linear kriging techniques in this chapter while our focus mostly is on linear kriging methods.</p>
</div>
<div id="indicator-kriging" class="section level2 hasAnchor" number="9.37">
<h2><span class="header-section-number">9.37</span> Indicator Kriging<a href="spatial-estimation.html#indicator-kriging" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>Indicator kriging is a non-parametric approach of estimating a binary variable (presence absence or variables that takes 0 or 1 value) of interest at an unsampled or unmeasured location <span class="citation">(<a href="#ref-journel_nonparametric_1983">Journel 1983</a>)</span>. For example, we might have a sample that consists of information on presence or absence of Douglas-fir tree species within Williams lake timber supply area, where 0 indicates absence and 1 indicates the presence of species. Indicator kriging assumes that mean is a unknown constant over the domain. The only difference between the indicator kriging and ordinary krigging is in the use of binary variable. The basic mathematical formulation of indicator kriging is given below:</p>
<p><span class="math display">\[I_{s}= \mu + \epsilon_{s}\]</span>
where, <span class="math display">\[I= \text{binary variable preicated at the location s}\]</span>
<span class="math display">\[\mu= \text{unknown mean}\]</span>
<span class="math display">\[\epsilon_{s}=\text{spatially autocorrelated error}\]</span></p>
</div>
<div id="probability-kriging" class="section level2 hasAnchor" number="9.38">
<h2><span class="header-section-number">9.38</span> Probability Kriging<a href="spatial-estimation.html#probability-kriging" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>Probability kriging is useful when the variable of interest is binary as in case of indicator kriging. It is a special form of co-kriging which estimate the conditional probability that the unknown value of a variable at an unsampled location is above a specified cutoff level <span class="citation">(<a href="#ref-carr_general_1993">Carr and Mao 1993</a>)</span>. As in co-kriging, this method utilizes the autocorrelation of variable of interest and the cross correlations between the variable of interest with all the covariates to make the prediction <span class="citation">(<a href="#ref-carr_general_1993">Carr and Mao 1993</a>)</span></p>
</div>
<div id="disjunctive-kriging" class="section level2 hasAnchor" number="9.39">
<h2><span class="header-section-number">9.39</span> Disjunctive Kriging<a href="spatial-estimation.html#disjunctive-kriging" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>Disjunctive kriging allows to estimate the value of a variable of interest at an unsampled location and estimating the conditional probability that the unknown value of a variable at an unsampled location is above a specified cutoff level <span class="citation">(<a href="#ref-yates_disjunctive_1986">Yates, Warrick, and Myers 1986</a>)</span>. Disjunctive kriging transforms the data into a normal distribution and then determine the probability that true value of variable at each location of interest exceeds the predefined threshold or cut-off probability <span class="citation">(<a href="#ref-daya_comparative_2015">Daya and Bejari 2015</a>)</span>.</p>
</div>
<div id="spatial-regression-models" class="section level2 hasAnchor" number="9.40">
<h2><span class="header-section-number">9.40</span> Spatial Regression Models<a href="spatial-estimation.html#spatial-regression-models" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>For classical statistics tests, spatial autocorrelation is problematic as ordinary least square (regression) or analysis of variance (ANOVA) assumes that observations are independent in space and time <span class="citation">(<a href="#ref-meng_spatial_2009">Meng et al. 2009</a>)</span>. However, geostatistical data violates the assumptions of independence, and using regression and ANOVA might inflate the significance of t and F statistics, when, in fact, they may not be significant at all <span class="citation">(<a href="#ref-meng_spatial_2009">Meng et al. 2009</a>)</span>. In that case one should try to improve the regression model by adding important auxiliary (independent variables that are associated or important in predicting the variables of interest) and incorporating the spatial autocorrelation structure <span class="citation">(<a href="#ref-meng_spatial_2009">Meng et al. 2009</a>)</span> using spatial regression models <span class="citation">(<a href="#ref-anselin_spatial_1998">Anselin and Bera 1998</a>)</span>. The whole objective of spatial regression is to understand the association of the variable of interest with the independent variables while accounting for the spatial structure present in the data. We will show two examples of spatial regression model in this section using our familiar YSM data for Fort Saint Johns TSA.</p>
</div>
<div id="case-study-5" class="section level2 hasAnchor" number="9.41">
<h2><span class="header-section-number">9.41</span> Case Study 5<a href="spatial-estimation.html#case-study-5" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>For this case study, we will use ground plot data from Young stand monitoring (YSM) program data <span class="citation">(<a href="#ref-province_of_bc_provincial_2018">Province of BC 2018</a>)</span> for Fort Saint Johns timber supply area (TSA) in the province of British Columbia, Canada. Fort Saint Johns is divided into 6 blocks respectively Figure <a href="spatial-estimation.html#fig:10-FSJ-plot">9.6</a>. There are a total of 108 YSM plots used in this study Figure <a href="spatial-estimation.html#fig:10-FSJ-plot">9.6</a>. The total basal area (<span class="math inline">\(m^2/ha\)</span>) is our variable of interest or response variable in this study. For each of the YSM plot the total basal area was calculated by adding the basal area for all trees within the plot. We will use the auxiliary variables such as trees per hectare (TPH), elevation (m), site index, top height (m), and tree volume (<span class="math inline">\(m^3/ha\)</span>)</p>
</div>
<div id="spatial-lag-model" class="section level2 hasAnchor" number="9.42">
<h2><span class="header-section-number">9.42</span> Spatial Lag Model<a href="spatial-estimation.html#spatial-lag-model" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>Spatial lag models assume that the spatial autocorrelation only exist in the response variable or the variable of interest <span class="citation">(<a href="#ref-anselin_spatial_1998">Anselin and Bera 1998</a>)</span>. Spatial lag model has the following general mathematical formulations:</p>
<p><span class="math display">\[ y=  (\rho)WY + \beta X + \epsilon\]</span>
where, <span class="math display">\[y= \text{response variable or variable of interest}\]</span>
<span class="math display">\[\rho= \text{coefficients for the spatial weight matrix W}\]</span>
<span class="math display">\[\beta= \text{coefficients for the predictor variables}\]</span>
<span class="math display">\[WY=\text{spatially lagged response variable for the weight matrix W}\]</span>
<span class="math display">\[X=\text{matrix of observations for the predictor variables}\]</span>
<span class="math display">\[\epsilon=\text{vector of error terms}\]</span></p>
</div>
<div id="steps-in-fitting-spatial-lag-model" class="section level2 hasAnchor" number="9.43">
<h2><span class="header-section-number">9.43</span> Steps in Fitting Spatial Lag Model:<a href="spatial-estimation.html#steps-in-fitting-spatial-lag-model" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>Step 1: Build spatial weight matrix</p>
<p>We will create a spatial weight matrix using the distance-based approach using the nearest-neighbor approach. This spatial weight matrix will be used in our spatial lag model to account for the spatial autocorrelation.</p>
<p>Step 2: Check for the spatial autocorrelation</p>
<p>We will check the spatial autocorrelation using the Moran’s I and Moran’s test using our distance based spatial weight matrix <span class="citation">(<a href="#ref-getis_constructing_2010">Getis and Aldstadt 2010</a>)</span> we have just calculated.</p>
<pre><code>## 
##  Moran I test under randomisation
## 
## data:  YSM_pots$Basal  
## weights: YSM.W    
## 
## Moran I statistic standard deviate = 2.6524, p-value = 0.003996
## alternative hypothesis: greater
## sample estimates:
## Moran I statistic       Expectation          Variance 
##      0.0656590005     -0.0093457944      0.0007996302</code></pre>
<p>Moran’s I value was (I=0.065), which was significant (p-value &lt; 0.05) indicting a positive spatial autocorrelation. It seems like a weak autocorrelation but for the purpose of demonstration in this section we will proceed further assuming there is a spatial autocorrelation.</p>
<p>Step 3: Fit a spatial lag model</p>
<p>In this step, we will fit a spatial lag model using basal area (m2/ha) as a response variable. While, trees per hectare (TPH), elevation (m), site index, top height(m), and tree volume (m3/ha) will be used as predictor variable.</p>
<pre><code>## 
## Call:lagsarlm(formula = f1, data = YSM_pots, listw = YSM.W, zero.policy = T)
## 
## Residuals:
##      Min       1Q   Median       3Q      Max 
## -28.4814  -8.7285  -1.5817   8.6639  34.8502 
## 
## Type: lag 
## Coefficients: (asymptotic standard errors) 
##                Estimate  Std. Error z value  Pr(&gt;|z|)
## (Intercept) -2.0836e+01  1.2070e+01 -1.7262 0.0843163
## TPH          3.7555e-03  4.6693e-04  8.0430 8.882e-16
## Elevation    2.0548e-02  5.3747e-03  3.8230 0.0001318
## Volume       9.6251e-02  4.8825e-03 19.7135 &lt; 2.2e-16
## Height      -8.6348e-02  4.7058e-01 -0.1835 0.8544098
## Site_index  -4.3118e-01  3.3104e-01 -1.3025 0.1927520
## 
## Rho: 0.18185, LR test value: 5.015, p-value: 0.025129
## Asymptotic standard error: 0.079411
##     z-value: 2.29, p-value: 0.022023
## Wald statistic: 5.244, p-value: 0.022023
## 
## Log likelihood: -425.7183 for lag model
## ML residual variance (sigma squared): 155.08, (sigma: 12.453)
## Number of observations: 108 
## Number of parameters estimated: 8 
## AIC: 867.44, (AIC for lm: 870.45)
## LM test for residual autocorrelation
## test value: 0.82749, p-value: 0.363</code></pre>
<p>Step 4: Select auxiliary variables and refit the model</p>
<p>Varieties of ways has been proposed to select the auxiliary variables to get the best spatial model. We will go through them briefly. First, we will Use the alpha=0.005 to check whether our auxiliary variables are significantly associated with the basal area. From the summary, we can see that TPH, Elevation and Volume has p-value &lt; 0.05 indicating that they are significantly associated with basal area.</p>
<pre><code>## 
## Call:lagsarlm(formula = f2, data = YSM_pots, listw = YSM.W, zero.policy = T)
## 
## Residuals:
##       Min        1Q    Median        3Q       Max 
## -29.94846  -7.71629  -0.30949   8.76752  35.90219 
## 
## Type: lag 
## Coefficients: (asymptotic standard errors) 
##                Estimate  Std. Error z value  Pr(&gt;|z|)
## (Intercept) -2.8815e+01  9.0662e+00 -3.1783  0.001481
## TPH          3.8730e-03  4.1327e-04  9.3716 &lt; 2.2e-16
## Elevation    2.4226e-02  4.5404e-03  5.3356  9.52e-08
## Volume       9.4008e-02  2.3532e-03 39.9498 &lt; 2.2e-16
## 
## Rho: 0.16445, LR test value: 4.1412, p-value: 0.041852
## Asymptotic standard error: 0.078353
##     z-value: 2.0988, p-value: 0.035833
## Wald statistic: 4.405, p-value: 0.035833
## 
## Log likelihood: -426.8261 for lag model
## ML residual variance (sigma squared): 158.35, (sigma: 12.584)
## Number of observations: 108 
## Number of parameters estimated: 6 
## AIC: 865.65, (AIC for lm: 867.79)
## LM test for residual autocorrelation
## test value: 1.3195, p-value: 0.25067</code></pre>
<p>Step 5: Assess both models using Akaike’s Information Criteria (AIC)</p>
<p>Sometime, only using the p-value to assess significant variables will not be useful while assessing which models best fits the data as multiple models can have potential to describe the association between response and predictor variables. In the context, when we have different competing models, we can use AIC <span class="citation">(for details see, <a href="#ref-akaike_information_1973">Akaike 1973</a>)</span> to compare the models. For example, suppose models we have fitted in step 3 and step 4 were competing and potential. We can select the best model between two with lowest AIC values. AIC value of model from step 3 is 867.44 while the AIC value of model from step 4 is 865.65, indicating later one is the best fit to our data.</p>
<p>Step 6: Interpreting rho coefficient for our selected model</p>
<p>Rho (0.16445), reflects the spatial dependence inherent in our sample data, measuring the average influence on observations by their neighboring observations. It has a positive effect and it is significant (p-value &lt; 0.05). As a result, the general model fit improved over the linear model.</p>
</div>
<div id="spatial-error-model" class="section level2 hasAnchor" number="9.44">
<h2><span class="header-section-number">9.44</span> Spatial Error Model<a href="spatial-estimation.html#spatial-error-model" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>Spatial error models assume that the spatial autocorrelation exists in the residuals or the error term of the regression equation <span class="citation">(<a href="#ref-anselin_spatial_1998">Anselin and Bera 1998</a>)</span>. The general mathematical formula for spatial error model is given below:</p>
<p><span class="math display">\[ y=\beta X + \epsilon\]</span>
<span class="math display">\[\epsilon= \lambda (W)\epsilon+ u\]</span></p>
<p>where, <span class="math display">\[y= \text{response variable or variable of interest}\]</span>
<span class="math display">\[\beta= \text{coefficients for the predictor variables}\]</span>
<span class="math display">\[\lambda= \text{coefficients for the spatial weight matrix W for spatially autocorrelated erros}\]</span></p>
<p><span class="math display">\[(W)\epsilon=\text{spatial weight matrix W}\]</span>
<span class="math display">\[X=\text{matrix of observations for the predictor variables}\]</span>
<span class="math display">\[u=\text{indepndent errors}\]</span></p>
</div>
<div id="steps-in-fitting-spatial-error-model" class="section level2 hasAnchor" number="9.45">
<h2><span class="header-section-number">9.45</span> Steps in Fitting Spatial Error Model:<a href="spatial-estimation.html#steps-in-fitting-spatial-error-model" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>Step 1 and Step 2 in fitting spatial error model is exactly similar to what we did for spatial lag model.</p>
<p>Step 3: Fit the spatial error model</p>
<p>We will use the function errorsarlm from the package spatialreg to fit the error model indicating that we are accounting the spatial autocorrelation that exists in the residuals or the error terms instead of the response variable (basal area).</p>
<pre><code>## 
## Call:errorsarlm(formula = f3, data = YSM_pots, listw = YSM.W, zero.policy = T)
## 
## Residuals:
##      Min       1Q   Median       3Q      Max 
## -27.7331  -7.8589  -1.0210   7.8231  35.1950 
## 
## Type: error 
## Coefficients: (asymptotic standard errors) 
##                Estimate  Std. Error z value  Pr(&gt;|z|)
## (Intercept) -0.14171626 10.59980550 -0.0134   0.98933
## TPH          0.00378146  0.00048423  7.8092 5.773e-15
## Elevation    0.01635979  0.00645862  2.5330   0.01131
## Volume       0.09585359  0.00479585 19.9868 &lt; 2.2e-16
## Height      -0.11345603  0.45520593 -0.2492   0.80317
## Site_index  -0.30051747  0.32907580 -0.9132   0.36113
## 
## Lambda: 0.50793, LR test value: 3.6202, p-value: 0.057081
## Asymptotic standard error: 0.1857
##     z-value: 2.7352, p-value: 0.0062338
## Wald statistic: 7.4815, p-value: 0.0062338
## 
## Log likelihood: -426.4156 for error model
## ML residual variance (sigma squared): 154.69, (sigma: 12.438)
## Number of observations: 108 
## Number of parameters estimated: 8 
## AIC: NA (not available for weighted model), (AIC for lm: 870.45)</code></pre>
<p>Step 4: Select auxiliary variables and refit the model</p>
<p>We will use the alpha=0.05 to check whether our auxiliary variables are significantly associated with the basal area. From the summary, we can see that TPH, Elevation and Volume has p-value &lt; 0.05 indicating that they are significantly associated with basal area.</p>
<pre><code>## 
## Call:errorsarlm(formula = f4, data = YSM_pots, listw = YSM.W, zero.policy = T)
## 
## Residuals:
##       Min        1Q    Median        3Q       Max 
## -27.84609  -7.91303  -0.65425   7.82677  36.06371 
## 
## Type: error 
## Coefficients: (asymptotic standard errors) 
##                Estimate  Std. Error z value  Pr(&gt;|z|)
## (Intercept) -7.12704410  6.71512779 -1.0613  0.288535
## TPH          0.00391705  0.00042822  9.1472 &lt; 2.2e-16
## Elevation    0.01843299  0.00595547  3.0951  0.001967
## Volume       0.09366580  0.00235054 39.8487 &lt; 2.2e-16
## 
## Lambda: 0.52491, LR test value: 3.7554, p-value: 0.052636
## Asymptotic standard error: 0.18121
##     z-value: 2.8967, p-value: 0.0037711
## Wald statistic: 8.3909, p-value: 0.0037711
## 
## Log likelihood: -427.019 for error model
## ML residual variance (sigma squared): 156.21, (sigma: 12.498)
## Number of observations: 108 
## Number of parameters estimated: 6 
## AIC: NA (not available for weighted model), (AIC for lm: 867.79)</code></pre>
<p>Step 5: Assess both models using akaike’s information criteria (AIC)</p>
<p>AIC value of model from step 3 is 868.83 while the AIC value of model from step 4 is 866.04, indicating later one is the best fit to our data.</p>
<p>Step 6: Interpret lambda parameter from the summary from our selected model</p>
<p>The lag error parameter Lambda for the model in step 4 is positive and significant (p-value &lt; 0.05), indicating the need to control for spatial autocorrelation in the error</p>
</div>
<div id="selection-between-lag-and-error-model" class="section level2 hasAnchor" number="9.46">
<h2><span class="header-section-number">9.46</span> Selection Between Lag and Error Model<a href="spatial-estimation.html#selection-between-lag-and-error-model" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>When it is not so clear theoretically that either of the spatial model works for our data, we can compare the model performance parameters: the AIC and Log likelihood. In our case, the spatial error model has lowest AIC and highest negative Log likelihood values. Hence, spatial lag model best fits our data.</p>
</div>
<div class="box-content call-out-content">
<div id="remember-this" class="section level2 unnumbered hasAnchor box-title call-out-top">
<h2>Remember This?<a href="spatial-estimation.html#remember-this" class="anchor-section" aria-label="Anchor link to header"></a></h2>
</div>
<p id="box-text">
When the question is which of the two models is better? This is an open question. The general advice is first to look for a theoretical basis to inform your choice. If there are strong substantive grounds for one model instead of the other, you should adopt it.
</p>
</div>
<div id="reflection-questions-6" class="section level2 unnumbered hasAnchor">
<h2>Reflection Questions<a href="spatial-estimation.html#reflection-questions-6" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<ol style="list-style-type: decimal">
<li>Explain probability and non-probability sampling.</li>
<li>Define spatial autocorrelation and semivariogram.</li>
<li>When do you use spatial contiguity vs. nearest neighbor?</li>
<li>What is spatial regression mostly used for? Estimation or Prediction?
—!&gt;</li>
</ol>

</div>
</div>
<h3>References</h3>
<div id="refs" class="references csl-bib-body hanging-indent">
<div id="ref-akaike_information_1973" class="csl-entry">
Akaike, Hirotogu. 1973. <span>“Information Theory and an Extension of the Maximum Likelihood Principle.”</span> In <em>In <span>Proceedings</span> of the 2nd <span>International</span> <span>Symposium</span> on <span>Information</span> <span>Theory</span></em>. <a href="https://doi.org/10.1007/978-1-4612-1694-0_15">https://doi.org/10.1007/978-1-4612-1694-0_15</a>.
</div>
<div id="ref-anselin_spatial_1998" class="csl-entry">
Anselin, Luc, and Anil Bera. 1998. <span>“Spatial <span>Dependence</span> in Linear <span>Regression</span> <span>Models</span> with an <span>Introduction</span> to <span>Spatial</span> <span>Econometrics</span>.”</span> In <em>Handbook of <span>Applied</span> <span>Economic</span> <span>Statistics</span></em>, edited by A Ullah and D Giles, 237–89. New York: Marcel Dekker. <a href="https://doi.org/10.1201/9781482269901-36">https://doi.org/10.1201/9781482269901-36</a>.
</div>
<div id="ref-asa_comparison_2012" class="csl-entry">
Asa, Eric, Mohamed Saafi, Joseph Membah, and Arun Billa. 2012. <span>“Comparison of <span>Linear</span> and <span>Nonlinear</span> <span>Kriging</span> <span>Methods</span> for <span>Characterization</span> and <span>Interpolation</span> of <span>Soil</span> <span>Data</span>.”</span> <em>Journal of Computing in Civil Engineering</em> 26 (1): 11–18. <a href="https://doi.org/10.1061/(asce)cp.1943-5487.0000118">https://doi.org/10.1061/(asce)cp.1943-5487.0000118</a>.
</div>
<div id="ref-babak_statistical_2009" class="csl-entry">
Babak, Olena, and Clayton V. Deutsch. 2009. <span>“Statistical Approach to Inverse Distance Interpolation.”</span> <em>Stochastic Environmental Research and Risk Assessment</em> 23 (5): 543–53. <a href="https://doi.org/10.1007/s00477-008-0226-6">https://doi.org/10.1007/s00477-008-0226-6</a>.
</div>
<div id="ref-burrough_principles_1998" class="csl-entry">
Burrough, Peter, and Rachael McDonnell. 1998. <span>“Principles of <span>Geographical</span> <span>Information</span> <span>Systems</span> by <span>Peter</span> <span>A</span>.”</span> <em>Oxford University Press</em> 54 (2): 56–57. <a href="https://doi.org/10.1111/j.1745-7939.1998.tb02089.x">https://doi.org/10.1111/j.1745-7939.1998.tb02089.x</a>.
</div>
<div id="ref-carr_general_1993" class="csl-entry">
Carr, James R., and Nai hsien Mao. 1993. <span>“A General Form of Probability Kriging for Estimation of the Indicator and Uniform Transforms.”</span> <em>Mathematical Geology</em> 25 (4): 425–38. <a href="https://doi.org/10.1007/BF00894777">https://doi.org/10.1007/BF00894777</a>.
</div>
<div id="ref-clark_practical_2007" class="csl-entry">
Clark, I, and W V Harper. 2007. <em>Practical <span>Geostatistics</span> 2000.</em> EcoSSe North America Llc, Ohio.
</div>
<div id="ref-cliff_ad_and_ord_spatial_1973" class="csl-entry">
Cliff, J. K, A. D. and Ord. 1973. <span>“Spatial Autocorrelation.”</span> <em>Progress in Human Geography</em> 19: 245–49.
</div>
<div id="ref-coulston_effect_nodate" class="csl-entry">
Coulston, J W, and G A Reams. n.d. <span>“The Effect of Blurred Plot Coordinates on Interpolating Forest Biomass : A Case Study 3041 <span>Cornwallis</span> <span>Road</span> 3041 <span>Cornwallis</span> <span>Road</span>”</span> m.
</div>
<div id="ref-cressie_statistics_1994" class="csl-entry">
Cressie, N. A. C. 1994. <span>“Statistics for <span>Spatial</span> <span>Data</span>, <span>Revised</span> <span>Edition</span>.”</span> <a href="https://doi.org/10.2307/2533238">https://doi.org/10.2307/2533238</a>.
</div>
<div id="ref-daya_comparative_2015" class="csl-entry">
Daya, Ali Akbar, and Hadi Bejari. 2015. <span>“A Comparative Study Between Simple Kriging and Ordinary Kriging for Estimating and Modeling the <span>Cu</span> Concentration in <span>Chehlkureh</span> Deposit, <span>SE</span> <span>Iran</span>.”</span> <em>Arabian Journal of Geosciences</em> 8 (8): 6003–20. <a href="https://doi.org/10.1007/s12517-014-1618-1">https://doi.org/10.1007/s12517-014-1618-1</a>.
</div>
<div id="ref-deutsch_gslib_1993" class="csl-entry">
Deutsch, C, and A Journel. 1993. <span>“<span>GSLIB</span>: <span>Geostatistical</span> <span>Software</span> <span>Library</span> and <span>User</span>’s <span>Guide</span>.”</span> In.
</div>
<div id="ref-geary_contiguity_1954" class="csl-entry">
Geary, R . C . 1954. <span>“The <span>Contiguity</span> <span>Ratio</span> and <span>Statistical</span> <span>Mapping</span>.”</span> <em>The Incorporated Statistician</em> 5 (3): 115–27. <a href="https://www.jstor.org/stable/2986645">https://www.jstor.org/stable/2986645</a>.
</div>
<div id="ref-getis_constructing_2010" class="csl-entry">
Getis, Arthur, and Jared Aldstadt. 2010. <span>“Constructing the Spatial Weights Matrix Using a Local Statistic.”</span> <em>Advances in Spatial Science</em> 61 (2): 147–63. <a href="https://doi.org/10.1007/978-3-642-01976-0_11">https://doi.org/10.1007/978-3-642-01976-0_11</a>.
</div>
<div id="ref-getis_spatial_2004" class="csl-entry">
Getis, Arthur, Jesus Mur, Bernard Fingleton, and Maria Plotnikova. 2004. <span>“Spatial <span>Econometrics</span> and <span>Spatial</span> <span>Statistics</span> <span>Spatial</span> <span>Econometrics</span> and <span>Spatial</span> <span>Statistics</span> <span>Arthur</span> <span>Getis</span> , <span>Jesús</span> <span>Mur</span> <span>Lacambra</span> and <span>Henry</span> <span>G</span> . <span>Zoller</span>,”</span> no. May 2014.
</div>
<div id="ref-goovaerts_kriging_2008" class="csl-entry">
Goovaerts, Pierre. 2008. <span>“Kriging and <span>Semivariogram</span> <span>Deconvolution</span> in the <span>Presence</span> of <span>Irregular</span> <span>Geographical</span> <span>Units</span>.”</span> <em>Mathematical Geology</em> 40 (1): 101–28. <a href="https://www.ncbi.nlm.nih.gov/pmc/articles/PMC3624763/pdf/nihms412728.pdf">https://www.ncbi.nlm.nih.gov/pmc/articles/PMC3624763/pdf/nihms412728.pdf</a>.
</div>
<div id="ref-howell_area_2020" class="csl-entry">
Howell, Carrie R., Wei Su, Ariann F. Nassel, April A. Agne, and Andrea L. Cherrington. 2020. <span>“Area Based Stratified Random Sampling Using Geospatial Technology in a Community-Based Survey.”</span> <em>BMC Public Health</em> 20 (1): 1–9. <a href="https://doi.org/10.1186/s12889-020-09793-0">https://doi.org/10.1186/s12889-020-09793-0</a>.
</div>
<div id="ref-isaaks_introduction_1989" class="csl-entry">
Isaaks, Edward, and R.Mohan Srivastava. 1989. <em>An <span>Introduction</span> to <span>Applied</span> <span>Geostatistics</span>.</em> 1st ed. Vol. 17. 3. New York: Oxford University Press, New York. https://doi.org/<a href="https://doi.org/10.1016/0098-3004(91)90055-I">https://doi.org/10.1016/0098-3004(91)90055-I</a>.
</div>
<div id="ref-jacquez_spatial_1999" class="csl-entry">
Jacquez, Geoffrey M. 1999. <span>“Spatial Statistics When Locations Are Uncertain.”</span> <em>Geographic Information Sciences</em> 5 (2): 77–87. <a href="https://doi.org/10.1080/10824009909480517">https://doi.org/10.1080/10824009909480517</a>.
</div>
<div id="ref-journel_nonparametric_1983" class="csl-entry">
Journel, A. G. 1983. <span>“Nonparametric Estimation of Spatial Distributions.”</span> <em>Journal of the International Association for Mathematical Geology</em> 15 (3): 445–68. <a href="https://doi.org/10.1007/BF01031292">https://doi.org/10.1007/BF01031292</a>.
</div>
<div id="ref-krige_statistical_1951" class="csl-entry">
Krige, D. G. 1951. <span>“A Statistical Approach to Some Basic Mine Valuation Problems on the <span>Witwatersrand</span>.”</span> <em>Journal of Southern African Institute of Mining and Metallurgy</em> 52 (6): 119–39.
</div>
<div id="ref-matheron_traite_1962" class="csl-entry">
Matheron, G. 1962. <em>Traité de Géostatistique Appliquée</em>. Memoires, v. 1. Éditions Technip. <a href="https://books.google.ca/books?id=88YKAQAAMAAJ">https://books.google.ca/books?id=88YKAQAAMAAJ</a>.
</div>
<div id="ref-matheron_intrinsic_1973" class="csl-entry">
Matheron, G. 1973. <span>“Intrinsic <span>Random</span> <span>Functions</span> and <span>Their</span> <span>Applications</span>.”</span> <em>Advances in Applied Probability</em> 5 (3): 439–68. <a href="https://doi.org/10.1017/S0001867800039379">https://doi.org/10.1017/S0001867800039379</a>.
</div>
<div id="ref-mcroberts_sampling_2014" class="csl-entry">
McRoberts, R. E., E. O. Tomppo, and R. L. Czaplewski. 2014. <span>“Sampling Designs for National Forest Assessments: <span>Knowledge</span> Reference for National Forest Assessments.”</span> <em>Food and Agricultural Organisation of the UN (FAO)</em>, 23–40. <a href="http://www.fao.org/%0Aforestry/44859-02cf95ef26dfdcb86c6be2720f8b938a8.pdf. Rome. FAO.">http://www.fao.org/%0Aforestry/44859-02cf95ef26dfdcb86c6be2720f8b938a8.pdf. Rome. FAO.</a>
</div>
<div id="ref-meng_spatial_2009" class="csl-entry">
Meng, Qingmin, Chris J. Cieszewski, Mike R. Strub, and Bruce E. Borders. 2009. <span>“Spatial Regression Modeling of Tree Height-Diameter Relationships.”</span> <em>Canadian Journal of Forest Research</em> 39 (12): 2283–93. <a href="https://doi.org/10.1139/X09-136">https://doi.org/10.1139/X09-136</a>.
</div>
<div id="ref-moran_notes_1950" class="csl-entry">
Moran, P. 1950. <span>“Notes on <span>Continuous</span> <span>Stochastic</span> <span>Phenomenon</span>.”</span> <em>Biometrika</em> 37 (1): 17–23.
</div>
<div id="ref-province_of_bc_provincial_2018" class="csl-entry">
Province of BC. 2018. <span>“Provincial <span>Change</span> <span>Monitoring</span> <span>Inventory</span> (<span>CMI</span>) and <span>Young</span> <span>Stand</span> <span>Monitoring</span> (<span>YSM</span>) <span>Sampling</span> <span>Framework</span>,”</span> no. May. <a href="https://www2.gov.bc.ca/assets/gov/farming-natural-resources-and-industry/forestry/stewardship/forest-analysis-inventory/ground-sample-inventories/provincial-monitoring/provincial_cmi_and_ysm_sampling_framework_20180616.pdf">https://www2.gov.bc.ca/assets/gov/farming-natural-resources-and-industry/forestry/stewardship/forest-analysis-inventory/ground-sample-inventories/provincial-monitoring/provincial_cmi_and_ysm_sampling_framework_20180616.pdf</a>.
</div>
<div id="ref-rossi_geostatistical_1992" class="csl-entry">
Rossi, Richard E., David J. Mulla, André G. Journel, and Eldon H. Franz. 1992. <span>“Geostatistical Tools for Modeling and Interpreting Ecological Spatial Dependence.”</span> <em>Ecological Monographs</em> 62 (2): 277–314. <a href="https://doi.org/10.2307/2937096">https://doi.org/10.2307/2937096</a>.
</div>
<div id="ref-shepard_two-_1968" class="csl-entry">
Shepard, D. 1968. <span>“Two- Dimensional Interpolation Function for Irregularly- Spaced Data.”</span> <em>Proc 23rd Nat Conf</em>, 517–24.
</div>
<div id="ref-steel_principles_1980" class="csl-entry">
Steel, R G, and J Torrie. 1980. <span>“Principles and Procedures of Statistics: A Biometrical Approach (2nd Ed).”</span> In.
</div>
<div id="ref-suryowati_comparison_2018" class="csl-entry">
Suryowati, K., R. D. Bekti, and A. Faradila. 2018. <span>“A <span>Comparison</span> of <span>Weights</span> <span>Matrices</span> on <span>Computation</span> of <span>Dengue</span> <span>Spatial</span> <span>Autocorrelation</span>.”</span> <em>IOP Conference Series: Materials Science and Engineering</em> 335 (1). <a href="https://doi.org/10.1088/1757-899X/335/1/012052">https://doi.org/10.1088/1757-899X/335/1/012052</a>.
</div>
<div id="ref-tashakkori_sage_2010" class="csl-entry">
Tashakkori, Abbas, and Charles Teddlie. 2010. <span>“<span>SAGE</span> <span>Handbook</span> of <span>Mixed</span> <span>Methods</span> in <span>Social</span> &amp; <span>Behavioral</span> <span>Research</span>.”</span> <a href="https://doi.org/10.4135/9781506335193">https://doi.org/10.4135/9781506335193</a>.
</div>
<div id="ref-teddlie_mixed_2007" class="csl-entry">
Teddlie, Charles, and Fen Yu. 2007. <span>“Mixed <span>Methods</span> <span>Sampling</span>: <span>A</span> <span>Typology</span> <span>With</span> <span>Examples</span>.”</span> <em>Journal of Mixed Methods Research</em> 1 (1): 77–100. <a href="https://doi.org/10.1177/2345678906292430">https://doi.org/10.1177/2345678906292430</a>.
</div>
<div id="ref-thompson_sampling_2012" class="csl-entry">
Thompson, S K. 2012. <em>Sampling</em>. <span>CourseSmart</span>. Wiley. <a href="https://books.google.ca/books?id=-sFtXLIdDiIC">https://books.google.ca/books?id=-sFtXLIdDiIC</a>.
</div>
<div id="ref-titus_comparison_2013" class="csl-entry">
Titus, Jency, and Sebastian Geroge. 2013. <span>“A <span>Comparison</span> <span>Study</span> <span>On</span> <span>Different</span> <span>Interpolation</span> <span>Methods</span> <span>Based</span> <span>On</span> <span>Satellite</span> <span>Images</span>.”</span> <em>International Journal of Engineering Research &amp; Technology</em> 2 (6): 82–85. <a href="https://www.ijert.org">www.ijert.org</a>.
</div>
<div id="ref-tziachris_spatial_2017" class="csl-entry">
Tziachris, Panagiotis, Eirini Metaxa, Frantzis Papadopoulos, and Maria Papadopoulou. 2017. <span>“Spatial Modelling and Prediction Assessment of Soil Iron Using <span>Kriging</span> Interpolation with <span class="nocase">pH</span> as Auxiliary Information.”</span> <em>ISPRS International Journal of Geo-Information</em> 6 (9). <a href="https://doi.org/10.3390/ijgi6090283">https://doi.org/10.3390/ijgi6090283</a>.
</div>
<div id="ref-wackernagel_multivariate_2002" class="csl-entry">
Wackernagel, Hans. 2002. <em>Multivariate <span>Geostatistics</span>: <span>An</span> <span>Introduction</span> with <span>Applications</span></em>. 3rd ed. Springer. <a href="https://doi.org/10.1007/978-3-662-05294-5">https://doi.org/10.1007/978-3-662-05294-5</a>.
</div>
<div id="ref-yamada_thiessen_2016" class="csl-entry">
Yamada, Ikuho. 2016. <span>“Thiessen <span>Polygons</span>.”</span> <em>International Encyclopedia of Geography: People, the Earth, Environment and Technology</em>, 1–6. <a href="https://doi.org/10.1002/9781118786352.wbieg0157">https://doi.org/10.1002/9781118786352.wbieg0157</a>.
</div>
<div id="ref-yates_disjunctive_1986" class="csl-entry">
Yates, S. R., A. W. Warrick, and D. E. Myers. 1986. <span>“Disjunctive <span>Kriging</span>: 2. <span>Examples</span>.”</span> <em>Water Resources Research</em> 22 (5): 623–30. <a href="https://doi.org/10.1029/WR022i005p00623">https://doi.org/10.1029/WR022i005p00623</a>.
</div>
</div>
            </section>

          </div>
        </div>
      </div>
<a href="raster-analysis-and-terrain-modelling.html" class="navigation navigation-prev " aria-label="Previous page"><i class="fa fa-angle-left"></i></a>
<a href="fundamentals-of-remote-sensing.html" class="navigation navigation-next " aria-label="Next page"><i class="fa fa-angle-right"></i></a>
    </div>
  </div>
<script src="libs/gitbook-2.6.7/js/app.min.js"></script>
<script src="libs/gitbook-2.6.7/js/lunr.js"></script>
<script src="libs/gitbook-2.6.7/js/clipboard.min.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-search.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-sharing.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-fontsettings.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-bookdown.js"></script>
<script src="libs/gitbook-2.6.7/js/jquery.highlight.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-clipboard.js"></script>
<script>
gitbook.require(["gitbook"], function(gitbook) {
gitbook.start({
"sharing": {
"github": false,
"facebook": true,
"twitter": true,
"linkedin": false,
"weibo": false,
"instapaper": false,
"vk": false,
"whatsapp": false,
"all": ["facebook", "twitter", "linkedin", "weibo", "instapaper"]
},
"fontsettings": {
"theme": "white",
"family": "sans",
"size": 2
},
"edit": {
"link": null,
"text": null
},
"history": {
"link": null,
"text": null
},
"view": {
"link": "https://github.com/ubc-geomatics-textbook/geomatics-textbook/blob/develop/10-spatial-estimation.Rmd",
"text": null
},
"download": [["https://osf.io/whqe2", "PDF"]],
"search": {
"engine": "lunr",
"options": null
},
"toc": {
"collapse": "section"
},
"toolbar": {
"position": "fixed"
}
});
});
</script>

<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    var src = "true";
    if (src === "" || src === "true") src = "https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.9/latest.js?config=TeX-MML-AM_CHTML";
    if (location.protocol !== "file:")
      if (/^https?:/.test(src))
        src = src.replace(/^https?:/, '');
    script.src = src;
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>
</body>

</html>
